\documentclass[12pt]{report}
\usepackage[]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{fullpage}
\usepackage{coqdoc}
\usepackage{amsmath,amssymb}
\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% This file has been automatically generated with the command
%% coqdoc --latex LambdaES_Infra.v -o /home/amaral/code/TCC/Monografia/coqdoc/LambdaES_Infra.tex 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\coqlibrary{LambdaES Infra}{Library }{LambdaES\_Infra}

\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Set Implicit Arguments}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import}  \coqdocvar{Metatheory} \coqdocvar{LambdaES\_Defs}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Rewriting} \coqdocvar{LambdaES\_Tac} \coqdocvar{LambdaES\_FV}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Arith} \coqdocvar{List}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\section{Instanciation of tactics}

\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Ltac} \coqdocvar{gather\_vars} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{let} \coqdocvar{A} := \coqdocvar{gather\_vars\_with} (\coqdockw{fun} \coqdocvar{x} : \coqdocvar{vars} \ensuremath{\Rightarrow} \coqdocvar{x}) \coqdoctac{in}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{let} \coqdocvar{B} := \coqdocvar{gather\_vars\_with} (\coqdockw{fun} \coqdocvar{x} : \coqdocvar{var} \ensuremath{\Rightarrow} \{\{ \coqdocvar{x} \}\}) \coqdoctac{in}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{let} \coqdocvar{D} := \coqdocvar{gather\_vars\_with} (\coqdockw{fun} \coqdocvar{x} : \coqdocvar{pterm} \ensuremath{\Rightarrow} \coqdocvar{fv} \coqdocvar{x}) \coqdoctac{in}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{constr}:(\coqdocvar{A} \symbol{92}\coqdocvar{u} \coqdocvar{B} \symbol{92}\coqdocvar{u} \coqdocvar{D}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Ltac} \coqdocvar{pick\_fresh} \coqdocvar{Y} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{let} \coqdocvar{L} := \coqdocvar{gather\_vars} \coqdoctac{in} (\coqdocvar{pick\_fresh\_gen} \coqdocvar{L} \coqdocvar{Y}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Tactic Notation} "apply\_fresh" \coqdockw{constr}(\coqdocvar{T}) "as" \coqdocvar{ident}(\coqdocvar{x}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{apply\_fresh\_base} \coqdocvar{T} \coqdocvar{gather\_vars} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdockw{Tactic Notation} "apply\_fresh" "*" \coqdockw{constr}(\coqdocvar{T}) "as" \coqdocvar{ident}(\coqdocvar{x}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{apply\_fresh} \coqdocvar{T} \coqdockw{as} \coqdocvar{x}; \coqdocvar{auto\_star}.\coqdoceol
\coqdocnoindent
\coqdockw{Tactic Notation} "apply\_fresh" \coqdockw{constr}(\coqdocvar{T}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{apply\_fresh\_base} \coqdocvar{T} \coqdocvar{gather\_vars} \coqdocvar{ltac\_no\_arg}.\coqdoceol
\coqdocnoindent
\coqdockw{Tactic Notation} "apply\_fresh" "*" \coqdockw{constr}(\coqdocvar{T}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{apply\_fresh} \coqdocvar{T}; \coqdocvar{auto\_star}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Lemmas. \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{open\_var\_inj} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{x}:\coqdocvar{var}) \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t1}) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
\coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t2}) \ensuremath{\rightarrow}  (\coqdocvar{t1} \^{} \coqdocvar{x} = \coqdocvar{t2} \^{} \coqdocvar{x}) \ensuremath{\rightarrow} (\coqdocvar{t1} = \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{x} \coqdocvar{t1}. \coqdoctac{unfold} \coqdocvar{open}. \coqdoctac{generalize} 0.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{t1}; \coqdoctac{intro} \coqdocvar{k}; \coqdoctac{destruct} \coqdocvar{t2}; \coqdoctac{simpl}; \coqdoctac{intros}; \coqdoctac{inversion} \coqdocvar{H1};\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{try} \coqdoctac{solve} [ \coqdoctac{f\_equal}\ensuremath{\times} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdoctac{do} 2 \coqdoctac{try} \coqdocvar{case\_nat}; \coqdocvar{inversions}\ensuremath{\times} \coqdocvar{H1}; \coqdoctac{try} \coqdocvar{notin\_contradiction} ].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{IHt1\_1} \coqdockw{with} (\coqdocvar{n}:=\coqdocvar{k}) (\coqdocvar{t2}:=\coqdocvar{t2\_1}) ; \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{IHt1\_2} \coqdockw{with} (\coqdocvar{n}:=\coqdocvar{k}) (\coqdocvar{t2}:=\coqdocvar{t2\_2}) ; \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{IHt1\_1} \coqdockw{with} (\coqdocvar{n}:=\coqdocvar{S} \coqdocvar{k}) (\coqdocvar{t2}:=\coqdocvar{t2\_1}) ; \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{IHt1\_2} \coqdockw{with} (\coqdocvar{n}:=\coqdocvar{k}) (\coqdocvar{t2}:=\coqdocvar{t2\_2}) ; \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{IHt1\_1} \coqdockw{with} (\coqdocvar{n}:=\coqdocvar{S} \coqdocvar{k}) (\coqdocvar{t2}:=\coqdocvar{t2\_1}) ; \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{IHt1\_2} \coqdockw{with} (\coqdocvar{n}:=\coqdocvar{k}) (\coqdocvar{t2}:=\coqdocvar{t2\_2}) ; \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{open\_rec\_term\_core} :\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{j} \coqdocvar{v} \coqdocvar{i} \coqdocvar{u}, \coqdocvar{i} \ensuremath{\not=} \coqdocvar{j} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
\{\coqdocvar{j} \~{}> \coqdocvar{v}\}\coqdocvar{t} = \{\coqdocvar{i} \~{}> \coqdocvar{u}\}(\{\coqdocvar{j} \~{}> \coqdocvar{v}\}\coqdocvar{t}) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
\coqdocvar{t} = \{\coqdocvar{i} \~{}> \coqdocvar{u}\}\coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{t}; \coqdocvar{introv} \coqdocvar{Neq} \coqdocvar{Equ}; \coqdocvar{simpls}; \coqdoctac{inversion}\ensuremath{\times} \coqdocvar{Equ}; \coqdocvar{fequals}\ensuremath{\times}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{case\_nat}\ensuremath{\times}. \coqdocvar{case\_nat}\ensuremath{\times}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Open a locally closed term is the identity \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{open\_rec\_term} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{u},  \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{k}, \coqdocvar{t} = \{\coqdocvar{k} \~{}> \coqdocvar{u}\}\coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} 1; \coqdoctac{intros}; \coqdoctac{simpl}; \coqdocvar{fequals}*; \coqdocvar{unfolds} \coqdocvar{open} ;\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{pick\_fresh} \coqdocvar{x}; \coqdoctac{apply}\ensuremath{\times} (@\coqdocvar{open\_rec\_term\_core} \coqdocvar{t1} 0 (\coqdocvar{pterm\_fvar} \coqdocvar{x})).\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Substitution for a fresh name is identity. \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{subst\_fresh} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t} \coqdocvar{u},   \coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t} \ensuremath{\rightarrow}  [\coqdocvar{x} \~{}> \coqdocvar{u}] \coqdocvar{t} = \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{induction} \coqdocvar{t}; \coqdocvar{simpls}; \coqdocvar{fequals}\ensuremath{\times}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{case\_var}\ensuremath{\times}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Substitution distributes on the open operation. \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{subst\_open\_gen} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{u} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{k}, \coqdocvar{term} \coqdocvar{u} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
[\coqdocvar{x} \~{}> \coqdocvar{u}] (\{\coqdocvar{k} \~{}> \coqdocvar{t2}\}\coqdocvar{t1}) = \{\coqdocvar{k} \~{}> ([\coqdocvar{x} \~{}> \coqdocvar{u}]\coqdocvar{t2})\} ([\coqdocvar{x} \~{}> \coqdocvar{u}]\coqdocvar{t1}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{x} \coqdocvar{u} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{k} \coqdocvar{term\_u}. \coqdocvar{gen} \coqdocvar{k}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{t1}; \coqdoctac{intros}; \coqdoctac{simpl}; \coqdocvar{fequals}\ensuremath{\times}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{case\_nat}\ensuremath{\times}. \coqdocvar{case\_var}\ensuremath{\times}. \coqdoctac{apply}\ensuremath{\times} \coqdocvar{open\_rec\_term}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{subst\_open} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{u} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{term} \coqdocvar{u} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
[\coqdocvar{x} \~{}> \coqdocvar{u}] (\coqdocvar{t1} \^{}\^{} \coqdocvar{t2}) = ([\coqdocvar{x} \~{}> \coqdocvar{u}]\coqdocvar{t1}) \^{}\^{} ([\coqdocvar{x} \~{}> \coqdocvar{u}]\coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros}. \coqdoctac{apply} \coqdocvar{subst\_open\_gen}. \coqdoctac{exact} \coqdocvar{H}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Substitution and open\_var for distinct names commute. \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{subst\_open\_var} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{u} \coqdocvar{t}, \coqdocvar{y} \ensuremath{\not=} \coqdocvar{x} \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{u} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
([\coqdocvar{x} \~{}> \coqdocvar{u}]\coqdocvar{t}) \^{} \coqdocvar{y} = [\coqdocvar{x} \~{}> \coqdocvar{u}] (\coqdocvar{t} \^{} \coqdocvar{y}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{introv} \coqdocvar{Neq} \coqdocvar{Wu}. \coqdoctac{rewrite}\ensuremath{\times} \coqdocvar{subst\_open}. \coqdoctac{simpl}. \coqdocvar{case\_var}\ensuremath{\times}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Open up t with a term u is the same as open it with a fresh free variable
   x and then substitute u for x. \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{subst\_intro} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t} \coqdocvar{u}, \coqdoceol
\coqdocindent{1.00em}
\coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t}) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
\coqdocvar{t} \^{}\^{} \coqdocvar{u} = [\coqdocvar{x} \~{}> \coqdocvar{u}](\coqdocvar{t} \^{} \coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{introv} \coqdocvar{H}. \coqdoctac{unfold} \coqdocvar{open}. \coqdoctac{generalize} 0. \coqdocvar{gen} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{t}; \coqdoctac{simpl}; \coqdoctac{intros}; \coqdocvar{fequals}\ensuremath{\times}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{case\_nat}\ensuremath{\times}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdocvar{case\_var}\ensuremath{\times}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{case\_var}\ensuremath{\times}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Terms are stable by substitution \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{subst\_term} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{z} \coqdocvar{u},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{term} \coqdocvar{u} \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{term} ([\coqdocvar{z} \~{}> \coqdocvar{u}]\coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} 2; \coqdocvar{simpls}\ensuremath{\times}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{case\_var}\ensuremath{\times}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{apply\_fresh} \coqdocvar{term\_abs}. \coqdoctac{rewrite}\ensuremath{\times} \coqdocvar{subst\_open\_var}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{apply\_fresh} \coqdocvar{term\_sub}. \coqdoctac{rewrite}\ensuremath{\times} \coqdocvar{subst\_open\_var}. \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocnoindent
\coqdockw{Hint Resolve} \coqdocvar{subst\_term}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Every term is a body \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_is\_a\_body} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{body} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{unfold} \coqdocvar{body}. \coqdoctac{\ensuremath{\exists}} \{\}. \coqdoctac{intros}. \coqdoctac{unfold} \coqdocvar{open}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{open\_rec\_term}. \coqdoctac{auto}. \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
 Open a body with a term gives a term \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{body\_open\_term} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{u}, \coqdocvar{body} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{u} \ensuremath{\rightarrow} \coqdocvar{term} (\coqdocvar{t} \^{}\^{} \coqdocvar{u}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{H}. \coqdocvar{pick\_fresh} \coqdocvar{y}. \coqdoctac{rewrite}\ensuremath{\times} (@\coqdocvar{subst\_intro} \coqdocvar{y}).\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocnoindent
\coqdockw{Hint Resolve} \coqdocvar{body\_open\_term}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
 Open a term with a term gives a term \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_open\_term} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{u}, \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{u} \ensuremath{\rightarrow} \coqdocvar{term} (\coqdocvar{t} \^{}\^{} \coqdocvar{u}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros}. \coqdoctac{apply}\ensuremath{\times} \coqdocvar{body\_open\_term}. \coqdoctac{apply}\ensuremath{\times} \coqdocvar{term\_is\_a\_body}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Conversion from locally closed abstractions and bodies \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_abs\_to\_body} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1}, \coqdocvar{term} (\coqdocvar{pterm\_abs} \coqdocvar{t1}) \ensuremath{\rightarrow} \coqdocvar{body} \coqdocvar{t1}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros}. \coqdoctac{unfold} \coqdocvar{body}. \coqdoctac{inversion}\ensuremath{\times} \coqdocvar{H}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{body\_to\_term\_abs} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1}, \coqdocvar{body} \coqdocvar{t1} \ensuremath{\rightarrow} \coqdocvar{term} (\coqdocvar{pterm\_abs} \coqdocvar{t1}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros}. \coqdoctac{inversion}\ensuremath{\times} \coqdocvar{H}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_sub\_to\_body} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{s}, \coqdocvar{term} (\coqdocvar{t}[\coqdocvar{s}]) \ensuremath{\rightarrow} \coqdocvar{body} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros}. \coqdoctac{unfold} \coqdocvar{body}. \coqdoctac{inversion}\ensuremath{\times} \coqdocvar{H}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_sub\_to\_term} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{s}, \coqdocvar{term} (\coqdocvar{t}[\coqdocvar{s}]) \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{s}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros}. \coqdoctac{inversion}\ensuremath{\times} \coqdocvar{H}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{body\_to\_subs} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{u}, \coqdocvar{body} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{u} \ensuremath{\rightarrow} \coqdocvar{term} (\coqdocvar{pterm\_sub} \coqdocvar{t} \coqdocvar{u}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros}. \coqdoctac{inversion}\ensuremath{\times} \coqdocvar{H}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{subs\_to\_body} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{u},  \coqdocvar{term} (\coqdocvar{pterm\_sub} \coqdocvar{t} \coqdocvar{u}) \ensuremath{\rightarrow} (\coqdocvar{body} \coqdocvar{t} \ensuremath{\land} \coqdocvar{term} \coqdocvar{u}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros}. \coqdoctac{inversion}\ensuremath{\times} \coqdocvar{H}. \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{3.50em}
\coqdoctac{unfold} \coqdocvar{body}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{L}. \coqdoctac{intros} \coqdocvar{x} \coqdocvar{Fr}. \coqdoctac{apply} \coqdocvar{H2}; \coqdoctac{trivial}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_to\_subs} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{u}, \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{u} \ensuremath{\rightarrow} \coqdocvar{term} (\coqdocvar{pterm\_sub} \coqdocvar{t} \coqdocvar{u}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros}. \coqdocvar{apply\_fresh} \coqdocvar{term\_sub}. \coqdoctac{apply} \coqdocvar{term\_open\_term}. \coqdoctac{assumption}. \coqdoctac{auto}. \coqdoctac{auto}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_app\_to\_term\_l} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{term} (\coqdocvar{pterm\_app} \coqdocvar{t1} \coqdocvar{t2}) \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{t1}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros}. \coqdoctac{inversion}\ensuremath{\times} \coqdocvar{H}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_app\_to\_term\_r} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{term} (\coqdocvar{pterm\_app} \coqdocvar{t1} \coqdocvar{t2}) \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{t2}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros}. \coqdoctac{inversion}\ensuremath{\times} \coqdocvar{H}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{fvar\_body} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{body} (\coqdocvar{pterm\_fvar} \coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intro}. \coqdoctac{unfold} \coqdocvar{body}. \coqdoctac{\ensuremath{\exists}} \{\}. \coqdoctac{intros}. \coqdoctac{unfold} \coqdocvar{open}. \coqdoctac{simpl}. \coqdoctac{apply} \coqdocvar{term\_var}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hint Resolve} \coqdocvar{term\_abs\_to\_body} \coqdocvar{body\_to\_term\_abs} \coqdocvar{term\_sub\_to\_body} \coqdocvar{body\_to\_subs} \coqdocvar{fvar\_body}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{body\_distribute\_over\_application} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{u}, \coqdocvar{body} (\coqdocvar{pterm\_app} \coqdocvar{t} \coqdocvar{u}) \ensuremath{\leftrightarrow} \coqdocvar{body} \coqdocvar{t} \ensuremath{\land} \coqdocvar{body} \coqdocvar{u}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{unfold} \coqdocvar{body}; \coqdoctac{unfold} \coqdocvar{open}; \coqdoctac{simpl} ; \coqdoctac{intros}; \coqdoctac{elim} \coqdocvar{H}; \coqdoctac{intros}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{split} ; \coqdoctac{\ensuremath{\exists}} \coqdocvar{x}; \coqdoctac{intros}; \coqdoctac{specialize} (\coqdocvar{H0} \coqdocvar{x0}); \coqdoctac{specialize} (\coqdocvar{H0} \coqdocvar{H1}) ;\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{inversion} \coqdocvar{H0} ; \coqdoctac{assumption}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{intros}. \coqdoctac{unfold} \coqdocvar{body} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{unfold} \coqdocvar{body}. \coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{x} \symbol{92}\coqdocvar{u} \coqdocvar{x0}). \coqdoctac{intros}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{unfold} \coqdocvar{open}. \coqdoctac{simpl}. \coqdoctac{constructor}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{specialize} (\coqdocvar{H} \coqdocvar{x1}) . \coqdoctac{auto}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{specialize} (\coqdocvar{H0} \coqdocvar{x1}) . \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_abs\_term} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{term} (\coqdocvar{pterm\_abs} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{apply} \coqdocvar{term\_abs} \coqdockw{with} (\coqdocvar{L}:=\{\}). \coqdoctac{intros}. \coqdoctac{apply} \coqdocvar{term\_open\_term}. \coqdoctac{assumption}. \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{body\_abs} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{body} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{body} (\coqdocvar{pterm\_abs} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{unfold} \coqdocvar{body}. \coqdoctac{\ensuremath{\exists}} \{\}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{apply}\ensuremath{\times} \coqdocvar{term\_open\_term}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{close\_var\_rec\_open} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{x} \coqdocvar{y} \coqdocvar{z} \coqdocvar{i} \coqdocvar{j} , \coqdocvar{i} \ensuremath{\not=} \coqdocvar{j} \ensuremath{\rightarrow} \coqdocvar{x} \ensuremath{\not=} \coqdocvar{y} \ensuremath{\rightarrow} \coqdocvar{y} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\{\coqdocvar{i} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{y}\}(\{\coqdocvar{j} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{z}\} (\coqdocvar{close\_rec} \coqdocvar{j} \coqdocvar{x} \coqdocvar{t})) = \{\coqdocvar{j} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{z}\}(\coqdocvar{close\_rec} \coqdocvar{j} \coqdocvar{x} (\{\coqdocvar{i} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{y}\}\coqdocvar{t})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{t}; \coqdoctac{simpl}; \coqdoctac{intros}; \coqdoctac{try} \coqdoctac{solve} [ \coqdoctac{f\_equal}\ensuremath{\times} ].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{do} 2 (\coqdocvar{case\_nat}; \coqdoctac{simpl}); \coqdoctac{try} \coqdoctac{solve} [ \coqdocvar{case\_var}\ensuremath{\times} \ensuremath{|} \coqdocvar{case\_nat}\ensuremath{\times} ].\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{case\_var}\ensuremath{\times}. \coqdoctac{simpl}. \coqdocvar{case\_nat}\ensuremath{\times}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{open\_close\_var\_gen} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t} \coqdocvar{k},  \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{t} = \{\coqdocvar{k} \~{}> (\coqdocvar{pterm\_fvar} \coqdocvar{x})\}(\coqdocvar{close\_rec} \coqdocvar{k} \coqdocvar{x} \coqdocvar{t}) .\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{introv} \coqdocvar{W}. \coqdoctac{unfold} \coqdocvar{close}, \coqdocvar{open}. \coqdoctac{generalize} \coqdoctac{dependent} \coqdocvar{k}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{W}; \coqdoctac{intros} \coqdocvar{k}; \coqdocvar{simpls}; \coqdoctac{f\_equal}\ensuremath{\times}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{case\_var}\ensuremath{\times}. \coqdoctac{simpl}. \coqdocvar{case\_nat}\ensuremath{\times}.\coqdoceol
\coqdocindent{1.00em}
\coqdockw{let} \coqdocvar{L} := \coqdocvar{gather\_vars} \coqdoctac{in} \coqdockw{match} \coqdockw{goal} \coqdockw{with} \ensuremath{\vdash} \coqdocvar{\_} = ?\coqdocvar{t} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{2.00em}
\coqdoctac{destruct} (\coqdocvar{var\_fresh} (\coqdocvar{L} \symbol{92}\coqdocvar{u} \coqdocvar{fv} \coqdocvar{t})) \coqdockw{as} [\coqdocvar{y} \coqdocvar{Fr}] \coqdockw{end}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply}\ensuremath{\times} (@\coqdocvar{open\_var\_inj} \coqdocvar{y}).\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{unfolds} \coqdocvar{open}. \coqdoctac{rewrite}\ensuremath{\times} \coqdocvar{close\_var\_rec\_open}. \coqdocvar{VSD.fsetdec}.\coqdoceol
\coqdocindent{1.00em}
\coqdockw{let} \coqdocvar{L} := \coqdocvar{gather\_vars} \coqdoctac{in} \coqdockw{match} \coqdockw{goal} \coqdockw{with} \ensuremath{\vdash} \coqdocvar{\_} = ?\coqdocvar{t} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{2.00em}
\coqdoctac{destruct} (\coqdocvar{var\_fresh} (\coqdocvar{L} \symbol{92}\coqdocvar{u} \coqdocvar{fv} \coqdocvar{t})) \coqdockw{as} [\coqdocvar{y} \coqdocvar{Fr}] \coqdockw{end}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply}\ensuremath{\times} (@\coqdocvar{open\_var\_inj} \coqdocvar{y}).\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{unfolds} \coqdocvar{open}. \coqdoctac{rewrite}\ensuremath{\times} \coqdocvar{close\_var\_rec\_open}. \coqdocvar{VSD.fsetdec}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{open\_close\_var} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t},  \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{t} = (\coqdocvar{close} \coqdocvar{t} \coqdocvar{x}) \^{} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{open\_close\_var\_gen}; \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{close\_var\_body} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t},  \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{body} (\coqdocvar{close} \coqdocvar{t} \coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{introv} \coqdocvar{W}. \coqdoctac{\ensuremath{\exists}} \{\{\coqdocvar{x}\}\}. \coqdoctac{intros} \coqdocvar{y} \coqdocvar{Fr}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{open}, \coqdocvar{close}. \coqdoctac{generalize} 0. \coqdocvar{gen} \coqdocvar{y}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{W}; \coqdoctac{intros} \coqdocvar{y} \coqdocvar{Fr} \coqdocvar{k}; \coqdocvar{simpls}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{case\_var}; \coqdoctac{simpl}. \coqdocvar{case\_nat}\ensuremath{\times}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{auto}\ensuremath{\times}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply}\ensuremath{\times} \coqdocvar{term\_app}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{apply\_fresh}\ensuremath{\times} \coqdocvar{term\_abs}.\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{unfolds} \coqdocvar{open}. \coqdoctac{rewrite}\ensuremath{\times} \coqdocvar{close\_var\_rec\_open}. \coqdocvar{VSD.fsetdec}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{apply\_fresh}\ensuremath{\times} \coqdocvar{term\_sub}. \coqdocvar{unfolds} \coqdocvar{open}. \coqdoctac{rewrite}\ensuremath{\times} \coqdocvar{close\_var\_rec\_open}. \coqdocvar{VSD.fsetdec}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{close\_fresh} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{x} \coqdocvar{k}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{close\_rec} \coqdocvar{k} \coqdocvar{x} \coqdocvar{t} = \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{x} \coqdocvar{k} \coqdocvar{x\_notin\_t}. \coqdoctac{unfold} \coqdocvar{close}. \coqdocvar{gen} \coqdocvar{k}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{t} ; \coqdoctac{intro} \coqdocvar{k} ; \coqdocvar{simpls}\ensuremath{\times} ; \coqdoctac{try} (\coqdocvar{fequals} ; \coqdoctac{eauto}).\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{case\_var}\ensuremath{\times}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{subst\_close} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{x} \coqdocvar{y} \coqdocvar{u}, \coqdoceol
\coqdocindent{2.00em}
\coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{u} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{2.00em}
\coqdocvar{y} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{u} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{2.00em}
\coqdocvar{x} \ensuremath{\not=} \coqdocvar{y} \ensuremath{\rightarrow}  \coqdoceol
\coqdocnoindent
[\coqdocvar{y} \~{}> \coqdocvar{u}] (\coqdocvar{close} \coqdocvar{t} \coqdocvar{x}) = \coqdocvar{close} ([\coqdocvar{y} \~{}> \coqdocvar{u}]\coqdocvar{t}) \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{x} \coqdocvar{y} \coqdocvar{u} \coqdocvar{x\_notin\_u} \coqdocvar{y\_notin\_u} \coqdocvar{x\_neq\_y}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{close}. \coqdoctac{generalize} 0 \coqdockw{as} \coqdocvar{k}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{t} ; \coqdoctac{intro} \coqdocvar{k} ; \coqdocvar{simpls}\ensuremath{\times} ; \coqdoctac{try} (\coqdocvar{fequals} ; \coqdoctac{eauto}).\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{case\_var} ; \coqdoctac{simpl} ; \coqdocvar{case\_var} ; \coqdocvar{simpls}.\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{case\_var}\ensuremath{\times}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{rewrite}\ensuremath{\times} \coqdocvar{close\_fresh}.\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{case\_var}\ensuremath{\times}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{subst\_as\_close\_open} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{x} \coqdocvar{u}, \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} [\coqdocvar{x} \~{}> \coqdocvar{u}] \coqdocvar{t} = (\coqdocvar{close} \coqdocvar{t} \coqdocvar{x}) \^{}\^{} \coqdocvar{u}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{x} \coqdocvar{u} \coqdocvar{term\_t}. \coqdoctac{rewrite} \coqdocvar{subst\_intro} \coqdockw{with} (\coqdocvar{x}:=\coqdocvar{x}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{open\_close\_var} \coqdockw{with} (\coqdocvar{x}:=\coqdocvar{x}) ; \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_fv\_close}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Auxiliary lemmas. \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_distribute\_over\_application} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{u}, \coqdocvar{term} (\coqdocvar{pterm\_app} \coqdocvar{t} \coqdocvar{u}) \ensuremath{\leftrightarrow} \coqdocvar{term} \coqdocvar{t} \ensuremath{\land} \coqdocvar{term} \coqdocvar{u}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro}. \coqdoctac{split}; \coqdoctac{inversion} \coqdocvar{H}; \coqdoctac{assumption}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro}. \coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{term\_app}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hint Resolve} \coqdocvar{body\_open\_term}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{not\_body\_Sn}: \coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \~{}(\coqdocvar{body} (\coqdocvar{pterm\_bvar} (\coqdocvar{S} \coqdocvar{n}))).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{n}. \coqdoctac{intro} \coqdocvar{H}. \coqdoctac{elim} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{L}. \coqdoctac{intro} \coqdocvar{H1}. \coqdocvar{pick\_fresh} \coqdocvar{z}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocvar{z} \symbol{92}\coqdocvar{notin} \coqdocvar{L}). \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocvar{term} (\coqdocvar{pterm\_bvar} (\coqdocvar{S} \coqdocvar{n}) \^{} \coqdocvar{z})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{H1}. \coqdoctac{assumption}. \coqdoctac{inversion} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Induction Principles Part 1\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{peano\_induction} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} (\coqdocvar{P}:\coqdocvar{nat}\ensuremath{\rightarrow}\coqdockw{Prop}),\coqdoceol
\coqdocindent{1.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{n}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvar{m} < \coqdocvar{n} \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{m}) \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{n}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqdocvar{P} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{introv} \coqdocvar{H}. \coqdocvar{cuts}\ensuremath{\times} \coqdocvar{K}: (\coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{m}, \coqdocvar{m} < \coqdocvar{n} \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{m}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}; \coqdocvar{introv} \coqdocvar{Le}. \coqdoctac{inversion} \coqdocvar{Le}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{apply} \coqdocvar{IHn}. \coqdoctac{omega}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{pterm\_size\_open\_var} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{t} \coqdocvar{x}, \coqdocvar{pterm\_size} \coqdocvar{t} = \coqdocvar{pterm\_size} (\coqdocvar{open\_rec} \coqdocvar{n} (\coqdocvar{pterm\_fvar} \coqdocvar{x}) \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{t} \coqdocvar{x}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{generalize} \coqdocvar{n}; \coqdoctac{clear} \coqdocvar{n}; \coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{n'}; \coqdoctac{simpl}; \coqdocvar{case\_nat}\ensuremath{\times}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{n}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{n}; \coqdoctac{simpl}; \coqdoctac{rewrite} (\coqdocvar{IHt1} \coqdocvar{n}); \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{n}; \coqdoctac{simpl}; \coqdoctac{rewrite} (\coqdocvar{IHt} (\coqdocvar{S} \coqdocvar{n})); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{n}; \coqdoctac{simpl}; \coqdoctac{rewrite} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n})); \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{n}; \coqdoctac{simpl}; \coqdoctac{rewrite} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n})); \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{pterm\_size\_induction} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{P} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop},\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqdocvar{P} (\coqdocvar{pterm\_bvar} \coqdocvar{n})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{P} (\coqdocvar{pterm\_fvar} \coqdocvar{x})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1},\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t2} \coqdocvar{x}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{pterm\_size} \coqdocvar{t2} = \coqdocvar{pterm\_size} \coqdocvar{t1} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{P} (\coqdocvar{t2} \^{} \coqdocvar{x})) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{pterm\_abs} \coqdocvar{t1})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{P} \coqdocvar{t1} \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{pterm\_app} \coqdocvar{t1} \coqdocvar{t2})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t3}, \coqdocvar{P} \coqdocvar{t3} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{2.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t2} \coqdocvar{x}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{pterm\_size} \coqdocvar{t2} = \coqdocvar{pterm\_size} \coqdocvar{t1} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{P} (\coqdocvar{t2} \^{} \coqdocvar{x})) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{t1}[\coqdocvar{t3}])) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t3}, \coqdocvar{P} \coqdocvar{t3} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{2.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t2} \coqdocvar{x}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{pterm\_size} \coqdocvar{t2} = \coqdocvar{pterm\_size} \coqdocvar{t1} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{P} (\coqdocvar{t2} \^{} \coqdocvar{x})) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{t1}[[\coqdocvar{t3}]])) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{P} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{P} \coqdocvar{Ha} \coqdocvar{Hb} \coqdocvar{Hc} \coqdocvar{Hd} \coqdocvar{He} \coqdocvar{Hf} \coqdocvar{t}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{gen\_eq} \coqdocvar{n}: (\coqdocvar{pterm\_size} \coqdocvar{t}). \coqdocvar{gen} \coqdocvar{t}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n} \coqdockw{using} \coqdocvar{peano\_induction}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{introv} \coqdocvar{Eq}. \coqdoctac{subst}. \coqdoctac{destruct} \coqdocvar{t}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply} \coqdocvar{Ha}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply} \coqdocvar{Hb}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{Hd}. \coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{simpl}; \coqdoctac{omega}. \coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{simpl}; \coqdoctac{omega}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\times} \coqdocvar{Hc}.\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{introv} \coqdocvar{Fr} \coqdocvar{Eq}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{unfold} \coqdocvar{open}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{pterm\_size\_open\_var}. \coqdoctac{simpl}. \coqdoctac{omega}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\times} \coqdocvar{He}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{simpl}. \coqdoctac{omega}.\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{introv} \coqdocvar{Fr} \coqdocvar{Eq}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{unfold} \coqdocvar{open}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{pterm\_size\_open\_var}. \coqdoctac{simpl}. \coqdoctac{omega}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\times} \coqdocvar{Hf}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{simpl}. \coqdoctac{omega}.\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{introv} \coqdocvar{Fr} \coqdocvar{Eq}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{unfold} \coqdocvar{open}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{pterm\_size\_open\_var}. \coqdoctac{simpl}. \coqdoctac{omega}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{pterm\_induction} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{P} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop},\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqdocvar{P} (\coqdocvar{pterm\_bvar} \coqdocvar{n})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{P} (\coqdocvar{pterm\_fvar} \coqdocvar{x})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1}, \coqdocvar{P} \coqdocvar{t1} \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{P} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{pterm\_app} \coqdocvar{t1} \coqdocvar{t2})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1}, \coqdocvar{P} (\coqdocvar{t1}) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{pterm\_abs} \coqdocvar{t1})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1}, \coqdocvar{P} \coqdocvar{t1} \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{P} (\coqdocvar{t2}) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{t1}[\coqdocvar{t2}])) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1}, \coqdocvar{P} \coqdocvar{t1} \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{P} (\coqdocvar{t2}) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{t1}[[\coqdocvar{t2}]])) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{P} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{P} \coqdocvar{Hbvar} \coqdocvar{Hfvar} \coqdocvar{Happ} \coqdocvar{Habs} \coqdocvar{Hsub} \coqdocvar{Hsub'} \coqdocvar{t}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{gen} \coqdocvar{t}. \coqdoctac{simple} \coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assumption}. \coqdoctac{assumption}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{Happ}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{Habs}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{Hsub}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{Hsub'}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{lc\_at} (\coqdocvar{k}:\coqdocvar{nat}) (\coqdocvar{t}:\coqdocvar{pterm}) \{\coqdockw{struct} \coqdocvar{t}\} : \coqdockw{Prop} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvar{t} \coqdockw{with} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{pterm\_bvar} \coqdocvar{i}    \ensuremath{\Rightarrow} \coqdocvar{i} < \coqdocvar{k}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{pterm\_fvar} \coqdocvar{x}    \ensuremath{\Rightarrow} \coqdocvar{True}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{pterm\_app} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\Rightarrow} \coqdocvar{lc\_at} \coqdocvar{k} \coqdocvar{t1} \ensuremath{\land} \coqdocvar{lc\_at} \coqdocvar{k} \coqdocvar{t2}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{pterm\_abs} \coqdocvar{t1}    \ensuremath{\Rightarrow} \coqdocvar{lc\_at} (\coqdocvar{S} \coqdocvar{k}) \coqdocvar{t1}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{pterm\_sub} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\Rightarrow} (\coqdocvar{lc\_at} (\coqdocvar{S} \coqdocvar{k}) \coqdocvar{t1}) \ensuremath{\land} \coqdocvar{lc\_at} \coqdocvar{k} \coqdocvar{t2}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{pterm\_lsub} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\Rightarrow} \coqdocvar{False}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{term'} \coqdocvar{t} := \coqdocvar{lc\_at} 0 \coqdocvar{t}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{body'} \coqdocvar{t} := \coqdocvar{lc\_at} 1 \coqdocvar{t}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Equivalence of \coqdocvar{term} \coqdocvar{and} [\coqdocvar{term'}] \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{lc\_rec\_open\_var\_rec} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t} \coqdocvar{k},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{lc\_at} \coqdocvar{k} (\coqdocvar{open\_rec} \coqdocvar{k} \coqdocvar{x} \coqdocvar{t}) \ensuremath{\rightarrow} \coqdocvar{lc\_at} (\coqdocvar{S} \coqdocvar{k}) \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{t}; \coqdoctac{simpl}; \coqdocvar{introv} \coqdocvar{H}; \coqdoctac{auto}\ensuremath{\times}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{case\_nat}; \coqdocvar{simpls}\ensuremath{\lnot}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_to\_term'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{term'} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{introv} \coqdocvar{T}. \coqdoctac{induction} \coqdocvar{T}; \coqdoctac{unfold} \coqdocvar{term'}; \coqdoctac{simple}\ensuremath{\lnot}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{pick\_fresh} \coqdocvar{x}. \coqdoctac{apply}\ensuremath{\lnot} (@\coqdocvar{lc\_rec\_open\_var\_rec} (\coqdocvar{pterm\_fvar} \coqdocvar{x})). \coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H0}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{pick\_fresh} \coqdocvar{x}. \coqdoctac{apply}\ensuremath{\lnot} (@\coqdocvar{lc\_rec\_open\_var\_rec} (\coqdocvar{pterm\_fvar} \coqdocvar{x})). \coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H0}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{term'} \coqdoctac{in} \coqdocvar{IHT}. \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{lc\_at\_open\_var\_rec} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t} \coqdocvar{k},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{lc\_at} (\coqdocvar{S} \coqdocvar{k}) \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{lc\_at} \coqdocvar{k} (\coqdocvar{open\_rec} \coqdocvar{k} (\coqdocvar{pterm\_fvar} \coqdocvar{x}) \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{t}; \coqdoctac{simpl}; \coqdocvar{introv} \coqdocvar{H}; \coqdoctac{auto}\ensuremath{\times}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{case\_nat}; \coqdocvar{simpls}\ensuremath{\lnot}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{lt} \coqdoctac{in} *\ensuremath{\vdash}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{le\_lt\_or\_eq} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H1}. \coqdoctac{apply} \coqdocvar{lt\_S\_n} \coqdoctac{in} \coqdocvar{H1}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H1}. \coqdoctac{assert} (\coqdocvar{n} = \coqdocvar{k}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{auto}. \coqdoctac{assert} (\coqdocvar{k} = \coqdocvar{n}). \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term'\_to\_term} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{term'} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{introv}. \coqdoctac{unfold} \coqdocvar{term'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{pterm\_size\_induction} \coqdockw{with} (\coqdocvar{t} := \coqdocvar{t}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\~{} \coqdocvar{n} < 0). \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{term\_var}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{term\_abs} \coqdockw{with} (\coqdocvar{L} := \coqdocvar{fv} \coqdocvar{t1}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{x} \coqdocvar{Fr}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{H} \coqdocvar{t1}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{open}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{lc\_at\_open\_var\_rec}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{IHt1} \coqdocvar{IHt2} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{term\_app}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{IHt1}; \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{IHt2}; \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{term\_sub} \coqdockw{with} (\coqdocvar{L} := \coqdocvar{fv} \coqdocvar{t1}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{x} \coqdocvar{Fr}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{H0} \coqdocvar{t1}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{open}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{lc\_at\_open\_var\_rec}. \coqdoctac{apply} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H1}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_eq\_term'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{term} \coqdocvar{t} \ensuremath{\leftrightarrow} \coqdocvar{term'} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros}. \coqdoctac{split}. \coqdoctac{apply} \coqdocvar{term\_to\_term'}. \coqdoctac{apply} \coqdocvar{term'\_to\_term}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Equivalence of \coqdocvar{body} and \coqdocvar{body'} \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{body\_to\_body'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{body} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{body'} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{introv} [\coqdocvar{L} \coqdocvar{H}]. \coqdocvar{pick\_fresh} \coqdocvar{x}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{applys} (@\coqdocvar{lc\_rec\_open\_var\_rec} (\coqdocvar{pterm\_fvar} \coqdocvar{x})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{term\_to\_term'}. \coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{body'\_to\_body} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{body'} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{body} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{introv} \coqdocvar{B}. \coqdoctac{\ensuremath{\exists}} (\{\}:\coqdocvar{vars}). \coqdocvar{introv} \coqdocvar{F}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{term'\_to\_term}. \coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{lc\_at\_open\_var\_rec}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{body\_eq\_body'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{body} \coqdocvar{t} \ensuremath{\leftrightarrow} \coqdocvar{body'} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros}. \coqdoctac{split}. \coqdoctac{apply} \coqdocvar{body\_to\_body'}. \coqdoctac{apply} \coqdocvar{body'\_to\_body}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Weakening property of \coqdocvar{lc\_at} \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{lc\_at\_weaken\_ind} : \coqdockw{\ensuremath{\forall}} \coqdocvar{k1} \coqdocvar{k2} \coqdocvar{t},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{lc\_at} \coqdocvar{k1} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{k1} \ensuremath{\le} \coqdocvar{k2} \ensuremath{\rightarrow} \coqdocvar{lc\_at} \coqdocvar{k2} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdocvar{introv}. \coqdocvar{gen} \coqdocvar{k1} \coqdocvar{k2}. \coqdoctac{induction} \coqdocvar{t}; \coqdoctac{simpl}; \coqdocvar{introv} \coqdocvar{T} \coqdocvar{Lt}; \coqdoctac{auto}\ensuremath{\times}.\coqdoceol
\coqdocindent{3.50em}
\coqdoctac{omega}. \coqdoctac{apply} (\coqdocvar{IHt} (\coqdocvar{S} \coqdocvar{k1}) (\coqdocvar{S} \coqdocvar{k2})); \coqdoctac{trivial}; \coqdoctac{try} \coqdoctac{omega}.\coqdoceol
\coqdocindent{3.50em}
\coqdoctac{case} \coqdocvar{T}; \coqdoctac{clear} \coqdocvar{T}; \coqdoctac{intros} \coqdocvar{Tt1} \coqdocvar{Tt2}. \coqdoctac{split}.\coqdoceol
\coqdocindent{3.50em}
\coqdoctac{apply} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{k1}) (\coqdocvar{S} \coqdocvar{k2})); \coqdoctac{trivial}; \coqdoctac{try} \coqdoctac{omega}.\coqdoceol
\coqdocindent{3.50em}
\coqdoctac{apply} (\coqdocvar{IHt2} \coqdocvar{k1} \coqdocvar{k2}); \coqdoctac{trivial}; \coqdoctac{try} \coqdoctac{omega}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{lc\_at\_weaken} : \coqdockw{\ensuremath{\forall}} \coqdocvar{k} \coqdocvar{t},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{term'} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{lc\_at} \coqdocvar{k} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdocvar{introv} \coqdocvar{H}. \coqdoctac{apply}\ensuremath{\lnot} (@\coqdocvar{lc\_at\_weaken\_ind} 0). \coqdoctac{omega}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
pterm lists \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{mult\_app} (\coqdocvar{t} : \coqdocvar{pterm}) (\coqdocvar{l} : \coqdocvar{list} \coqdocvar{pterm}) \{\coqdockw{struct} \coqdocvar{l}\} : \coqdocvar{pterm} := \coqdoceol
\coqdocindent{0.50em}
\coqdockw{match} \coqdocvar{l} \coqdockw{with} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{nil} \ensuremath{\Rightarrow} \coqdocvar{t} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{u}::\coqdocvar{lv} \ensuremath{\Rightarrow} \coqdocvar{pterm\_app} (\coqdocvar{mult\_app} \coqdocvar{t} \coqdocvar{lv}) \coqdocvar{u}  \coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Notation} "t // lu" := (\coqdocvar{mult\_app} \coqdocvar{t} \coqdocvar{lu}) (\coqdoctac{at} \coqdockw{level} 66).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{mult\_sub} (\coqdocvar{t} : \coqdocvar{pterm}) (\coqdocvar{l} : \coqdocvar{list} \coqdocvar{pterm}) \{\coqdockw{struct} \coqdocvar{l}\} : \coqdocvar{pterm} := \coqdoceol
\coqdocindent{0.50em}
\coqdockw{match} \coqdocvar{l} \coqdockw{with} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{nil} \ensuremath{\Rightarrow} \coqdocvar{t} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{u}::\coqdocvar{lv} \ensuremath{\Rightarrow} (\coqdocvar{mult\_sub} \coqdocvar{t} \coqdocvar{lv})[\coqdocvar{u}]  \coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Notation} "t // [ lu ]" := (\coqdocvar{mult\_sub} \coqdocvar{t} \coqdocvar{lu}) (\coqdoctac{at} \coqdockw{level} 66).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{P\_list} (\coqdocvar{P} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) (\coqdocvar{l} : \coqdocvar{list} \coqdocvar{pterm}) \{\coqdockw{struct} \coqdocvar{l}\} : \coqdockw{Prop} :=\coqdoceol
\coqdocindent{0.50em}
\coqdockw{match} \coqdocvar{l} \coqdockw{with}\coqdoceol
\coqdocindent{0.50em}
\ensuremath{|} \coqdocvar{nil} \ensuremath{\Rightarrow} \coqdocvar{True}\coqdoceol
\coqdocindent{0.50em}
\ensuremath{|} \coqdocvar{t}::\coqdocvar{lu} \ensuremath{\Rightarrow}  (\coqdocvar{P} \coqdocvar{t}) \ensuremath{\land} (\coqdocvar{P\_list} \coqdocvar{P} \coqdocvar{lu}) \coqdoceol
\coqdocindent{0.50em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Notation} "P \%\% lu" := (\coqdocvar{P\_list} \coqdocvar{P} \coqdocvar{lu}) (\coqdoctac{at} \coqdockw{level} 66).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{P\_list\_eq} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{P} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) \coqdocvar{l}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{u}, \coqdocvar{In} \coqdocvar{u} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{u}) \ensuremath{\leftrightarrow} (\coqdocvar{P} \%\% \coqdocvar{l}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{P} \coqdocvar{l}. \coqdoctac{induction} \coqdocvar{l}; \coqdoctac{simpl}; \coqdoctac{split}; \coqdoctac{intros}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{contradiction}. \coqdoctac{split}. \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHl}. \coqdoctac{intros}. \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H0}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H0}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
SN \& NF \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{NF\_ind} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}): \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocindent{0.50em}
\ensuremath{|} \coqdocvar{NF\_ind\_app} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{l}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{u}, \coqdocvar{In} \coqdocvar{u} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{NF\_ind} \coqdocvar{R} \coqdocvar{u}) \ensuremath{\rightarrow} \coqdocvar{NF\_ind} \coqdocvar{R} ((\coqdocvar{pterm\_fvar} \coqdocvar{x}) // \coqdocvar{l})\coqdoceol
\coqdocindent{0.50em}
\ensuremath{|} \coqdocvar{NF\_ind\_abs} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{L}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{L} \ensuremath{\rightarrow} \coqdocvar{NF\_ind} \coqdocvar{R} (\coqdocvar{t} \^{} \coqdocvar{x})) \ensuremath{\rightarrow}  \coqdocvar{NF\_ind} \coqdocvar{R} (\coqdocvar{pterm\_abs} \coqdocvar{t}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{SN\_ind} (\coqdocvar{n} : \coqdocvar{nat}) (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) (\coqdocvar{t} : \coqdocvar{pterm}) : \coqdockw{Prop} :=\coqdoceol
\coqdocindent{0.50em}
\ensuremath{|} \coqdocvar{SN\_intro} : (\coqdockw{\ensuremath{\forall}} \coqdocvar{t'}, \coqdocvar{R} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{k}, \coqdocvar{k} < \coqdocvar{n} \ensuremath{\land} \coqdocvar{SN\_ind} \coqdocvar{k} \coqdocvar{R} \coqdocvar{t'}) \ensuremath{\rightarrow} \coqdocvar{SN\_ind} \coqdocvar{n} \coqdocvar{R} \coqdocvar{t}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{SN} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) (\coqdocvar{t} : \coqdocvar{pterm}) := \coqdoctac{\ensuremath{\exists}} \coqdocvar{n}, \coqdocvar{SN\_ind} \coqdocvar{n} \coqdocvar{R} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{NF} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) (\coqdocvar{t} : \coqdocvar{pterm}) := \coqdockw{\ensuremath{\forall}} \coqdocvar{t'}, \ensuremath{\lnot} \coqdocvar{R} \coqdocvar{t} \coqdocvar{t'}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{SN\_alt} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) (\coqdocvar{t} : \coqdocvar{pterm}) : \coqdockw{Prop} :=\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{SN\_nf} : \coqdocvar{NF} \coqdocvar{R} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{SN\_alt} \coqdocvar{R} \coqdocvar{t}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{SN\_acc} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t'}, \coqdocvar{R} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} \coqdocvar{SN\_alt} \coqdocvar{R} \coqdocvar{t'} \ensuremath{\rightarrow} \coqdocvar{SN\_alt} \coqdocvar{R} \coqdocvar{t}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_app\_append} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{l}, \coqdocvar{pterm\_app} \coqdocvar{t1} \coqdocvar{t2} // \coqdocvar{l} = \coqdocvar{t1} // \coqdocvar{l} ++ (\coqdocvar{t2} :: \coqdocvar{nil}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{induction} \coqdocvar{l}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHl}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_app\_append'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{pterm\_app} (\coqdocvar{t1} // \coqdocvar{l'}) \coqdocvar{t2} // \coqdocvar{l} = \coqdocvar{t1} // \coqdocvar{l} ++ (\coqdocvar{t2} :: \coqdocvar{l'}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{generalize} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{l}; \coqdoctac{clear} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{l}. \coqdoctac{induction} \coqdocvar{l'}; \coqdoctac{intros}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{mult\_app\_append}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{replace} (\coqdocvar{l} ++ \coqdocvar{t2} :: \coqdocvar{a} :: \coqdocvar{l'}) \coqdockw{with} ((\coqdocvar{l} ++ (\coqdocvar{t2} :: \coqdocvar{nil})) ++ (\coqdocvar{a} :: \coqdocvar{l'})). \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{IHl'}  .\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{mult\_app\_append}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_assoc}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{P\_list\_append} : \coqdockw{\ensuremath{\forall}} \coqdocvar{P} \coqdocvar{l1} \coqdocvar{l2}, \coqdocvar{P\_list} \coqdocvar{P} (\coqdocvar{l1} ++ \coqdocvar{l2}) \ensuremath{\leftrightarrow} ((\coqdocvar{P\_list} \coqdocvar{P} \coqdocvar{l1}) \ensuremath{\land} (\coqdocvar{P\_list} \coqdocvar{P} \coqdocvar{l2})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{induction} \coqdocvar{l1}; \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}. \coqdoctac{intro} \coqdocvar{H}. \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}. \coqdoctac{intro} \coqdocvar{H}. \coqdoctac{split}. \coqdoctac{split}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{IHl1}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHl1}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{split}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHl1}. \coqdoctac{split}; \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{eqdec\_nil} : \coqdockw{\ensuremath{\forall}} \coqdocvar{A} (\coqdocvar{l}: \coqdocvar{list} \coqdocvar{A}), (\coqdocvar{l} = \coqdocvar{nil}) \ensuremath{\lor} (\coqdocvar{l} \ensuremath{\not=} \coqdocvar{nil}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{A} \coqdocvar{l}. \coqdoctac{induction} \coqdocvar{l}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{left}; \coqdoctac{trivial}. \coqdoctac{right}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{m\_app\_eq\_app} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{lu}, \coqdocvar{lu} \ensuremath{\not=} \coqdocvar{nil} \ensuremath{\rightarrow} \coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{t'}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{u'}, \coqdocvar{t} // \coqdocvar{lu} = \coqdocvar{pterm\_app} \coqdocvar{t'} \coqdocvar{u'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{lu}. \coqdoctac{apply} \coqdocvar{False\_ind}. \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{\ensuremath{\exists}} (\coqdocvar{t} // \coqdocvar{lu}). \coqdoctac{\ensuremath{\exists}} \coqdocvar{p}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{not\_nil\_append} : \coqdockw{\ensuremath{\forall}} \coqdocvar{A} (\coqdocvar{l}: \coqdocvar{list} \coqdocvar{A}), \coqdocvar{l} \ensuremath{\not=} \coqdocvar{nil} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{0.50em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{l'}, \coqdocvar{l} = \coqdocvar{l'} ++ (\coqdocvar{a} :: \coqdocvar{nil}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{induction} \coqdocvar{l}. \coqdoctac{apply} \coqdocvar{False\_ind}. \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{eqdec\_nil} \coqdockw{with} (\coqdocvar{l} := \coqdocvar{l}). \coqdoctac{intro} \coqdocvar{H'}. \coqdoctac{rewrite} \coqdocvar{H'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a}. \coqdoctac{\ensuremath{\exists}} (\coqdocvar{nil} (\coqdocvar{A} := \coqdocvar{A})). \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H'}. \coqdoctac{case} \coqdocvar{IHl}; \coqdoctac{trivial}; \coqdoctac{clear} \coqdocvar{IHl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{a'} \coqdocvar{H0}. \coqdoctac{case} \coqdocvar{H0}; \coqdoctac{clear} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{l'} \coqdocvar{H0}. \coqdoctac{rewrite} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'}. \coqdoctac{\ensuremath{\exists}} (\coqdocvar{a} :: \coqdocvar{l'}). \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
mult\_app injectivity \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_app\_inj\_l} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{l}, \coqdocvar{t} // \coqdocvar{l} = \coqdocvar{t'} // \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{t} = \coqdocvar{t'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{l} \coqdocvar{H}. \coqdoctac{induction} \coqdocvar{l};\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} *|-*; \coqdoctac{inversion} \coqdocvar{H}; \coqdoctac{try} \coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_app\_inj\_r} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t0} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{t0} // (\coqdocvar{l} ++ (\coqdocvar{t} :: \coqdocvar{l'})) = \coqdocvar{t0} // (\coqdocvar{l} ++ (\coqdocvar{t'}:: \coqdocvar{l'})) \ensuremath{\rightarrow} \coqdocvar{t} = \coqdocvar{t'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{t0} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mult\_app\_append'} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mult\_app\_append'} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{mult\_app\_inj\_l} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{inversion} \coqdocvar{H}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_app\_inj\_r'\_aux} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{l}, \coqdocvar{t} = \coqdocvar{t} // \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{l} = \coqdocvar{nil}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{t}. \coqdoctac{induction} \coqdocvar{t}; \coqdoctac{intros}; \coqdoctac{destruct} \coqdocvar{l}; \coqdoctac{trivial}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H};\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{try} \coqdoctac{inversion} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{mult\_app\_append} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHt1} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{apply} \coqdocvar{False\_ind}. \coqdoctac{clear} \coqdocvar{t1} \coqdocvar{p} \coqdocvar{IHt1} \coqdocvar{IHt2} \coqdocvar{H} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{eqdec\_nil} \coqdockw{with} (\coqdocvar{l} := \coqdocvar{l}); \coqdoctac{intros}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{inversion} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{app\_eq\_nil} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_app\_inj\_r'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{t} // \coqdocvar{l} = \coqdocvar{t} // \coqdocvar{l'} \ensuremath{\rightarrow} \coqdocvar{l} = \coqdocvar{l'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{l}. \coqdoctac{generalize} \coqdocvar{t}; \coqdoctac{clear} \coqdocvar{t}. \coqdoctac{induction} \coqdocvar{l}; \coqdoctac{intros}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{mult\_app\_inj\_r'\_aux} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{H}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{destruct} \coqdocvar{l'}. \coqdoctac{replace} (\coqdocvar{t} // \coqdocvar{nil}) \coqdockw{with} \coqdocvar{t} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q} : \coqdocvar{a} :: \coqdocvar{l} = \coqdocvar{nil}). \coqdoctac{apply} \coqdocvar{mult\_app\_inj\_r'\_aux} \coqdockw{with} (\coqdocvar{t} := \coqdocvar{t}). \coqdoctac{rewrite} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{trivial}. \coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{inversion} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{IHl} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{H1}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_app\_inj\_aux} : \coqdockw{\ensuremath{\forall}} \coqdocvar{l} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{t} = \coqdocvar{t'} // \coqdocvar{l} \ensuremath{\rightarrow} ((\coqdocvar{t} = \coqdocvar{t'} \ensuremath{\land} \coqdocvar{l} = \coqdocvar{nil}) \ensuremath{\lor} \coqdoceol
\coqdocnoindent
(\coqdoctac{\ensuremath{\exists}} \coqdocvar{l'}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{u}, \coqdocvar{l} = \coqdocvar{l'} ++ (\coqdocvar{u} :: \coqdocvar{nil}))).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{l}. \coqdoctac{induction} \coqdocvar{l}; \coqdoctac{simpl}; \coqdoctac{intros}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{left}; \coqdoctac{split}; \coqdoctac{trivial}. \coqdoctac{destruct} \coqdocvar{t}; \coqdoctac{try} \coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHl} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{right}. \coqdoctac{destruct} \coqdocvar{H1}. \coqdoctac{destruct} \coqdocvar{H0}. \coqdoctac{rewrite} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{\ensuremath{\exists}} (\coqdocvar{nil} (\coqdocvar{A} := \coqdocvar{pterm})) \coqdocvar{a}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H0}; \coqdoctac{clear} \coqdocvar{H0}; \coqdoctac{intros} \coqdocvar{l0} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H0}; \coqdoctac{clear} \coqdocvar{H0}; \coqdoctac{intros} \coqdocvar{u0} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{H0}. \coqdoctac{\ensuremath{\exists}} (\coqdocvar{a} :: \coqdocvar{l0}) \coqdocvar{u0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{length\_0} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{A} : \coqdockw{Set}) (\coqdocvar{l} : \coqdocvar{list} \coqdocvar{A}), 0 = \coqdocvar{length} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{l} = \coqdocvar{nil}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{induction} \coqdocvar{l}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_app\_eq\_length\_inj} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{l} \coqdocvar{l'}, (\coqdocvar{length} \coqdocvar{l}) = (\coqdocvar{length} \coqdocvar{l'}) \ensuremath{\rightarrow} \coqdoceol
\coqdocnoindent
\coqdocvar{t} // \coqdocvar{l} = \coqdocvar{t'} // \coqdocvar{l'} \ensuremath{\rightarrow} \coqdocvar{t} = \coqdocvar{t'} \ensuremath{\land} \coqdocvar{l} = \coqdocvar{l'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{generalize} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{l'} \coqdocvar{H} \coqdocvar{H0}. \coqdoctac{clear} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{l'} \coqdocvar{H} \coqdocvar{H0}. \coqdoctac{induction} \coqdocvar{l}; \coqdoctac{simpl}; \coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{length\_0} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} *|-*. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{l'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{inversion} \coqdocvar{H0}. \coqdoctac{apply} \coqdocvar{IHl} \coqdoctac{in} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H2}. \coqdoctac{rewrite} \coqdocvar{H1}. \coqdoctac{rewrite} \coqdocvar{H2}. \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{omega}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_app\_var\_inj} : \coqdockw{\ensuremath{\forall}} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{x} \coqdocvar{x'}, \coqdoceol
\coqdocindent{12.50em}
(\coqdocvar{pterm\_fvar} \coqdocvar{x}) // \coqdocvar{l} = (\coqdocvar{pterm\_fvar} \coqdocvar{x'}) // \coqdocvar{l'} \ensuremath{\rightarrow} (\coqdocvar{x} = \coqdocvar{x'} \ensuremath{\land} \coqdocvar{l} = \coqdocvar{l'}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{l}. \coqdoctac{induction} \coqdocvar{l}; \coqdoctac{intros}; \coqdoctac{destruct} \coqdocvar{l'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}; \coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{IHl} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{destruct} \coqdocvar{H1}. \coqdoctac{rewrite} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_app\_diff\_var\_abs} : \coqdockw{\ensuremath{\forall}} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{x} \coqdocvar{t}, \coqdoceol
\coqdocindent{14.00em}
(\coqdocvar{pterm\_fvar} \coqdocvar{x}) // \coqdocvar{l} \ensuremath{\not=} (\coqdocvar{pterm\_abs} \coqdocvar{t}) // \coqdocvar{l'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{l}. \coqdoctac{induction} \coqdocvar{l}; \coqdoctac{destruct} \coqdocvar{l'}; \coqdoctac{simpl} \coqdoctac{in} *|-*; \coqdoctac{try} \coqdoctac{discriminate}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{intro} \coqdocvar{H}. \coqdoctac{inversion} \coqdocvar{H}. \coqdoctac{generalize} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{IHl}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_app\_diff\_var\_sub} : \coqdockw{\ensuremath{\forall}} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{x} \coqdocvar{t} \coqdocvar{u}, \coqdoceol
\coqdocindent{14.00em}
(\coqdocvar{pterm\_fvar} \coqdocvar{x}) // \coqdocvar{l} \ensuremath{\not=} (\coqdocvar{t}[\coqdocvar{u}]) // \coqdocvar{l'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{l}. \coqdoctac{induction} \coqdocvar{l}; \coqdoctac{destruct} \coqdocvar{l'}; \coqdoctac{simpl} \coqdoctac{in} *|-*; \coqdoctac{try} \coqdoctac{discriminate}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{intro} \coqdocvar{H}. \coqdoctac{inversion} \coqdocvar{H}. \coqdoctac{generalize} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{IHl}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_app\_abs\_inj} : \coqdockw{\ensuremath{\forall}} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{t} \coqdocvar{t'}, \coqdoceol
\coqdocindent{12.50em}
(\coqdocvar{pterm\_abs} \coqdocvar{t}) // \coqdocvar{l} = (\coqdocvar{pterm\_abs} \coqdocvar{t'}) // \coqdocvar{l'} \ensuremath{\rightarrow} (\coqdocvar{t} = \coqdocvar{t'} \ensuremath{\land} \coqdocvar{l} = \coqdocvar{l'}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{l}. \coqdoctac{induction} \coqdocvar{l}; \coqdoctac{intros}; \coqdoctac{destruct} \coqdocvar{l'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}; \coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{IHl} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{destruct} \coqdocvar{H1}. \coqdoctac{rewrite} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_app\_diff\_abs\_sub} : \coqdockw{\ensuremath{\forall}} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{t} \coqdocvar{u} \coqdocvar{v}, \coqdoceol
\coqdocindent{14.00em}
(\coqdocvar{pterm\_abs} \coqdocvar{t}) // \coqdocvar{l} \ensuremath{\not=} (\coqdocvar{u}[\coqdocvar{v}]) // \coqdocvar{l'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{l}. \coqdoctac{induction} \coqdocvar{l}; \coqdoctac{destruct} \coqdocvar{l'}; \coqdoctac{simpl} \coqdoctac{in} *|-*; \coqdoctac{try} \coqdoctac{discriminate}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{intro} \coqdocvar{H}. \coqdoctac{inversion} \coqdocvar{H}. \coqdoctac{generalize} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{IHl}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_app\_sub\_inj} : \coqdockw{\ensuremath{\forall}} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{t} \coqdocvar{u} \coqdocvar{t'} \coqdocvar{u'}, \coqdoceol
\coqdocindent{12.50em}
(\coqdocvar{t}[\coqdocvar{u}]) // \coqdocvar{l} = (\coqdocvar{t'}[\coqdocvar{u'}]) // \coqdocvar{l'} \ensuremath{\rightarrow} (\coqdocvar{t} = \coqdocvar{t'} \ensuremath{\land} \coqdocvar{u} = \coqdocvar{u'} \ensuremath{\land} \coqdocvar{l} = \coqdocvar{l'}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{l}. \coqdoctac{induction} \coqdocvar{l}; \coqdoctac{intros}; \coqdoctac{destruct} \coqdocvar{l'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}; \coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}; \coqdoctac{trivial}. \coqdoctac{split}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{IHl} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{destruct} \coqdocvar{H1}. \coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{H0}. \coqdoctac{rewrite} \coqdocvar{H1}. \coqdoctac{rewrite} \coqdocvar{H3}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}; \coqdoctac{trivial}. \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{app\_singleton} : \coqdockw{\ensuremath{\forall}} \coqdocvar{l} (\coqdocvar{t} : \coqdocvar{pterm}) \coqdocvar{l1} \coqdocvar{l2},\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{l} \ensuremath{\not=} \coqdocvar{nil} \ensuremath{\rightarrow} \coqdocvar{l1} ++ (\coqdocvar{t} :: \coqdocvar{nil}) = \coqdocvar{l2} ++ \coqdocvar{l} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{l'}, \coqdocvar{l} = \coqdocvar{l'} ++ (\coqdocvar{t} :: \coqdocvar{nil}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{l}; \coqdoctac{simpl}; \coqdoctac{intros}. \coqdoctac{apply} \coqdocvar{False\_ind}. \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{eqdec\_nil} \coqdockw{with} (\coqdocvar{l} := \coqdocvar{l}). \coqdoctac{intro} \coqdocvar{H1}. \coqdoctac{rewrite} \coqdocvar{H1} \coqdoctac{in} *|-*.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{app\_inj\_tail} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{destruct} \coqdocvar{H0}. \coqdoctac{rewrite} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{nil} (\coqdocvar{A} := \coqdocvar{pterm})). \coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H1}. \coqdoctac{case} \coqdocvar{IHl} \coqdockw{with}  (\coqdocvar{t} := \coqdocvar{t}) (\coqdocvar{l1} := \coqdocvar{l1}) (\coqdocvar{l2} := \coqdocvar{l2} ++ \coqdocvar{a} :: \coqdocvar{nil}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{H0}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_assoc}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{l'} \coqdocvar{H2}. \coqdoctac{rewrite} \coqdocvar{H2}. \coqdoctac{\ensuremath{\exists}} (\coqdocvar{a} :: \coqdocvar{l'}). \coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{geq\_app\_list} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{l4} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{l3} : \coqdocvar{list} \coqdocvar{pterm}), \coqdocvar{l1} ++ \coqdocvar{l2} = \coqdocvar{l3} ++ \coqdocvar{l4} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{length} \coqdocvar{l2} > \coqdocvar{length} \coqdocvar{l4} \ensuremath{\rightarrow} (\coqdoctac{\ensuremath{\exists}} \coqdocvar{l}, \coqdocvar{l2} = \coqdocvar{l} ++ \coqdocvar{l4} \ensuremath{\land} \coqdocvar{l3} = \coqdocvar{l1} ++ \coqdocvar{l}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{l4}. \coqdoctac{induction} \coqdocvar{l4}; \coqdoctac{simpl}; \coqdoctac{destruct} \coqdocvar{l2}; \coqdoctac{intros}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{assert} (\~{} 0 > 0). \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{p} :: \coqdocvar{l2}). \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{app\_nil\_r} \coqdoctac{in} *|-*. \coqdoctac{rewrite} \coqdocvar{H}. \coqdoctac{split}; \coqdoctac{trivial}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\~{} 0 > \coqdocvar{S} (\coqdocvar{length} \coqdocvar{l4})). \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{case} \coqdocvar{IHl4} \coqdockw{with} (\coqdocvar{l1} := \coqdocvar{l1} ++ (\coqdocvar{p}::\coqdocvar{nil})) (\coqdocvar{l2} := \coqdocvar{l2}) (\coqdocvar{l3} := \coqdocvar{l3} ++ (\coqdocvar{a}::\coqdocvar{nil})).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_assoc}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_assoc}. \coqdoctac{simpl}. \coqdoctac{trivial}. \coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{clear} \coqdocvar{IHl4}; \coqdoctac{intros} \coqdocvar{l} \coqdocvar{H1}. \coqdoctac{destruct} \coqdocvar{H1}. \coqdoctac{rewrite} \coqdocvar{H1}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_assoc} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{eqdec\_nil} \coqdockw{with} (\coqdocvar{l} := \coqdocvar{l}). \coqdoctac{intro} \coqdocvar{H4}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{H4} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{apply} \coqdocvar{app\_inj\_tail} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{destruct} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{H2}. \coqdoctac{rewrite} \coqdocvar{H3}. \coqdoctac{rewrite} \coqdocvar{H4}. \coqdoctac{\ensuremath{\exists}} (\coqdocvar{nil} (\coqdocvar{A} := \coqdocvar{pterm})).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{app\_nil\_l}. \coqdoctac{rewrite} \coqdocvar{app\_nil\_l}. \coqdoctac{rewrite} \coqdocvar{app\_nil\_r}. \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{replace} (\coqdocvar{l1} ++ \coqdocvar{p} :: \coqdocvar{l}) \coqdockw{with} ((\coqdocvar{l1} ++ \coqdocvar{p} :: \coqdocvar{nil}) ++ \coqdocvar{l}) \coqdoctac{in} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{generalize} \coqdocvar{H2}. \coqdoctac{intro} \coqdocvar{H4}. \coqdoctac{apply} \coqdocvar{app\_singleton} \coqdoctac{in} \coqdocvar{H4}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H4}; \coqdoctac{clear} \coqdocvar{H4}; \coqdoctac{intros} \coqdocvar{l'} \coqdocvar{H4}. \coqdoctac{rewrite} \coqdocvar{H4}. \coqdoctac{rewrite} \coqdocvar{H4} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{\ensuremath{\exists}} (\coqdocvar{p} :: \coqdocvar{l'}); \coqdoctac{split}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_assoc}. \coqdoctac{simpl}. \coqdoctac{trivial}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{replace} ((\coqdocvar{l1} ++ \coqdocvar{p} :: \coqdocvar{nil}) ++ \coqdocvar{l'} ++ \coqdocvar{a} :: \coqdocvar{nil}) \coqdockw{with} ((\coqdocvar{l1} ++ \coqdocvar{p} :: \coqdocvar{l'}) ++ \coqdocvar{a} :: \coqdocvar{nil}) \coqdoctac{in} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{app\_inj\_tail} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{destruct} \coqdocvar{H2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_assoc}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_assoc}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_assoc}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{P\_eq\_app\_list} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{P}: \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{l3} \coqdocvar{l4},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{P} \%\% \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{P} \%\% \coqdocvar{l4} \ensuremath{\rightarrow} \ensuremath{\lnot} \coqdocvar{P} \coqdocvar{t1} \ensuremath{\rightarrow} \ensuremath{\lnot} \coqdocvar{P} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{l1} ++ \coqdocvar{t1} :: \coqdocvar{l2} = \coqdocvar{l3} ++ \coqdocvar{t2} :: \coqdocvar{l4} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
(\coqdocvar{l1} = \coqdocvar{l3} \ensuremath{\land} \coqdocvar{t1} = \coqdocvar{t2} \ensuremath{\land} \coqdocvar{l2} = \coqdocvar{l4}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{case} (\coqdocvar{length} \coqdocvar{l2} == \coqdocvar{length} \coqdocvar{l4}).\coqdoceol
\coqdocemptyline
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H4}. \coqdocvar{gen\_eq} \coqdocvar{l2'} : (\coqdocvar{t1} :: \coqdocvar{l2}). \coqdocvar{gen\_eq} \coqdocvar{l4'} : (\coqdocvar{t2} :: \coqdocvar{l4}). \coqdoctac{intros} \coqdocvar{H5} \coqdocvar{H6}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{H7} : \coqdocvar{length} \coqdocvar{l2'} = \coqdocvar{length} \coqdocvar{l4'}).\coqdoceol
\coqdocindent{1.50em}
\coqdoctac{rewrite} \coqdocvar{H5}. \coqdoctac{rewrite} \coqdocvar{H6}. \coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{H4}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{clear} \coqdocvar{H} \coqdocvar{H0} \coqdocvar{H1} \coqdocvar{H2} \coqdocvar{H4}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{H8} : \coqdocvar{length} \coqdocvar{l1} = \coqdocvar{length} \coqdocvar{l3}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocvar{Q} : \coqdocvar{length} (\coqdocvar{l1} ++ \coqdocvar{l2'}) = \coqdocvar{length} \coqdocvar{l1} + \coqdocvar{length} \coqdocvar{l2'}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{rewrite} \coqdocvar{app\_length}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocvar{Q'} : \coqdocvar{length} (\coqdocvar{l3} ++ \coqdocvar{l4'}) = \coqdocvar{length} \coqdocvar{l3} + \coqdocvar{length} \coqdocvar{l4'}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{rewrite} \coqdocvar{app\_length}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{Q}. \coqdoctac{rewrite} \coqdocvar{Q} \coqdoctac{in} \coqdocvar{Q'}. \coqdoctac{rewrite} \coqdocvar{H7} \coqdoctac{in} \coqdocvar{Q'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{H9}: \coqdocvar{l1} = \coqdocvar{l3}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{clear} \coqdocvar{H5} \coqdocvar{H6} \coqdocvar{H7}. \coqdoctac{generalize} \coqdocvar{l3} \coqdocvar{l2'} \coqdocvar{l4'} \coqdocvar{H3} \coqdocvar{H8}; \coqdoctac{clear} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{l2'} \coqdocvar{l2} \coqdocvar{l3} \coqdocvar{l4} \coqdocvar{l4'} \coqdocvar{H3} \coqdocvar{H8}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{l1}; \coqdoctac{simpl}; \coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{length\_0} \coqdoctac{in} \coqdocvar{H8}. \coqdoctac{rewrite} \coqdocvar{H8}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{l3}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H8}. \coqdoctac{inversion} \coqdocvar{H8}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H3}. \coqdoctac{inversion} \coqdocvar{H3}. \coqdocvar{fequals}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H8}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{IHl1} \coqdockw{with} (\coqdocvar{l2'} := \coqdocvar{l2'}) (\coqdocvar{l4'} := \coqdocvar{l4'}); \coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{H9} \coqdoctac{in} \coqdocvar{H3}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{app\_inv\_head} \coqdoctac{in} \coqdocvar{H3}. \coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{H3}. \coqdoctac{rewrite} \coqdocvar{H6} \coqdoctac{in} \coqdocvar{H3}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{inversion} \coqdocvar{H3}. \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H4}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocvar{Q} : \coqdocvar{length} \coqdocvar{l2} > \coqdocvar{length} \coqdocvar{l4} \ensuremath{\lor} \coqdocvar{length} \coqdocvar{l4} > \coqdocvar{length} \coqdocvar{l2}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{clear} \coqdocvar{H} \coqdocvar{H0} \coqdocvar{H1} \coqdocvar{H2} \coqdocvar{H3}. \coqdoctac{generalize} \coqdocvar{l4} \coqdocvar{H4}; \coqdoctac{clear} \coqdocvar{l1} \coqdocvar{l3} \coqdocvar{l4} \coqdocvar{H4}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{induction} \coqdocvar{l2}; \coqdoctac{destruct} \coqdocvar{l4}; \coqdoctac{simpl}; \coqdoctac{intros}; \coqdoctac{try} \coqdoctac{omega}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocvar{False\_ind}. \coqdoctac{apply} \coqdocvar{H4}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{assert} (\coqdocvar{Q'{}'} : \coqdocvar{length} \coqdocvar{l2} > \coqdocvar{length} \coqdocvar{l4} \ensuremath{\lor} \coqdocvar{length} \coqdocvar{l4} > \coqdocvar{length} \coqdocvar{l2}).\coqdoceol
\coqdocindent{3.50em}
\coqdoctac{apply} \coqdocvar{IHl2}; \coqdoctac{try} \coqdoctac{omega}. \coqdoctac{intro} \coqdocvar{H5}. \coqdoctac{apply} \coqdocvar{H4}. \coqdoctac{rewrite} \coqdocvar{H5}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{destruct} \coqdocvar{Q'{}'}. \coqdoctac{left}. \coqdoctac{omega}. \coqdoctac{right}. \coqdoctac{omega}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{clear} \coqdocvar{H4}. \coqdoctac{destruct} \coqdocvar{Q}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{geq\_app\_list} \coqdockw{with} (\coqdocvar{l1} := \coqdocvar{l1} ++ (\coqdocvar{t1} :: \coqdocvar{nil})) (\coqdocvar{l3} := \coqdocvar{l3} ++ (\coqdocvar{t2} :: \coqdocvar{nil})) \coqdoctac{in} \coqdocvar{H4}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{H4}; \coqdoctac{clear} \coqdocvar{H4}. \coqdoctac{intros} \coqdocvar{l} \coqdocvar{H4}. \coqdoctac{destruct} \coqdocvar{H4}. \coqdoctac{case} \coqdocvar{eqdec\_nil} \coqdockw{with} (\coqdocvar{l} := \coqdocvar{l}). \coqdoctac{intro} \coqdocvar{H6}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{H6} \coqdoctac{in} \coqdocvar{H5}. \coqdoctac{rewrite} \coqdocvar{app\_nil\_r} \coqdoctac{in} \coqdocvar{H5}. \coqdoctac{apply} \coqdocvar{app\_inj\_tail} \coqdoctac{in} \coqdocvar{H5}. \coqdoctac{destruct} \coqdocvar{H5}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{H6} \coqdoctac{in} \coqdocvar{H4}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H4}. \coqdoctac{rewrite} \coqdocvar{H5}. \coqdoctac{rewrite} \coqdocvar{H7}. \coqdoctac{split}; \coqdoctac{trivial}. \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H6}. \coqdoctac{apply} \coqdocvar{app\_singleton} \coqdoctac{in} \coqdocvar{H5}; \coqdoctac{trivial}. \coqdoctac{case} \coqdocvar{H5}; \coqdoctac{clear} \coqdocvar{H5}; \coqdoctac{intros} \coqdocvar{l'} \coqdocvar{H5}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocvar{Q} : \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2}). \coqdoctac{rewrite} \coqdocvar{H4}. \coqdoctac{rewrite} \coqdocvar{H5}. \coqdoctac{apply} \coqdocvar{in\_or\_app}. \coqdoctac{left}. \coqdoctac{apply} \coqdocvar{in\_or\_app}. \coqdoctac{right}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl}. \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{P\_list\_eq} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{H} \coqdoctac{in} \coqdocvar{Q}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_assoc}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_assoc}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{symmetry} \coqdoctac{in} \coqdocvar{H3}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{geq\_app\_list} \coqdockw{with} (\coqdocvar{l3} := \coqdocvar{l1} ++ (\coqdocvar{t1} :: \coqdocvar{nil})) (\coqdocvar{l1} := \coqdocvar{l3} ++ (\coqdocvar{t2} :: \coqdocvar{nil})) \coqdoctac{in} \coqdocvar{H4}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{H4}; \coqdoctac{clear} \coqdocvar{H4}. \coqdoctac{intros} \coqdocvar{l} \coqdocvar{H4}. \coqdoctac{destruct} \coqdocvar{H4}. \coqdoctac{case} \coqdocvar{eqdec\_nil} \coqdockw{with} (\coqdocvar{l} := \coqdocvar{l}). \coqdoctac{intro} \coqdocvar{H6}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{H6} \coqdoctac{in} \coqdocvar{H5}. \coqdoctac{rewrite} \coqdocvar{app\_nil\_r} \coqdoctac{in} \coqdocvar{H5}. \coqdoctac{apply} \coqdocvar{app\_inj\_tail} \coqdoctac{in} \coqdocvar{H5}. \coqdoctac{destruct} \coqdocvar{H5}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{H6} \coqdoctac{in} \coqdocvar{H4}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H4}. \coqdoctac{rewrite} \coqdocvar{H5}. \coqdoctac{rewrite} \coqdocvar{H7}. \coqdoctac{rewrite} \coqdocvar{H4}. \coqdoctac{split}; \coqdoctac{trivial}. \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H6}. \coqdoctac{apply} \coqdocvar{app\_singleton} \coqdoctac{in} \coqdocvar{H5}; \coqdoctac{trivial}. \coqdoctac{case} \coqdocvar{H5}; \coqdoctac{clear} \coqdocvar{H5}; \coqdoctac{intros} \coqdocvar{l'} \coqdocvar{H5}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocvar{Q} : \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l4}). \coqdoctac{rewrite} \coqdocvar{H4}. \coqdoctac{rewrite} \coqdocvar{H5}. \coqdoctac{apply} \coqdocvar{in\_or\_app}. \coqdoctac{left}. \coqdoctac{apply} \coqdocvar{in\_or\_app}. \coqdoctac{right}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl}. \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{P\_list\_eq} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{apply} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{Q}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_assoc}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_assoc}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
About SN \& NF \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{NF\_to\_SN0} : \coqdockw{\ensuremath{\forall}} \coqdocvar{R} \coqdocvar{t}, \coqdocvar{NF} \coqdocvar{R} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{SN\_ind} 0 \coqdocvar{R} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{R} \coqdocvar{t} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{SN\_intro}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{t'} \coqdocvar{H'}. \coqdoctac{unfold} \coqdocvar{NF} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q} : \ensuremath{\lnot} \coqdocvar{R} \coqdocvar{t} \coqdocvar{t'}). \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{SN0\_to\_NF} : \coqdockw{\ensuremath{\forall}} \coqdocvar{R} \coqdocvar{t}, \coqdocvar{SN\_ind} 0 \coqdocvar{R} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{NF} \coqdocvar{R} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{R} \coqdocvar{t} \coqdocvar{H}. \coqdoctac{unfold} \coqdocvar{NF}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{t'} \coqdocvar{H'}. \coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H0} \coqdockw{with} (\coqdocvar{t'} := \coqdocvar{t'}). \coqdoctac{assumption}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H'{}'}. \coqdoctac{omega}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{NF\_eq\_SN0} : \coqdockw{\ensuremath{\forall}} \coqdocvar{R} \coqdocvar{t}, \coqdocvar{NF} \coqdocvar{R} \coqdocvar{t} \ensuremath{\leftrightarrow} \coqdocvar{SN\_ind} 0 \coqdocvar{R} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros} \coqdocvar{R} \coqdocvar{t}. \coqdoctac{split}; [\coqdoctac{apply} \coqdocvar{NF\_to\_SN0} \ensuremath{|} \coqdoctac{apply} \coqdocvar{SN0\_to\_NF}]. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{WSN} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{k} \coqdocvar{R} \coqdocvar{t}, \coqdocvar{k} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow} \coqdocvar{SN\_ind} \coqdocvar{k} \coqdocvar{R} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{SN\_ind} \coqdocvar{n} \coqdocvar{R} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{k} \coqdocvar{R} \coqdocvar{t} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{destruct} \coqdocvar{H}; \coqdoctac{trivial}. \coqdoctac{intro} \coqdocvar{H'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{SN\_intro}. \coqdoctac{intros} \coqdocvar{t'} \coqdocvar{H'{}'}. \coqdoctac{destruct} \coqdocvar{H'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{H0} \coqdocvar{t'}); \coqdoctac{trivial}. \coqdoctac{intros} \coqdocvar{n'} \coqdocvar{H'{}'{}'}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{n'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}; \coqdoctac{try} \coqdoctac{omega}. \coqdoctac{apply} \coqdocvar{H'{}'{}'}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{SN\_one\_step} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) \coqdocvar{t} \coqdocvar{u}, \coqdocvar{R} \coqdocvar{t} \coqdocvar{u} \ensuremath{\rightarrow} \coqdocvar{SN\_ind} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{R} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{SN\_ind} \coqdocvar{n} \coqdocvar{R} \coqdocvar{u}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{R} \coqdocvar{t} \coqdocvar{u} \coqdocvar{H} \coqdocvar{H'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{destruct} \coqdocvar{H'}. \coqdoctac{case} (\coqdocvar{H0} \coqdocvar{u}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n'}. \coqdoctac{intro} \coqdocvar{H'}. \coqdoctac{apply} \coqdocvar{WSN} \coqdockw{with} (\coqdocvar{k} := \coqdocvar{n'}). \coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{NF\_eq\_SN0\_list} : \coqdockw{\ensuremath{\forall}} \coqdocvar{R} \coqdocvar{lt}, \coqdocvar{NF} \coqdocvar{R} \%\% \coqdocvar{lt} \ensuremath{\leftrightarrow} \coqdocvar{SN\_ind} 0 \coqdocvar{R} \%\% \coqdocvar{lt}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{R} \coqdocvar{lt}. \coqdoctac{induction} \coqdocvar{lt}; \coqdoctac{simpl}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{split}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{NF\_to\_SN0}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{IHlt}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{split}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{SN0\_to\_NF}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{IHlt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{WSN\_list} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{k} \coqdocvar{R} \coqdocvar{lt}, \coqdocvar{k} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow} \coqdocvar{SN\_ind} \coqdocvar{k} \coqdocvar{R} \%\% \coqdocvar{lt} \ensuremath{\rightarrow} \coqdocvar{SN\_ind} \coqdocvar{n} \coqdocvar{R} \%\% \coqdocvar{lt}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{k} \coqdocvar{R} \coqdocvar{lt} \coqdocvar{H}. \coqdoctac{induction} \coqdocvar{lt}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H'}. \coqdoctac{destruct} \coqdocvar{H'}. \coqdoctac{split}. \coqdoctac{apply} \coqdocvar{WSN} \coqdockw{with} (\coqdocvar{k} := \coqdocvar{k}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHlt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{SN\_list} : \coqdockw{\ensuremath{\forall}} \coqdocvar{R} \coqdocvar{lt}, \coqdocvar{SN} \coqdocvar{R} \%\% \coqdocvar{lt} \ensuremath{\leftrightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{n}, \coqdocvar{SN\_ind} \coqdocvar{n} \coqdocvar{R} \%\% \coqdocvar{lt}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{R} \coqdocvar{lt}. \coqdoctac{induction} \coqdocvar{lt}; \coqdoctac{simpl}; \coqdoctac{split}; \coqdoctac{intros}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{\ensuremath{\exists}} 0; \coqdoctac{trivial}. \coqdoctac{destruct} \coqdocvar{IHlt}. \coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{case} \coqdocvar{H0}; \coqdoctac{clear} \coqdocvar{H0}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H0}. \coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}. \coqdoctac{intros} \coqdocvar{n'} \coqdocvar{H}. \coqdoctac{\ensuremath{\exists}} (\coqdocvar{n} + \coqdocvar{n'}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}. \coqdoctac{apply} \coqdocvar{WSN} \coqdockw{with} (\coqdocvar{k} := \coqdocvar{n'}); \coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{WSN\_list} \coqdockw{with} (\coqdocvar{k} := \coqdocvar{n}); \coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}. \coqdoctac{split}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{n}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{IHlt}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{n}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Induction Principles Part 2 \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_size\_induction} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{P} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop},\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{P} (\coqdocvar{pterm\_fvar} \coqdocvar{x})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1},\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{body} \coqdocvar{t1} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t2} \coqdocvar{x}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{pterm\_size} \coqdocvar{t2} = \coqdocvar{pterm\_size} \coqdocvar{t1} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{term} (\coqdocvar{t2} \^{} \coqdocvar{x}) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{t2} \^{} \coqdocvar{x})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{P} (\coqdocvar{pterm\_abs} \coqdocvar{t1})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2},\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{term} \coqdocvar{t1} \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{t1} \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{pterm\_app} \coqdocvar{t1} \coqdocvar{t2})) \ensuremath{\rightarrow}\coqdoceol
\coqdocnoindent
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t3},\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{term} \coqdocvar{t3} \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{t3} \ensuremath{\rightarrow} \coqdocvar{body} \coqdocvar{t1} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{2.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t2} \coqdocvar{x}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{pterm\_size} \coqdocvar{t2} = \coqdocvar{pterm\_size} \coqdocvar{t1} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{term} (\coqdocvar{t2} \^{} \coqdocvar{x}) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{t2} \^{} \coqdocvar{x})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{P} (\coqdocvar{t1}[\coqdocvar{t3}])) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{P} \coqdocvar{Ha} \coqdocvar{Hb} \coqdocvar{Hc} \coqdocvar{Hd} \coqdocvar{t}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{gen\_eq} \coqdocvar{n}: (\coqdocvar{pterm\_size} \coqdocvar{t}). \coqdocvar{gen} \coqdocvar{t}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n} \coqdockw{using} \coqdocvar{peano\_induction}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{introv} \coqdocvar{Eq} \coqdocvar{T}. \coqdoctac{subst}. \coqdocvar{inverts} \coqdocvar{T}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply} \coqdocvar{Ha}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{Hc}. \coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{simpl}; \coqdoctac{omega}. \coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{simpl}; \coqdoctac{omega}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\times} \coqdocvar{Hb}.\coqdoceol
\coqdocindent{3.50em}
\coqdocvar{introv} \coqdocvar{Fr} \coqdocvar{Eq} \coqdocvar{T}.\coqdoceol
\coqdocindent{3.50em}
\coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{unfold} \coqdocvar{open}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{pterm\_size\_open\_var}. \coqdoctac{simpl}. \coqdoctac{omega}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\times} \coqdocvar{Hd}.\coqdoceol
\coqdocindent{3.50em}
\coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{simpl}; \coqdoctac{omega}.\coqdoceol
\coqdocindent{3.50em}
\coqdocvar{introv} \coqdocvar{Fr} \coqdocvar{Eq} \coqdocvar{T}. \coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{unfold} \coqdocvar{open}.\coqdoceol
\coqdocindent{3.50em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{pterm\_size\_open\_var}. \coqdoctac{simpl}. \coqdoctac{omega}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Tentativa de princípio de indução mais intuitivo \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{body\_size\_induction} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{P} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop},\coqdoceol
\coqdocindent{0.50em}
(\coqdocvar{P} (\coqdocvar{pterm\_bvar} 0)) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{P} (\coqdocvar{pterm\_fvar} \coqdocvar{x})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1}, (\coqdocvar{lc\_at} 2 \coqdocvar{t1}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t2} \coqdocvar{x}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{pterm\_size} \coqdocvar{t2} = \coqdocvar{pterm\_size} \coqdocvar{t1} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{body} (\coqdocvar{open\_rec} 1 (\coqdocvar{pterm\_fvar} \coqdocvar{x}) \coqdocvar{t2}) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{open\_rec} 1 (\coqdocvar{pterm\_fvar} \coqdocvar{x}) \coqdocvar{t2})) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{pterm\_abs} \coqdocvar{t1})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{body} \coqdocvar{t1} \ensuremath{\rightarrow} \coqdocvar{body} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{t1} \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{pterm\_app} \coqdocvar{t1} \coqdocvar{t2})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t3}, (\coqdocvar{lc\_at} 2 \coqdocvar{t1}) \ensuremath{\rightarrow} \coqdocvar{body} \coqdocvar{t3} \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{t3} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{2.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t2} \coqdocvar{x}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{pterm\_size} \coqdocvar{t2} = \coqdocvar{pterm\_size} \coqdocvar{t1} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{body} (\coqdocvar{open\_rec} 1 (\coqdocvar{pterm\_fvar} \coqdocvar{x}) \coqdocvar{t2}) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{open\_rec} 1 (\coqdocvar{pterm\_fvar} \coqdocvar{x}) \coqdocvar{t2})) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{t1}[\coqdocvar{t3}])) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{body} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{P} \coqdocvar{Ha} \coqdocvar{Hb} \coqdocvar{Hc} \coqdocvar{Hd} \coqdocvar{He} \coqdocvar{t}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{gen\_eq} \coqdocvar{n}: (\coqdocvar{pterm\_size} \coqdocvar{t}). \coqdocvar{gen} \coqdocvar{t}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n} \coqdockw{using} \coqdocvar{peano\_induction}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{introv} \coqdocvar{Eq} \coqdocvar{B}. \coqdoctac{subst}. \coqdoctac{destruct} \coqdocvar{t}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{generalize} \coqdocvar{B}; \coqdoctac{clear} \coqdocvar{B}; \coqdoctac{case} \coqdocvar{n}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{intro} \coqdocvar{B}; \coqdoctac{apply} \coqdocvar{Ha}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{intros} \coqdocvar{n'} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{not\_body\_Sn} \coqdoctac{in} \coqdocvar{H'}; \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply} \coqdocvar{Hb}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{Hd};\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply} \coqdocvar{body\_distribute\_over\_application} \coqdoctac{in} \coqdocvar{B}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply} \coqdocvar{B}. \coqdoctac{apply} \coqdocvar{B}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{simpl}; \coqdoctac{omega}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply} \coqdocvar{B}. \coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{simpl}; \coqdoctac{omega}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply} \coqdocvar{B}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\times} \coqdocvar{Hc}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply} \coqdocvar{body\_to\_body'} \coqdoctac{in} \coqdocvar{B}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{unfold} \coqdocvar{body'} \coqdoctac{in} \coqdocvar{B}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{B}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{introv} \coqdocvar{Fr} \coqdocvar{Eq}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{pterm\_size\_open\_var}. \coqdoctac{simpl}. \coqdoctac{omega}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply} \coqdocvar{body\_to\_body'} \coqdoctac{in} \coqdocvar{B}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{unfold} \coqdocvar{body'} \coqdoctac{in} \coqdocvar{B}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{B}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\times} \coqdocvar{He}. \coqdoctac{apply} \coqdocvar{body'\_to\_body}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{unfold} \coqdocvar{body'}. \coqdoctac{apply} \coqdocvar{B}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{simpl}. \coqdoctac{omega}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply} \coqdocvar{body'\_to\_body}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{unfold} \coqdocvar{body'}. \coqdoctac{apply} \coqdocvar{B}.\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{introv} \coqdocvar{Fr} \coqdocvar{Eq}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply}\ensuremath{\lnot} \coqdocvar{H}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{pterm\_size\_open\_var}. \coqdoctac{simpl}. \coqdoctac{omega}.\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{apply} \coqdocvar{body\_to\_body'} \coqdoctac{in} \coqdocvar{B}. \coqdoctac{unfold} \coqdocvar{body'} \coqdoctac{in} \coqdocvar{B}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{B}.\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_size\_induction2} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{P} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop},\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{l}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{u}, \coqdocvar{In} \coqdocvar{u} \coqdocvar{l} \ensuremath{\rightarrow} (\coqdocvar{term} \coqdocvar{u} \ensuremath{\land} \coqdocvar{P} \coqdocvar{u})) \ensuremath{\rightarrow} \coqdocvar{P} ((\coqdocvar{pterm\_fvar} \coqdocvar{x}) // \coqdocvar{l})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{l}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{u}, \coqdocvar{In} \coqdocvar{u} \coqdocvar{l} \ensuremath{\rightarrow} (\coqdocvar{term} \coqdocvar{u} \ensuremath{\land} \coqdocvar{P} \coqdocvar{u})) \ensuremath{\rightarrow} \coqdocvar{body} \coqdocvar{t1} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t2} \coqdocvar{x}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{pterm\_size} \coqdocvar{t2} = \coqdocvar{pterm\_size} \coqdocvar{t1} \ensuremath{\rightarrow} \coqdocvar{term} (\coqdocvar{t2} \^{} \coqdocvar{x}) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{t2} \^{} \coqdocvar{x})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{P} ((\coqdocvar{pterm\_abs} \coqdocvar{t1}) // \coqdocvar{l})) \ensuremath{\rightarrow}\coqdoceol
\coqdocnoindent
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t3} \coqdocvar{l},\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{u}, \coqdocvar{In} \coqdocvar{u} \coqdocvar{l} \ensuremath{\rightarrow} (\coqdocvar{term} \coqdocvar{u} \ensuremath{\land} \coqdocvar{P} \coqdocvar{u})) \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{t3} \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{t3} \ensuremath{\rightarrow} \coqdocvar{body} \coqdocvar{t1} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{2.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t2} \coqdocvar{x}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{pterm\_size} \coqdocvar{t2} = \coqdocvar{pterm\_size} \coqdocvar{t1} \ensuremath{\rightarrow} \coqdocvar{term} (\coqdocvar{t2} \^{} \coqdocvar{x}) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{t2} \^{} \coqdocvar{x})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{P} ((\coqdocvar{pterm\_sub} \coqdocvar{t1} \coqdocvar{t3}) // \coqdocvar{l}) ) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{l} \coqdocvar{t}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{u}, \coqdocvar{In} \coqdocvar{u} \coqdocvar{l} \ensuremath{\rightarrow} (\coqdocvar{term} \coqdocvar{u} \ensuremath{\land} \coqdocvar{P} \coqdocvar{u})) \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{t} // \coqdocvar{l})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{generalize} \coqdocvar{H3}. \coqdoctac{intro} \coqdocvar{T}. \coqdoctac{generalize} \coqdocvar{l} \coqdocvar{H2} \coqdocvar{H3}. \coqdoctac{clear} \coqdocvar{l} \coqdocvar{H2} \coqdocvar{H3}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{term\_size\_induction} \coqdockw{with} (\coqdocvar{t} := \coqdocvar{t}); \coqdoctac{trivial}; \coqdoctac{intros}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{H0}; \coqdoctac{trivial}; \coqdoctac{intros}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q} : \coqdocvar{P} (\coqdocvar{t2} \^{} \coqdocvar{x} // \coqdocvar{nil})).\coqdoceol
\coqdocindent{1.50em}
\coqdoctac{apply} \coqdocvar{H3}; \coqdoctac{simpl}; \coqdoctac{trivial}; \coqdoctac{intros}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{Q}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{replace} (\coqdocvar{pterm\_app} \coqdocvar{t1} \coqdocvar{t2} // \coqdocvar{l}) \coqdockw{with} (\coqdocvar{t1} // \coqdocvar{l} ++ (\coqdocvar{t2} :: \coqdocvar{nil})).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{H3}. \coqdoctac{intros}. \coqdoctac{apply} \coqdocvar{in\_app\_iff} \coqdoctac{in} \coqdocvar{H8}. \coqdoctac{destruct} \coqdocvar{H8}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{H6}; \coqdoctac{trivial}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H8}. \coqdoctac{destruct} \coqdocvar{H8}; \coqdoctac{try} \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H8}. \coqdoctac{clear} \coqdocvar{H8}. \coqdoctac{apply} \coqdocvar{term\_distribute\_over\_application} \coqdoctac{in} \coqdocvar{H7}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{destruct} \coqdocvar{H7}. \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q} : \coqdocvar{P} (\coqdocvar{t2} // \coqdocvar{nil})).\coqdoceol
\coqdocindent{1.50em}
\coqdoctac{apply} \coqdocvar{H5}; \coqdoctac{simpl}; \coqdoctac{trivial}; \coqdoctac{intros}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{Q}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{mult\_app\_append}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{H1}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q} : \coqdocvar{P} (\coqdocvar{t3} // \coqdocvar{nil})).\coqdoceol
\coqdocindent{1.50em}
\coqdoctac{apply} \coqdocvar{H3}; \coqdoctac{simpl}; \coqdoctac{trivial}; \coqdoctac{intros}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{Q}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q} : \coqdocvar{P} (\coqdocvar{t2} \^{} \coqdocvar{x} // \coqdocvar{nil})).\coqdoceol
\coqdocindent{1.50em}
\coqdoctac{apply} \coqdocvar{H5}; \coqdoctac{simpl}; \coqdoctac{trivial}; \coqdoctac{intros}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{Q}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_size\_induction3} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{P} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop},\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{l}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{u}, \coqdocvar{In} \coqdocvar{u} \coqdocvar{l} \ensuremath{\rightarrow} (\coqdocvar{term} \coqdocvar{u} \ensuremath{\land} \coqdocvar{P} \coqdocvar{u})) \ensuremath{\rightarrow} \coqdocvar{P} ((\coqdocvar{pterm\_fvar} \coqdocvar{x}) // \coqdocvar{l})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{l}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{u}, \coqdocvar{In} \coqdocvar{u} \coqdocvar{l} \ensuremath{\rightarrow} (\coqdocvar{term} \coqdocvar{u} \ensuremath{\land} \coqdocvar{P} \coqdocvar{u})) \ensuremath{\rightarrow} \coqdocvar{body} \coqdocvar{t1} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t2} \coqdocvar{x}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{pterm\_size} \coqdocvar{t2} = \coqdocvar{pterm\_size} \coqdocvar{t1} \ensuremath{\rightarrow} \coqdocvar{term} (\coqdocvar{t2} \^{} \coqdocvar{x}) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{t2} \^{} \coqdocvar{x})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{P} ((\coqdocvar{pterm\_abs} \coqdocvar{t1}) // \coqdocvar{l})) \ensuremath{\rightarrow}\coqdoceol
\coqdocnoindent
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t3} \coqdocvar{l},\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{u}, \coqdocvar{In} \coqdocvar{u} \coqdocvar{l} \ensuremath{\rightarrow} (\coqdocvar{term} \coqdocvar{u} \ensuremath{\land} \coqdocvar{P} \coqdocvar{u})) \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{t3} \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{t3} \ensuremath{\rightarrow} \coqdocvar{body} \coqdocvar{t1} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{2.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t2} \coqdocvar{x}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{pterm\_size} \coqdocvar{t2} = \coqdocvar{pterm\_size} \coqdocvar{t1} \ensuremath{\rightarrow} \coqdocvar{term} (\coqdocvar{t2} \^{} \coqdocvar{x}) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{t2} \^{} \coqdocvar{x})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{P} ((\coqdocvar{pterm\_sub} \coqdocvar{t1} \coqdocvar{t3}) // \coqdocvar{l}) ) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{replace} \coqdocvar{t} \coqdockw{with} (\coqdocvar{t} // \coqdocvar{nil}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{term\_size\_induction2}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\section{Tactics depending on lemmas}

\begin{coqdoccode}
\coqdocnoindent
\coqdockw{Ltac} \coqdocvar{remove\_dupterms} :=\coqdoceol
\coqdocnoindent
\coqdoctac{try} \coqdockw{match} \coqdockw{goal} \coqdockw{with}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} : \coqdocvar{term} ?\coqdocvar{t},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{H2} : \coqdocvar{term} ?\coqdocvar{t} \ensuremath{\vdash} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdoctac{clear} \coqdocvar{H2}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} : \coqdocvar{body} ?\coqdocvar{t},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{H2} : \coqdocvar{body} ?\coqdocvar{t} \ensuremath{\vdash} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdoctac{clear} \coqdocvar{H2}\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Definitions for solver tactics \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Hint Resolve} \coqdoceol
\coqdocindent{2.00em}
\coqdocvar{term\_var} \coqdoceol
\coqdocindent{2.00em}
\coqdocvar{term\_app} \coqdoceol
\coqdocindent{2.00em}
\coqdocvar{body\_open\_term} \coqdoceol
\coqdocindent{2.00em}
\coqdocvar{term\_open\_term} \coqdoceol
\coqdocindent{2.00em}
\coqdocvar{body\_to\_term\_abs}\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{body\_to\_subs} \coqdoceol
\coqdocindent{2.00em}
\coqdocvar{term\_to\_subs} \coqdoceol
\coqdocindent{2.00em}
\coqdocvar{term\_abs\_term}\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{close\_var\_body} : \coqdocvar{term\_building\_db}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Extracts all the information about what is a term in the context (one step) \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Ltac} \coqdocvar{term\_extractor} \coqdocvar{H} :=\coqdoceol
\coqdocnoindent
\coqdoctac{try}(\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} (\coqdocvar{type} \coqdocvar{of} \coqdocvar{H}) \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{term} (\coqdocvar{pterm\_app} ?\coqdocvar{u} ?\coqdocvar{u'}) \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{let} \coqdocvar{tmp} := \coqdoctac{fresh} \coqdocvar{H} \coqdoctac{in}\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{duplicate} \coqdocvar{H} \coqdocvar{tmp};\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{apply} \coqdocvar{term\_app\_to\_term\_l} \coqdoctac{in} \coqdocvar{tmp} ; \coqdocvar{term\_extractor} \coqdocvar{tmp};\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{apply} \coqdocvar{term\_app\_to\_term\_r} \coqdoctac{in} \coqdocvar{H} ; \coqdocvar{term\_extractor} \coqdocvar{H}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{term} (\coqdocvar{pterm\_sub} ?\coqdocvar{t} ?\coqdocvar{u}) \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{4.00em}
\coqdockw{let} \coqdocvar{tmp} := \coqdoctac{fresh} \coqdocvar{H} \coqdoctac{in}\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{duplicate} \coqdocvar{H} \coqdocvar{tmp};\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{apply} \coqdocvar{term\_sub\_to\_term} \coqdoctac{in} \coqdocvar{tmp} ; \coqdocvar{term\_extractor} \coqdocvar{tmp};\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{apply} \coqdocvar{term\_sub\_to\_body} \coqdoctac{in} \coqdocvar{H} ; \coqdocvar{term\_extractor} \coqdocvar{H}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{term} (\coqdocvar{pterm\_abs} ?\coqdocvar{t}) \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{apply} \coqdocvar{term\_abs\_to\_body} \coqdoctac{in} \coqdocvar{H} ; \coqdocvar{term\_extractor} \coqdocvar{H}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|}\coqdocvar{\_} \ensuremath{\Rightarrow} \coqdoctac{generalize} \coqdocvar{H} ; \coqdoctac{clear} \coqdocvar{H}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}).\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Extracts all the information about what is a term in the context (many step) \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Ltac} \coqdocvar{saturate\_term} :=\coqdoceol
\coqdocnoindent
\coqdoctac{try}(\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdockw{goal} \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{H} : \coqdocvar{term} \coqdocvar{\_} \ensuremath{\vdash} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{term\_extractor} \coqdocvar{H} ; \coqdocvar{saturate\_term}\coqdoceol
\coqdocnoindent
\coqdockw{end}).\coqdoceol
\coqdocemptyline
\end{coqdoccode}
About the interations between open, close, fvar, swap and bswap \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{swap\_id} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t}, [(\coqdocvar{x},\coqdocvar{x})]\coqdocvar{t} = \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{induction} \coqdocvar{t}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{v} == \coqdocvar{x}). \coqdoctac{intro}. \coqdoctac{rewrite} \coqdocvar{e}. \coqdoctac{trivial}. \coqdoctac{intro}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}. \coqdoctac{rewrite} \coqdocvar{IHt2}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}. \coqdoctac{rewrite} \coqdocvar{IHt2}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}. \coqdoctac{rewrite} \coqdocvar{IHt2}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{swap\_fresh} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{t}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t}) \ensuremath{\rightarrow} \coqdocvar{y} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t}) \ensuremath{\rightarrow} [(\coqdocvar{x},\coqdocvar{y})]\coqdocvar{t} = \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{induction} \coqdocvar{t}; \coqdoctac{simpl} \coqdoctac{in} *|-*; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q} : \coqdocvar{v} \ensuremath{\not=} \coqdocvar{x}). \coqdoctac{intro}. \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{H1}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q'}: \coqdocvar{v} \ensuremath{\not=} \coqdocvar{y}). \coqdoctac{intro}. \coqdoctac{apply} \coqdocvar{H0}. \coqdoctac{rewrite} \coqdocvar{H1}; \coqdoctac{trivial}. \coqdoctac{clear} \coqdocvar{H} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{v} == \coqdocvar{x}); \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{y}); \coqdoctac{intros}; \coqdoctac{try} \coqdocvar{contradiction}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{try} \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{try} \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{try} \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{swap\_inv} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{t}, [(\coqdocvar{x},\coqdocvar{y})]([(\coqdocvar{x},\coqdocvar{y})]\coqdocvar{t}) = \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{induction} \coqdocvar{t}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{v} == \coqdocvar{x}); \coqdoctac{intros}; \coqdoctac{simpl}. \coqdoctac{case} (\coqdocvar{y} == \coqdocvar{x}); \coqdoctac{case} (\coqdocvar{y} == \coqdocvar{y}); \coqdoctac{intros}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{e}; \coqdoctac{rewrite} \coqdocvar{e1}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{False\_ind}; \coqdoctac{apply} \coqdocvar{n}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{e}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{False\_ind}; \coqdoctac{apply} \coqdocvar{n}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{v} == \coqdocvar{y}); \coqdoctac{intros}; \coqdoctac{simpl}. \coqdoctac{case} (\coqdocvar{x} == \coqdocvar{x}); \coqdoctac{case} (\coqdocvar{x} == \coqdocvar{y}); \coqdoctac{intros}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{e}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{e}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{False\_ind}; \coqdoctac{apply} \coqdocvar{n0}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{False\_ind}; \coqdoctac{apply} \coqdocvar{n1}; \coqdoctac{trivial}. \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{x}); \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{y}); \coqdoctac{intros}; \coqdoctac{try} \coqdocvar{contradiction}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{IHt}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{swap\_var\_id} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{z}, \coqdocvar{z} \ensuremath{\not=} \coqdocvar{x} \ensuremath{\rightarrow} \coqdocvar{z} \ensuremath{\not=} \coqdocvar{y} \ensuremath{\rightarrow} [(\coqdocvar{x},\coqdocvar{y})](\coqdocvar{pterm\_fvar} \coqdocvar{z}) = \coqdocvar{pterm\_fvar} \coqdocvar{z}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{swap\_fresh}; \coqdoctac{simpl}; \coqdoctac{try} \coqdoctac{apply} \coqdocvar{notin\_singleton}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro}. \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{H1}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro}. \coqdoctac{apply} \coqdocvar{H0}. \coqdoctac{rewrite} \coqdocvar{H1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{swap\_sym} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{t}, [(\coqdocvar{x},\coqdocvar{y})]\coqdocvar{t} = [(\coqdocvar{y},\coqdocvar{x})]\coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{x} \coqdocvar{y} \coqdocvar{t}. \coqdoctac{induction} \coqdocvar{t}; \coqdoctac{simpl} \coqdoctac{in} *|-*; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{v} == \coqdocvar{x}); \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{y}); \coqdoctac{intros} \coqdocvar{H} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{swap\_var\_l} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y}, [(\coqdocvar{x},\coqdocvar{y})](\coqdocvar{pterm\_fvar} \coqdocvar{x}) = \coqdocvar{pterm\_fvar} \coqdocvar{y}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}; \coqdoctac{simpl}. \coqdoctac{case} (\coqdocvar{x} == \coqdocvar{x}); \coqdoctac{case} (\coqdocvar{x} == \coqdocvar{y}); \coqdoctac{intros}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{e}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{False\_ind}. \coqdoctac{apply} \coqdocvar{n0}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{swap\_var\_r} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y}, [(\coqdocvar{x},\coqdocvar{y})](\coqdocvar{pterm\_fvar} \coqdocvar{y}) = \coqdocvar{pterm\_fvar} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{swap\_sym}. \coqdoctac{apply} \coqdocvar{swap\_var\_l}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{swap\_eq\_m\_sb} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{x} \coqdocvar{y} \coqdocvar{z} : \coqdocvar{var}) \coqdocvar{t}, \coqdocvar{z} \ensuremath{\not=} \coqdocvar{x} \ensuremath{\rightarrow} \coqdocvar{z} \ensuremath{\not=} \coqdocvar{y} \ensuremath{\rightarrow} \coqdocvar{z} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t}) \ensuremath{\rightarrow}  \coqdoceol
\coqdocindent{3.00em}
\coqdocvar{m\_sb} \coqdocvar{z} (\coqdocvar{pterm\_fvar} \coqdocvar{y}) ((\coqdocvar{m\_sb} \coqdocvar{y} (\coqdocvar{pterm\_fvar} \coqdocvar{x}) (\coqdocvar{m\_sb} \coqdocvar{x} (\coqdocvar{pterm\_fvar} \coqdocvar{z}) \coqdocvar{t}))) = [(\coqdocvar{x},\coqdocvar{y})] \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}; \coqdoctac{trivial}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{x}); \coqdoctac{simpl}. \coqdoctac{case} (\coqdocvar{z} == \coqdocvar{y}); \coqdoctac{simpl}. \coqdoctac{case} (\coqdocvar{x} == \coqdocvar{z}); \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdocvar{contradiction}. \coqdoctac{case} (\coqdocvar{z} == \coqdocvar{z}); \coqdoctac{intros}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{False\_ind}. \coqdoctac{apply} \coqdocvar{n}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{v} == \coqdocvar{y}); \coqdoctac{simpl}. \coqdoctac{case} (\coqdocvar{x} == \coqdocvar{z}); \coqdoctac{intros}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{False\_ind}. \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{e}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{v} == \coqdocvar{z}); \coqdoctac{intros}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{False\_ind}. \coqdoctac{apply} \coqdocvar{H1}. \coqdoctac{rewrite} \coqdocvar{e}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H1}|-*. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H1}|-*. \coqdoctac{rewrite} \coqdocvar{IHt}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H1}|-*. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H1}|-*. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{open\_swap\_comm} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{z} \coqdocvar{t} \coqdocvar{n}, \coqdoceol
\coqdocindent{11.50em}
[(\coqdocvar{x},\coqdocvar{y})](\{\coqdocvar{n} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{z}\}\coqdocvar{t}) = \{\coqdocvar{n} \~{}> ([(\coqdocvar{x},\coqdocvar{y})]\coqdocvar{pterm\_fvar} \coqdocvar{z})\}([(\coqdocvar{x},\coqdocvar{y})]\coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{x} \coqdocvar{y} \coqdocvar{z} \coqdocvar{t}. \coqdoctac{induction} \coqdocvar{t}; \coqdoctac{intros}; \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{n0} === \coqdocvar{n}); \coqdoctac{simpl}; \coqdoctac{intros}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{v} == \coqdocvar{x}); \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{y}); \coqdoctac{case} (\coqdocvar{z} == \coqdocvar{x}); \coqdoctac{case} (\coqdocvar{z} == \coqdocvar{y}); \coqdoctac{intros}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}. \coqdoctac{rewrite} \coqdocvar{IHt2}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}. \coqdoctac{rewrite} \coqdocvar{IHt2}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}. \coqdoctac{rewrite} \coqdocvar{IHt2}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{open\_swap} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{x} \coqdocvar{y} \coqdocvar{z} : \coqdocvar{var}) \coqdocvar{t}, \coqdocvar{z} \ensuremath{\not=} \coqdocvar{x} \ensuremath{\rightarrow} \coqdocvar{z} \ensuremath{\not=} \coqdocvar{y} \ensuremath{\rightarrow} ([(\coqdocvar{x},\coqdocvar{y})]\coqdocvar{t})\^{}\coqdocvar{z} = [(\coqdocvar{x},\coqdocvar{y})]\coqdocvar{t}\^{}\coqdocvar{z}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros}. \coqdoctac{unfold} \coqdocvar{open}. \coqdoctac{rewrite} \coqdocvar{open\_swap\_comm}. \coqdoctac{rewrite} \coqdocvar{swap\_var\_id}; \coqdoctac{trivial}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{subst\_fvar}: \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{u}, [\coqdocvar{x} \~{}> \coqdocvar{u}](\coqdocvar{pterm\_fvar} \coqdocvar{x}) = \coqdocvar{u}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros}. \coqdoctac{simpl}. \coqdoctac{case} (\coqdocvar{x} == \coqdocvar{x}); \coqdoctac{intros}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{False\_ind}. \coqdoctac{apply} \coqdocvar{n}; \coqdoctac{trivial}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{swap\_eq\_open} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{x} \coqdocvar{y} : \coqdocvar{var}) \coqdocvar{t}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t}) \ensuremath{\rightarrow} \coqdocvar{y} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{4.00em}
(\{1 \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{y}\}(\{0 \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{x}\}\coqdocvar{t})) = \coqdoceol
\coqdocnoindent
[(\coqdocvar{x},\coqdocvar{y})] (\{1 \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{x}\}(\{0 \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{y}\}\coqdocvar{t})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{case} (\coqdocvar{x} == \coqdocvar{y}). \coqdoctac{intro}. \coqdoctac{rewrite} \coqdocvar{e}. \coqdoctac{rewrite} \coqdocvar{swap\_id}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H1}. \coqdocvar{pick\_fresh} \coqdocvar{z}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{Fr}. \coqdoctac{destruct} \coqdocvar{Fr}. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{destruct} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H4}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{swap\_eq\_m\_sb} \coqdockw{with} (\coqdocvar{z} := \coqdocvar{z}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{repeat} \coqdoctac{rewrite} \coqdocvar{subst\_open\_gen}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{replace}  ([\coqdocvar{z} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{y}]([\coqdocvar{y} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{x}]([\coqdocvar{x} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{z}]\coqdocvar{t}))) \coqdockw{with} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{replace} ([\coqdocvar{x} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{z}]\coqdocvar{pterm\_fvar} \coqdocvar{y}) \coqdockw{with} (\coqdocvar{pterm\_fvar} \coqdocvar{y}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{replace} ([\coqdocvar{y} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{x}]\coqdocvar{pterm\_fvar} \coqdocvar{y}) \coqdockw{with} (\coqdocvar{pterm\_fvar} \coqdocvar{x}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{replace} ([\coqdocvar{z} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{y}]\coqdocvar{pterm\_fvar} \coqdocvar{x}) \coqdockw{with} (\coqdocvar{pterm\_fvar} \coqdocvar{x}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{replace} ([\coqdocvar{x} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{z}]\coqdocvar{pterm\_fvar} \coqdocvar{x}) \coqdockw{with} (\coqdocvar{pterm\_fvar} \coqdocvar{z}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{replace} ([\coqdocvar{y} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{x}]\coqdocvar{pterm\_fvar} \coqdocvar{z}) \coqdockw{with} (\coqdocvar{pterm\_fvar} \coqdocvar{z}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{replace} ([\coqdocvar{z} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{y}]\coqdocvar{pterm\_fvar} \coqdocvar{z}) \coqdockw{with} (\coqdocvar{pterm\_fvar} \coqdocvar{y}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{subst\_fvar}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{subst\_fresh}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_singleton}. \coqdoctac{intro}. \coqdoctac{apply} \coqdocvar{H4}. \coqdoctac{rewrite} \coqdocvar{H5}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{subst\_fvar}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{subst\_fresh}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_singleton}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{subst\_fvar}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{subst\_fresh}; \coqdoctac{simpl}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{notin\_singleton}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{repeat} \coqdoctac{rewrite} \coqdocvar{subst\_fresh}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{repeat} \coqdoctac{rewrite} \coqdocvar{fv\_open\_}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{swap\_term} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{t}, \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{term} ([(\coqdocvar{x},\coqdocvar{y})]\coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{induction} \coqdocvar{H}; \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{x0} == \coqdocvar{x}); \coqdoctac{case} (\coqdocvar{x0} ==\coqdocvar{y}); \coqdoctac{intros}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{term\_app}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{term\_abs} \coqdockw{with} (\coqdocvar{L} := \coqdocvar{L} \symbol{92}\coqdocvar{u} \{\{\coqdocvar{x}\}\} \symbol{92}\coqdocvar{u} \{\{\coqdocvar{y}\}\}). \coqdoctac{intros} \coqdocvar{z} \coqdocvar{Hz}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{Hz}. \coqdoctac{destruct} \coqdocvar{Hz}. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H3}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{open\_swap}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{H0}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{term\_sub} \coqdockw{with} (\coqdocvar{L} := \coqdocvar{L} \symbol{92}\coqdocvar{u} \{\{\coqdocvar{x}\}\} \symbol{92}\coqdocvar{u} \{\{\coqdocvar{y}\}\}); \coqdoctac{trivial}. \coqdoctac{intros} \coqdocvar{z} \coqdocvar{Hz}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{Hz}. \coqdoctac{destruct} \coqdocvar{Hz}. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{destruct} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H3}. \coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H4}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{open\_swap}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{H0}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{swap\_fvar} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{S} \coqdocvar{t}, \coqdocvar{x} \symbol{92}\coqdoctac{in} \coqdocvar{S} \ensuremath{\rightarrow} \coqdocvar{y} \symbol{92}\coqdoctac{in} \coqdocvar{S} \ensuremath{\rightarrow} \coqdocvar{fv} \coqdocvar{t} << \coqdocvar{S} \ensuremath{\rightarrow} \coqdocvar{fv} ([(\coqdocvar{x},\coqdocvar{y})]\coqdocvar{t}) << \coqdocvar{S}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{induction} \coqdocvar{t}; \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{subset\_empty\_l}. \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{x}); \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{y}); \coqdoctac{simpl}; \coqdoctac{intros}; \coqdoctac{trivial};\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{subset\_singleton}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{rewrite} \coqdocvar{subset\_union\_l} \coqdoctac{in} *|-*. \coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}; [\coqdoctac{apply} \coqdocvar{IHt1}; \coqdoctac{trivial} \ensuremath{|} \coqdoctac{apply} \coqdocvar{IHt2}; \coqdoctac{trivial}].\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{apply} \coqdocvar{IHt}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{rewrite} \coqdocvar{subset\_union\_l} \coqdoctac{in} *|-*. \coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}; [\coqdoctac{apply} \coqdocvar{IHt1}; \coqdoctac{trivial} \ensuremath{|} \coqdoctac{apply} \coqdocvar{IHt2}; \coqdoctac{trivial}].\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{rewrite} \coqdocvar{subset\_union\_l} \coqdoctac{in} *|-*. \coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}; [\coqdoctac{apply} \coqdocvar{IHt1}; \coqdoctac{trivial} \ensuremath{|} \coqdoctac{apply} \coqdocvar{IHt2}; \coqdoctac{trivial}].\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{fv\_subset\_swap} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{t} \coqdocvar{L}, \coqdocvar{fv} \coqdocvar{t} << \coqdocvar{L} \ensuremath{\rightarrow} \coqdocvar{fv} ([(\coqdocvar{x}, \coqdocvar{y})]\coqdocvar{t}) << \coqdocvar{L} \symbol{92}\coqdocvar{u} \{\{\coqdocvar{x}\}\} \symbol{92}\coqdocvar{u} \{\{\coqdocvar{y}\}\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{x} \coqdocvar{y} \coqdocvar{t} \coqdocvar{L} \coqdocvar{H}. \coqdoctac{unfold} \coqdocvar{VarSet.Subset} \coqdoctac{in} *|-*.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{z} \coqdocvar{Hz}. \coqdoctac{apply} \coqdocvar{in\_union}. \coqdoctac{case} (\coqdocvar{z} == \coqdocvar{y}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H'}. \coqdoctac{right}. \coqdoctac{apply} \coqdocvar{in\_singleton}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H'}. \coqdoctac{left}. \coqdoctac{apply} \coqdocvar{in\_union}. \coqdoctac{case} (\coqdocvar{z} == \coqdocvar{x}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H'{}'}. \coqdoctac{right}. \coqdoctac{apply} \coqdocvar{in\_singleton}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H'{}'}. \coqdoctac{left}. \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{clear} \coqdocvar{H}. \coqdoctac{induction} \coqdocvar{t}; \coqdoctac{simpl} \coqdoctac{in} *|-*; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{generalize} \coqdocvar{Hz}; \coqdoctac{clear} \coqdocvar{Hz}. \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{x}); \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{y}); \coqdoctac{simpl}; \coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{H} \coqdocvar{H0} \coqdocvar{H1}; \coqdoctac{try} \coqdoctac{rewrite} \coqdocvar{in\_singleton} \coqdoctac{in} *|-*; \coqdoctac{try} \coqdocvar{contradiction}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{try} \coqdoctac{rewrite} \coqdocvar{in\_union} \coqdoctac{in} *|-*. \coqdoctac{destruct} \coqdocvar{Hz}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{left}; \coqdoctac{apply} \coqdocvar{IHt1}; \coqdoctac{trivial}. \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHt}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{try} \coqdoctac{rewrite} \coqdocvar{in\_union} \coqdoctac{in} *|-*. \coqdoctac{destruct} \coqdocvar{Hz}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{left}; \coqdoctac{apply} \coqdocvar{IHt1}; \coqdoctac{trivial}. \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{try} \coqdoctac{rewrite} \coqdocvar{in\_union} \coqdoctac{in} *|-*. \coqdoctac{destruct} \coqdocvar{Hz}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{left}; \coqdoctac{apply} \coqdocvar{IHt1}; \coqdoctac{trivial}. \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{fv\_swap} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{t}, \coqdocvar{y} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t} \ensuremath{\rightarrow} [(\coqdocvar{x},\coqdocvar{y})]\coqdocvar{t} = [\coqdocvar{x} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{y}]\coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{x} \coqdocvar{y} \coqdocvar{t} \coqdocvar{H}. \coqdoctac{induction} \coqdocvar{t}; \coqdoctac{simpl} \coqdoctac{in} *|-*; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{v} == \coqdocvar{y});  \coqdoctac{intro} \coqdocvar{H'}. \coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{False\_ind}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{rewrite} \coqdocvar{H'}; \coqdoctac{trivial}. \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{x}); \coqdoctac{intros}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{try} \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{try} \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{try} \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{bswap\_swap\_comm} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{t} \coqdocvar{n}, [(\coqdocvar{x},\coqdocvar{y})](\coqdocvar{bswap\_rec} \coqdocvar{n} \coqdocvar{t}) = \coqdocvar{bswap\_rec} \coqdocvar{n} ([(\coqdocvar{x},\coqdocvar{y})]\coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{x} \coqdocvar{y} \coqdocvar{t}; \coqdoctac{induction} \coqdocvar{t}; \coqdoctac{intros}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{unfold} \coqdocvar{swap}. \coqdoctac{fold} \coqdocvar{swap}. \coqdoctac{unfold} \coqdocvar{bswap\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{n0} === \coqdocvar{n}); \coqdoctac{case} (\coqdocvar{S} \coqdocvar{n0} === \coqdocvar{n}); \coqdoctac{intros}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{unfold} \coqdocvar{bswap\_rec}. \coqdoctac{fold} \coqdocvar{bswap\_rec}. \coqdoctac{unfold} \coqdocvar{swap}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{v} == \coqdocvar{x}); \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{y}); \coqdoctac{intros}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{IHt}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{bswap\_eq\_openclose} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{x} \coqdocvar{y} \coqdocvar{t}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t}) \ensuremath{\rightarrow} \coqdocvar{y} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t} \symbol{92}\coqdocvar{u} \{\{\coqdocvar{x}\}\}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdocvar{close\_rec} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{x} (\coqdocvar{close\_rec} \coqdocvar{n} \coqdocvar{y} (\coqdocvar{open\_rec} (\coqdocvar{S} \coqdocvar{n}) (\coqdocvar{pterm\_fvar} \coqdocvar{y}) (\coqdocvar{open\_rec} \coqdocvar{n} (\coqdocvar{pterm\_fvar} \coqdocvar{x}) \coqdocvar{t})))) =\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{bswap\_rec} \coqdocvar{n} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{destruct} \coqdocvar{H0}. \coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{generalize} \coqdocvar{n}; \coqdoctac{clear} \coqdocvar{n}. \coqdoctac{induction} \coqdocvar{t}; \coqdoctac{intros}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{unfolds} \coqdocvar{bswap\_rec}. \coqdocvar{unfolds} \coqdocvar{open\_rec}. \coqdocvar{unfolds} \coqdocvar{close\_rec}. \coqdoctac{case} (\coqdocvar{n0} === \coqdocvar{n}); \coqdoctac{intros}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{x} == \coqdocvar{y}); \coqdoctac{intros}. \coqdoctac{symmetry} \coqdoctac{in} \coqdocvar{e0}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{x} == \coqdocvar{x}); \coqdoctac{intros}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{False\_ind}. \coqdoctac{apply} \coqdocvar{n2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{S} \coqdocvar{n0} === \coqdocvar{n}); \coqdoctac{intros}. \coqdoctac{case} (\coqdocvar{y} == \coqdocvar{y}); \coqdoctac{intros}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{False\_ind}. \coqdoctac{apply} \coqdocvar{n2}; \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} *|-*. \coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{v} == \coqdocvar{y}); \coqdoctac{intros}; \coqdoctac{simpl}. \coqdoctac{symmetry} \coqdoctac{in} \coqdocvar{e}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{v} == \coqdocvar{x}); \coqdoctac{intros}; \coqdoctac{simpl}; \coqdoctac{trivial}. \coqdoctac{symmetry} \coqdoctac{in} \coqdocvar{e}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{IHt}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{openclose\_com} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{i} \coqdocvar{j} \coqdocvar{t}, \coqdocvar{x} \ensuremath{\not=} \coqdocvar{y} \ensuremath{\rightarrow} \coqdocvar{i} \ensuremath{\not=} \coqdocvar{j} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{3.00em}
(\{\coqdocvar{i} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{x}\}\coqdocvar{close\_rec} \coqdocvar{j} \coqdocvar{y} \coqdocvar{t}) = \coqdocvar{close\_rec} \coqdocvar{j} \coqdocvar{y} (\{\coqdocvar{i} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{x}\}\coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{generalize} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H0}; \coqdoctac{clear} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H0}. \coqdoctac{induction} \coqdocvar{t}; \coqdoctac{intros}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{unfold} \coqdocvar{open\_rec}. \coqdoctac{unfold} \coqdocvar{close\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{i} === \coqdocvar{n}); \coqdoctac{case} (\coqdocvar{x} == \coqdocvar{y}); \coqdoctac{intros}; \coqdoctac{trivial}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{y}); \coqdoctac{intros}; \coqdoctac{trivial}. \coqdoctac{unfold} \coqdocvar{open\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{i} ===\coqdocvar{j}); \coqdoctac{intros}; \coqdoctac{trivial}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{IHt}; \coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{body\_term\_fvar} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t} \coqdocvar{n}, \coqdoceol
\coqdocnoindent
\coqdocvar{lc\_at} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t}) \ensuremath{\rightarrow} \coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} (\coqdocvar{open\_rec} \coqdocvar{n} (\coqdocvar{pterm\_fvar} \coqdocvar{x}) \coqdocvar{t})) \ensuremath{\rightarrow}\coqdoceol
\coqdocnoindent
\coqdocvar{lc\_at} \coqdocvar{n} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{x} \coqdocvar{t} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{generalize} \coqdocvar{n}; \coqdoctac{clear} \coqdocvar{n}. \coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n'} \coqdocvar{H0} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{unfolds} \coqdocvar{open\_rec}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} (\coqdocvar{n'} === \coqdocvar{n}). \coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{assert} (\coqdocvar{x} = \coqdocvar{x}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{trivial}. \coqdocvar{contradiction}. \coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} *|-*. \coqdoctac{omega}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H0} \coqdocvar{H1} \coqdocvar{H2}. \coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H0} \coqdocvar{H1} \coqdocvar{H2}. \coqdoctac{simpl} \coqdoctac{in} *|-*.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{H0}; \coqdoctac{clear} \coqdocvar{H0}; \coqdoctac{intros} \coqdocvar{H0t1} \coqdocvar{H0t2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{H1}; \coqdoctac{clear} \coqdocvar{H1}; \coqdoctac{intros} \coqdocvar{H1t1} \coqdocvar{H1t2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{H2}; \coqdoctac{clear} \coqdocvar{H2}; \coqdoctac{intros} \coqdocvar{H2t1} \coqdocvar{H2t2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{IHt1} \coqdocvar{n} \coqdocvar{H0t1} \coqdocvar{H1t1} \coqdocvar{H2t1}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{IHt2} \coqdocvar{n} \coqdocvar{H0t2} \coqdocvar{H1t2} \coqdocvar{H2t2}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H0} \coqdocvar{H1} \coqdocvar{H2}. \coqdoctac{simpl} \coqdoctac{in} *|-*.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{IHt} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{H0} \coqdocvar{H1} \coqdocvar{H2}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H0} \coqdocvar{H1} \coqdocvar{H2}. \coqdoctac{simpl} \coqdoctac{in} *|-*.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{H0}; \coqdoctac{clear} \coqdocvar{H0}; \coqdoctac{intros} \coqdocvar{H0t1} \coqdocvar{H0t2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{H1}; \coqdoctac{clear} \coqdocvar{H1}; \coqdoctac{intros} \coqdocvar{H1t1} \coqdocvar{H1t2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{H2}; \coqdoctac{clear} \coqdocvar{H2}; \coqdoctac{intros} \coqdocvar{H2t1} \coqdocvar{H2t2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{H0t1} \coqdocvar{H1t1} \coqdocvar{H2t1}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{IHt2} \coqdocvar{n} \coqdocvar{H0t2} \coqdocvar{H1t2} \coqdocvar{H2t2}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{not\_body\_term\_fvar} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t} \coqdocvar{n}, \coqdoceol
\coqdocnoindent
\coqdocvar{lc\_at} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t}) \ensuremath{\rightarrow} \coqdocvar{x} \symbol{92}\coqdoctac{in} (\coqdocvar{fv} (\coqdocvar{open\_rec} \coqdocvar{n} (\coqdocvar{pterm\_fvar} \coqdocvar{x}) \coqdocvar{t})) \ensuremath{\rightarrow}\coqdoceol
\coqdocnoindent
\ensuremath{\lnot} \coqdocvar{lc\_at} \coqdocvar{n} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{x} \coqdocvar{t} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{generalize} \coqdocvar{n}; \coqdoctac{clear} \coqdocvar{n}. \coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n'} \coqdocvar{H0} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{unfolds} \coqdocvar{open\_rec}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} (\coqdocvar{n'} === \coqdocvar{n}). \coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} *|-*. \coqdoctac{omega}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} *|-*. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H0} \coqdocvar{H1} \coqdocvar{H2}. \coqdoctac{simpl} \coqdoctac{in} *|-*. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H0} \coqdocvar{H1} \coqdocvar{H2}. \coqdoctac{simpl} \coqdoctac{in} *|-*.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{in\_union} \coqdoctac{in} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{H0}; \coqdoctac{clear} \coqdocvar{H0}; \coqdoctac{intros} \coqdocvar{H0t1} \coqdocvar{H0t2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{H1}; \coqdoctac{clear} \coqdocvar{H1}; \coqdoctac{intros} \coqdocvar{H1t1} \coqdocvar{H1t2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{case} \coqdocvar{H}. \coqdoctac{clear} \coqdocvar{H}. \coqdoctac{intros} \coqdocvar{H} \coqdocvar{H'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H2'}. \coqdoctac{generalize} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{IHt1} \coqdocvar{n} \coqdocvar{H0t1} \coqdocvar{H1t1} \coqdocvar{H2'}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H2'}. \coqdoctac{generalize} \coqdocvar{H'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{IHt2} \coqdocvar{n} \coqdocvar{H0t2} \coqdocvar{H1t2} \coqdocvar{H2'}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H0} \coqdocvar{H1} \coqdocvar{H2}. \coqdoctac{simpl} \coqdoctac{in} *|-*.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{IHt} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{H0} \coqdocvar{H1} \coqdocvar{H2}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H0} \coqdocvar{H1} \coqdocvar{H2}. \coqdoctac{simpl} \coqdoctac{in} *|-*.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{in\_union} \coqdoctac{in} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{H0}; \coqdoctac{clear} \coqdocvar{H0}; \coqdoctac{intros} \coqdocvar{H0t1} \coqdocvar{H0t2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{H1}; \coqdoctac{clear} \coqdocvar{H1}; \coqdoctac{intros} \coqdocvar{H1t1} \coqdocvar{H1t2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{case} \coqdocvar{H}. \coqdoctac{clear} \coqdocvar{H}. \coqdoctac{intros} \coqdocvar{H} \coqdocvar{H'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H2'}. \coqdoctac{generalize} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{H0t1} \coqdocvar{H1t1} \coqdocvar{H2'}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H2'}. \coqdoctac{generalize} \coqdocvar{H'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{IHt2} \coqdocvar{n} \coqdocvar{H0t2} \coqdocvar{H1t2} \coqdocvar{H2'}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rec\_close\_open\_term} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{x} \coqdocvar{k}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t}) \ensuremath{\rightarrow} \coqdocvar{t} = \coqdocvar{close\_rec} \coqdocvar{k} \coqdocvar{x} (\coqdocvar{open\_rec} \coqdocvar{k} (\coqdocvar{pterm\_fvar} \coqdocvar{x}) \coqdocvar{t}).\coqdoceol
\coqdocindent{0.50em}
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{x}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{k} \coqdocvar{H1}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{k} === \coqdocvar{n}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H2}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{x} == \coqdocvar{x}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{H2}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H3}. \coqdoctac{assert} (\coqdocvar{x} = \coqdocvar{x}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H2}. \coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{k} \coqdocvar{H}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{x}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H1}. \coqdoctac{assert} (\coqdocvar{x} = \coqdocvar{v}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{auto}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{k} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}; \coqdocvar{fequals}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHt1}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHt2}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{k} \coqdocvar{H}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{fequals}. \coqdoctac{apply} \coqdocvar{IHt}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{assumption}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{k} \coqdocvar{H}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{fequals}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHt1}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHt2}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{k} \coqdocvar{H}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{fequals}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHt1}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHt2}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{close\_open\_term} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{x}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t}) \ensuremath{\rightarrow} \coqdocvar{t} = \coqdocvar{close} (\coqdocvar{t} \^{} \coqdocvar{x}) \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{unfold} \coqdocvar{open}. \coqdoctac{unfold} \coqdocvar{close}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{rec\_close\_open\_term}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{lc\_at\_subst}: \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u} \coqdocvar{x}, \coqdocvar{lc\_at} \coqdocvar{n} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{lc\_at} \coqdocvar{n} \coqdocvar{u} \ensuremath{\rightarrow} \coqdocvar{lc\_at} \coqdocvar{n} ([\coqdocvar{x} \~{}> \coqdocvar{u}]\coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u} \coqdocvar{x}. \coqdoctac{generalize} \coqdocvar{n}; \coqdoctac{clear} \coqdocvar{n}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n'}. \coqdoctac{simpl}. \coqdoctac{intros}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n'}. \coqdoctac{simpl}. \coqdoctac{intros}; \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{x}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}; \coqdoctac{trivial}. \coqdoctac{simpl}. \coqdoctac{intros}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{H1} \coqdocvar{H2}. \coqdoctac{case} \coqdocvar{H1}; \coqdoctac{clear} \coqdocvar{H1}; \coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H3}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}. \coqdoctac{apply} \coqdocvar{IHt1}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{n'} \coqdocvar{H1} \coqdocvar{H2}. \coqdoctac{apply} \coqdocvar{IHt}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{lc\_at\_weaken\_ind} \coqdockw{with} (\coqdocvar{k1} := \coqdocvar{n'}); \coqdoctac{trivial}; \coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{n'} \coqdocvar{H1} \coqdocvar{H2}. \coqdoctac{case} \coqdocvar{H1}; \coqdoctac{clear} \coqdocvar{H1}; \coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H3}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}. \coqdoctac{apply} \coqdocvar{IHt1}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{lc\_at\_weaken\_ind} \coqdockw{with} (\coqdocvar{k1} := \coqdocvar{n'}); \coqdoctac{trivial}; \coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{lc\_at\_subst'}: \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u} \coqdocvar{x}, \coqdocvar{lc\_at} \coqdocvar{n} ([\coqdocvar{x} \~{}> \coqdocvar{u}]\coqdocvar{t}) \ensuremath{\rightarrow} \coqdocvar{lc\_at} \coqdocvar{n} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u} \coqdocvar{x}. \coqdoctac{generalize} \coqdocvar{n}; \coqdoctac{clear} \coqdocvar{n}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n'}. \coqdoctac{simpl}. \coqdoctac{intros}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n'}. \coqdoctac{simpl}. \coqdoctac{intros}; \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{x});\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}. \coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}. \coqdoctac{apply} \coqdocvar{IHt1}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{n'} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{IHt}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{n'} \coqdocvar{H}. \coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}. \coqdoctac{apply} \coqdocvar{IHt1}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size\_bswap\_rec} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{t}, \coqdocvar{pterm\_size} (\coqdocvar{bswap\_rec} \coqdocvar{n} \coqdocvar{t}) = \coqdocvar{pterm\_size} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{t}. \coqdoctac{generalize} \coqdocvar{n}; \coqdoctac{clear} \coqdocvar{n}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n'}. \coqdocvar{unfolds} \coqdocvar{bswap\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{n'} === \coqdocvar{n}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{S} \coqdocvar{n'} === \coqdocvar{n}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}; \coqdoctac{intro} \coqdocvar{n}; \coqdoctac{rewrite} (\coqdocvar{IHt1} \coqdocvar{n}); \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}; \coqdoctac{intro} \coqdocvar{n}; \coqdoctac{rewrite} (\coqdocvar{IHt} (\coqdocvar{S} \coqdocvar{n})); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}; \coqdoctac{intro} \coqdocvar{n}; \coqdoctac{rewrite} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n})); \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}; \coqdoctac{intro} \coqdocvar{n}; \coqdoctac{rewrite} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n})); \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{fv\_bswap\_rec} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{t}, \coqdocvar{fv} (\coqdocvar{bswap\_rec} \coqdocvar{n} \coqdocvar{t}) = \coqdocvar{fv} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{t}. \coqdoctac{generalize} \coqdocvar{n}; \coqdoctac{clear} \coqdocvar{n}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n'}. \coqdocvar{unfolds} \coqdocvar{bswap\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{n'} === \coqdocvar{n}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{S} \coqdocvar{n'} === \coqdocvar{n}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}; \coqdoctac{intro} \coqdocvar{n}; \coqdoctac{rewrite} (\coqdocvar{IHt1} \coqdocvar{n}); \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}; \coqdoctac{intro} \coqdocvar{n}; \coqdoctac{rewrite} (\coqdocvar{IHt} (\coqdocvar{S} \coqdocvar{n})); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}; \coqdoctac{intro} \coqdocvar{n}; \coqdoctac{rewrite} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n})); \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}; \coqdoctac{intro} \coqdocvar{n}; \coqdoctac{rewrite} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n})); \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{open\_bswap} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u} \coqdocvar{v}, \coqdocvar{term} \coqdocvar{v} \ensuremath{\rightarrow} \coqdoceol
\coqdocnoindent
(\coqdocvar{open\_rec} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{u} (\coqdocvar{open\_rec} \coqdocvar{n} \coqdocvar{v} \coqdocvar{t})) = (\coqdocvar{open\_rec} \coqdocvar{n} \coqdocvar{u} (\coqdocvar{open\_rec} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{v} (\coqdocvar{bswap\_rec} \coqdocvar{n} \coqdocvar{t}))).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u} \coqdocvar{v} \coqdocvar{T}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{generalize} \coqdocvar{n}; \coqdoctac{clear} \coqdocvar{n}; \coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n'}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{unfolds} \coqdocvar{bswap\_rec}. \coqdocvar{unfolds} \coqdocvar{open\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{case\_nat}\ensuremath{\times}. \coqdoctac{fold} \coqdocvar{open\_rec}. \coqdocvar{case\_nat}\ensuremath{\times}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{replace} (\{\coqdocvar{S} \coqdocvar{n} \~{}> \coqdocvar{u}\}\coqdocvar{v}) \coqdockw{with} \coqdocvar{v};\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{replace} (\{\coqdocvar{n} \~{}> \coqdocvar{u}\}\coqdocvar{v}) \coqdockw{with} \coqdocvar{v}; \coqdoctac{trivial};\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{open\_rec\_term}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{case\_nat}\ensuremath{\times}. \coqdoctac{fold} \coqdocvar{open\_rec}. \coqdocvar{case\_nat}\ensuremath{\times}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{e0} \coqdoctac{in} \coqdocvar{e}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdocvar{case\_nat}\ensuremath{\times}. \coqdocvar{case\_nat}\ensuremath{\times}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{case\_nat}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} (\coqdocvar{IHt1} \coqdocvar{n'}). \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n'}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} (\coqdocvar{IHt} (\coqdocvar{S} \coqdocvar{n'})). \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n'})). \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n'}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{rewrite} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n'})). \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n'}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{subst\_com} :\coqdockw{\ensuremath{\forall}} \coqdocvar{i} \coqdocvar{j} \coqdocvar{t} \coqdocvar{u} \coqdocvar{v}, \coqdocvar{i} \ensuremath{\not=} \coqdocvar{j} \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{u} \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{v} \ensuremath{\rightarrow} \coqdoceol
\coqdocnoindent
(\coqdocvar{open\_rec} \coqdocvar{i} \coqdocvar{u} (\coqdocvar{open\_rec} \coqdocvar{j} \coqdocvar{v} \coqdocvar{t})) = (\coqdocvar{open\_rec} \coqdocvar{j} \coqdocvar{v} (\coqdocvar{open\_rec} \coqdocvar{i} \coqdocvar{u} \coqdocvar{t})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{i} \coqdocvar{j} \coqdocvar{t} \coqdocvar{u} \coqdocvar{v} \coqdocvar{H} \coqdocvar{Tu} \coqdocvar{Tv}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{generalize} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H}. \coqdoctac{clear} \coqdocvar{H} \coqdocvar{i} \coqdocvar{j}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{unfolds} \coqdocvar{open\_rec}. \coqdocvar{case\_nat}\ensuremath{\times}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{fold} \coqdocvar{open\_rec}. \coqdocvar{case\_nat}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{unfolds} \coqdocvar{open\_rec}. \coqdocvar{case\_nat}\ensuremath{\times}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{fold} \coqdocvar{open\_rec}. \coqdoctac{replace} (\{\coqdocvar{i} \~{}> \coqdocvar{u}\}\coqdocvar{v}) \coqdockw{with} \coqdocvar{v}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{open\_rec\_term}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{case\_nat}. \coqdoctac{fold} \coqdocvar{open\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{open\_rec\_term}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{case\_nat}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} (\coqdocvar{IHt1} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H}). \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q}: (\coqdocvar{S} \coqdocvar{i}) \ensuremath{\not=} (\coqdocvar{S} \coqdocvar{j})). \coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} (\coqdocvar{IHt} (\coqdocvar{S} \coqdocvar{i}) (\coqdocvar{S} \coqdocvar{j}) \coqdocvar{Q}). \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q}: (\coqdocvar{S} \coqdocvar{i}) \ensuremath{\not=} (\coqdocvar{S} \coqdocvar{j})). \coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{i}) (\coqdocvar{S} \coqdocvar{j}) \coqdocvar{Q}). \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H}). \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q}: (\coqdocvar{S} \coqdocvar{i}) \ensuremath{\not=} (\coqdocvar{S} \coqdocvar{j})). \coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{i}) (\coqdocvar{S} \coqdocvar{j}) \coqdocvar{Q}). \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H}). \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{body\_open\_bswap}: \coqdockw{\ensuremath{\forall}} \coqdocvar{i} \coqdocvar{j} \coqdocvar{t} \coqdocvar{x}, \coqdoceol
\coqdocnoindent
\coqdocvar{lc\_at} \coqdocvar{i} (\{\coqdocvar{j} \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{x}\} \coqdocvar{t}) \ensuremath{\rightarrow}\coqdoceol
\coqdocnoindent
\coqdocvar{lc\_at} \coqdocvar{i} (\{(\coqdocvar{S} \coqdocvar{j}) \~{}> \coqdocvar{pterm\_fvar} \coqdocvar{x}\}(\coqdocvar{bswap\_rec} \coqdocvar{j} \coqdocvar{t})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{i} \coqdocvar{j} \coqdocvar{t} \coqdocvar{x}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{generalize} \coqdocvar{i} \coqdocvar{j}; \coqdoctac{clear} \coqdocvar{i} \coqdocvar{j}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H}. \coqdocvar{unfolds} \coqdocvar{bswap\_rec}. \coqdocvar{unfolds} \coqdocvar{open\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{case\_nat}\ensuremath{\times}. \coqdocvar{case\_nat}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{case\_nat}\ensuremath{\times}. \coqdocvar{case\_nat}. \coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{replace} \coqdocvar{n} \coqdockw{with} (\coqdocvar{S} \coqdocvar{j}) \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{unfolds} \coqdocvar{lc\_at}. \coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{case\_nat}. \coqdoctac{simpl}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H}. \coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H}. \coqdoctac{split}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} (\coqdocvar{IHt1} \coqdocvar{i} \coqdocvar{j}). \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} (\coqdocvar{IHt2} \coqdocvar{i} \coqdocvar{j}). \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} (\coqdocvar{IHt} (\coqdocvar{S} \coqdocvar{i}) (\coqdocvar{S} \coqdocvar{j})). \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{i} \coqdocvar{j} \coqdocvar{H}. \coqdoctac{split}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{i}) (\coqdocvar{S} \coqdocvar{j})). \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} (\coqdocvar{IHt2} \coqdocvar{i} \coqdocvar{j}). \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{lc\_at\_bswap} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{k} \coqdocvar{t}, \coqdocvar{S} \coqdocvar{k} < \coqdocvar{n} \ensuremath{\rightarrow} \coqdocvar{lc\_at} \coqdocvar{n} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{lc\_at} \coqdocvar{n} (\coqdocvar{bswap\_rec} \coqdocvar{k} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{k} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{generalize} \coqdocvar{n} \coqdocvar{k}; \coqdoctac{clear} \coqdocvar{n} \coqdocvar{k}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n'} \coqdocvar{k} \coqdocvar{H0} \coqdocvar{H1}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{unfolds} \coqdocvar{bswap\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{k} === \coqdocvar{n}). \coqdoctac{intro} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{H2}. \coqdoctac{simpl}. \coqdoctac{omega}. \coqdoctac{intro} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{S} \coqdocvar{k} === \coqdocvar{n}). \coqdoctac{intro} \coqdocvar{H3}. \coqdoctac{simpl}. \coqdoctac{omega}. \coqdoctac{intro} \coqdocvar{H3}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{k} \coqdocvar{H0} \coqdocvar{H1}. \coqdoctac{simpl} \coqdoctac{in} *|-*. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{k} \coqdocvar{H0} \coqdocvar{H1}. \coqdoctac{simpl} \coqdoctac{in} *|-*. \coqdoctac{destruct} \coqdocvar{H1}. \coqdoctac{split}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHt1}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{k} \coqdocvar{H0} \coqdocvar{H1}. \coqdoctac{simpl} \coqdoctac{in} *|-*.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHt}; \coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{k} \coqdocvar{H0} \coqdocvar{H1}. \coqdoctac{simpl} \coqdoctac{in} *|-*. \coqdoctac{destruct} \coqdocvar{H1}. \coqdoctac{split}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHt1}; \coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{k} \coqdocvar{H0} \coqdocvar{H1}. \coqdoctac{simpl} \coqdoctac{in} *|-*. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{lc\_at\_open} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u}, \coqdocvar{term} \coqdocvar{u} \ensuremath{\rightarrow} (\coqdocvar{lc\_at} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{t} \ensuremath{\leftrightarrow} \coqdocvar{lc\_at} \coqdocvar{n} (\coqdocvar{open\_rec} \coqdocvar{n} \coqdocvar{u} \coqdocvar{t})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u} \coqdocvar{T}. \coqdoctac{split}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{generalize} \coqdocvar{n}; \coqdoctac{clear} \coqdocvar{n}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n'} \coqdocvar{H0}. \coqdocvar{unfolds} \coqdocvar{open\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{n'} === \coqdocvar{n}). \coqdoctac{intro} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{H1} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{rewrite} \coqdocvar{H1}. \coqdoctac{simpl} \coqdoctac{in} *|-*.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{term\_to\_term'} \coqdoctac{in} \coqdocvar{T}. \coqdoctac{unfold} \coqdocvar{term'} \coqdoctac{in} \coqdocvar{T}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{lc\_at\_weaken\_ind} \coqdockw{with} (\coqdocvar{k1} := 0); \coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H1}. \coqdoctac{simpl} \coqdoctac{in} *|-*. \coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}. \coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}. \coqdoctac{simpl} \coqdoctac{in} *|-*.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intros} \coqdocvar{Ht1} \coqdocvar{Ht2}; \coqdoctac{split}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} (\coqdocvar{IHt1} \coqdocvar{n} \coqdocvar{Ht1}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} (\coqdocvar{IHt2} \coqdocvar{n} \coqdocvar{Ht2}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}. \coqdoctac{simpl} \coqdoctac{in} *|-*.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} (\coqdocvar{IHt} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{H}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}. \coqdoctac{simpl} \coqdoctac{in} *|-*.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intros} \coqdocvar{Ht1} \coqdocvar{Ht2}; \coqdoctac{split}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{Ht1}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} (\coqdocvar{IHt2} \coqdocvar{n} \coqdocvar{Ht2}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{generalize} \coqdocvar{n}; \coqdoctac{clear} \coqdocvar{n}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n'} \coqdocvar{H0}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{n'} === \coqdocvar{n}) \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{simpl}. \coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} *|-*. \coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} *|-*. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intros} \coqdocvar{Ht1} \coqdocvar{Ht2}; \coqdoctac{split}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} (\coqdocvar{IHt1} \coqdocvar{n} \coqdocvar{Ht1}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} (\coqdocvar{IHt2} \coqdocvar{n} \coqdocvar{Ht2}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} *|-*. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} (\coqdocvar{IHt} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{H}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} *|-*. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intros} \coqdocvar{Ht1} \coqdocvar{Ht2}; \coqdoctac{split}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{Ht1}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} (\coqdocvar{IHt2} \coqdocvar{n} \coqdocvar{Ht2}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{lc\_at\_open'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{k} \coqdocvar{t} \coqdocvar{u}, \coqdocvar{term} \coqdocvar{u} \ensuremath{\rightarrow} \coqdocvar{k} < \coqdocvar{n} \ensuremath{\rightarrow} (\coqdocvar{lc\_at} \coqdocvar{n} (\coqdocvar{open\_rec} \coqdocvar{k} \coqdocvar{u} \coqdocvar{t}) \ensuremath{\leftrightarrow} \coqdocvar{lc\_at} \coqdocvar{n} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{k} \coqdocvar{t} \coqdocvar{u} \coqdocvar{H}; \coqdoctac{generalize} \coqdocvar{n} \coqdocvar{k}; \coqdoctac{clear} \coqdocvar{n} \coqdocvar{k}. \coqdoctac{induction} \coqdocvar{t}; \coqdoctac{simpl}; \coqdoctac{intros}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{k} === \coqdocvar{n}); \coqdoctac{simpl}. \coqdoctac{intros}. \coqdoctac{split}. \coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{apply} \coqdocvar{lc\_at\_weaken\_ind} \coqdockw{with} (\coqdocvar{k1} := 0); \coqdoctac{try} \coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{term\_eq\_term'}; \coqdoctac{trivial}. \coqdoctac{intros}; \coqdoctac{split}; \coqdoctac{trivial}. \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q1} : \coqdocvar{lc\_at} \coqdocvar{n} (\{\coqdocvar{k} \~{}> \coqdocvar{u}\}\coqdocvar{t1}) \ensuremath{\leftrightarrow} \coqdocvar{lc\_at} \coqdocvar{n} \coqdocvar{t1}). \coqdoctac{apply} \coqdocvar{IHt1}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q2} : \coqdocvar{lc\_at} \coqdocvar{n} (\{\coqdocvar{k} \~{}> \coqdocvar{u}\}\coqdocvar{t2}) \ensuremath{\leftrightarrow} \coqdocvar{lc\_at} \coqdocvar{n} \coqdocvar{t2}). \coqdoctac{apply} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}; \coqdoctac{intro} \coqdocvar{H1}; \coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}; [\coqdoctac{apply} \coqdocvar{Q1}; \coqdoctac{trivial} \ensuremath{|} \coqdoctac{apply} \coqdocvar{Q2}; \coqdoctac{trivial}].\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}; [\coqdoctac{apply} \coqdocvar{Q1}; \coqdoctac{trivial} \ensuremath{|} \coqdoctac{apply} \coqdocvar{Q2}; \coqdoctac{trivial}].\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q} :(\coqdocvar{lc\_at} (\coqdocvar{S} \coqdocvar{n}) (\{(\coqdocvar{S} \coqdocvar{k}) \~{}> \coqdocvar{u}\}\coqdocvar{t}) \ensuremath{\leftrightarrow} \coqdocvar{lc\_at} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{t})). \coqdoctac{apply} \coqdocvar{IHt}; \coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{Q}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q1} :(\coqdocvar{lc\_at} (\coqdocvar{S} \coqdocvar{n}) (\{(\coqdocvar{S} \coqdocvar{k}) \~{}> \coqdocvar{u}\}\coqdocvar{t1}) \ensuremath{\leftrightarrow} \coqdocvar{lc\_at} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{t1})). \coqdoctac{apply} \coqdocvar{IHt1}; \coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q2} : \coqdocvar{lc\_at} \coqdocvar{n} (\{\coqdocvar{k} \~{}> \coqdocvar{u}\}\coqdocvar{t2}) \ensuremath{\leftrightarrow} \coqdocvar{lc\_at} \coqdocvar{n} \coqdocvar{t2}). \coqdoctac{apply} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}; \coqdoctac{intro} \coqdocvar{H1}; \coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}; [\coqdoctac{apply} \coqdocvar{Q1}; \coqdoctac{trivial} \ensuremath{|} \coqdoctac{apply} \coqdocvar{Q2}; \coqdoctac{trivial}].\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}; [\coqdoctac{apply} \coqdocvar{Q1}; \coqdoctac{trivial} \ensuremath{|} \coqdoctac{apply} \coqdocvar{Q2}; \coqdoctac{trivial}].\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{split}; \coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
bswap is idempotent. \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{bswap\_rec\_id} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{t}, \coqdocvar{bswap\_rec} \coqdocvar{n} (\coqdocvar{bswap\_rec} \coqdocvar{n} \coqdocvar{t})  = \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{generalize} \coqdocvar{n}. \coqdoctac{clear} \coqdocvar{n}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n'}. \coqdocvar{unfolds} \coqdocvar{bswap\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{n'} === \coqdocvar{n}). \coqdoctac{intro} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{n'} === \coqdocvar{S} \coqdocvar{n'}). \coqdoctac{intros} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q}: \coqdocvar{n'} \ensuremath{\not=} \coqdocvar{S} \coqdocvar{n'}). \coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{contradiction}. \coqdoctac{intro} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{S} \coqdocvar{n'} === \coqdocvar{S} \coqdocvar{n'}). \coqdoctac{intro} \coqdocvar{H3}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{H1}. \coqdoctac{trivial}. \coqdoctac{intro} \coqdocvar{H3}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{Q}: \coqdocvar{S} \coqdocvar{n'} = \coqdocvar{S} \coqdocvar{n'}). \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{contradiction}. \coqdoctac{intro} \coqdocvar{H}. \coqdoctac{fold} \coqdocvar{bswap\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{S} \coqdocvar{n'} === \coqdocvar{n}). \coqdoctac{intro} \coqdocvar{H1}. \coqdocvar{unfolds} \coqdocvar{bswap\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{n'} === \coqdocvar{n'}). \coqdoctac{intro} \coqdocvar{H2}. \coqdoctac{rewrite} \coqdocvar{H1}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{H2}. \coqdoctac{assert} (\coqdocvar{Q}: \coqdocvar{n'} = \coqdocvar{n'}). \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{contradiction}. \coqdoctac{intro} \coqdocvar{H1}. \coqdocvar{unfolds} \coqdocvar{bswap\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{n'} === \coqdocvar{n}). \coqdoctac{intro} \coqdocvar{H2}. \coqdocvar{contradiction}. \coqdoctac{intro} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{S} \coqdocvar{n'} === \coqdocvar{n}). \coqdoctac{intro} \coqdocvar{H3}. \coqdocvar{contradiction}. \coqdoctac{intro} \coqdocvar{H3}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n}. \coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n}. \coqdoctac{simpl}. \coqdoctac{rewrite} (\coqdocvar{IHt1} \coqdocvar{n}). \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n}. \coqdoctac{simpl}. \coqdoctac{rewrite} (\coqdocvar{IHt} (\coqdocvar{S} \coqdocvar{n})). \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n}. \coqdoctac{simpl}. \coqdoctac{rewrite} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n})). \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n}. \coqdoctac{simpl}. \coqdoctac{rewrite} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n})). \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{bswap\_idemp} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t}, (\& (\& \coqdocvar{t})) = \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{t}. \coqdoctac{unfold} \coqdocvar{bswap}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{bswap\_rec\_id}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{bswap\_lc\_at} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{t}, \coqdocvar{lc\_at} \coqdocvar{n} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{bswap\_rec} \coqdocvar{n} \coqdocvar{t} = \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{t}. \coqdoctac{generalize} \coqdocvar{n}. \coqdoctac{clear} \coqdocvar{n}. \coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n'} \coqdocvar{H}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{unfolds} \coqdocvar{bswap\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{n'} === \coqdocvar{n}). \coqdoctac{intro} \coqdocvar{H1}. \coqdoctac{rewrite} \coqdocvar{H1} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{assert} (\~{} \coqdocvar{n} < \coqdocvar{n}). \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H1}. \coqdoctac{case} (\coqdocvar{S} \coqdocvar{n'} === \coqdocvar{n}). \coqdoctac{intro} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{replace} \coqdocvar{n} \coqdockw{with} (\coqdocvar{S} \coqdocvar{n'}) \coqdoctac{in} \coqdocvar{H}. \coqdoctac{assert} (\~{} (\coqdocvar{S} \coqdocvar{n'}) < \coqdocvar{n'}). \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}. \coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} (\coqdocvar{IHt1} \coqdocvar{n} \coqdocvar{H1}). \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n} \coqdocvar{H2}). \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}. \coqdoctac{rewrite} (\coqdocvar{IHt} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{H}). \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}. \coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{H1}). \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n} \coqdocvar{H2}). \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{bswap\_n\_term} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{n}, \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{bswap\_rec} \coqdocvar{n} \coqdocvar{t} = \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{n} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{bswap\_lc\_at}. \coqdoctac{apply} \coqdocvar{lc\_at\_weaken}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{term\_to\_term'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{bswap\_term} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{t} = \& \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{H}. \coqdoctac{unfold} \coqdocvar{bswap}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{bswap\_n\_term}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{subst\_bswap\_rec} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{x} \coqdocvar{u} \coqdocvar{t}, \coqdocvar{lc\_at} \coqdocvar{n} \coqdocvar{u} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.50em}
[\coqdocvar{x} \~{}> \coqdocvar{u}] (\coqdocvar{bswap\_rec} \coqdocvar{n} \coqdocvar{t}) = \coqdocvar{bswap\_rec} \coqdocvar{n} ([\coqdocvar{x} \~{}> \coqdocvar{u}] \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{x} \coqdocvar{u} \coqdocvar{t}. \coqdoctac{generalize} \coqdocvar{n}. \coqdoctac{clear} \coqdocvar{n}. \coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n'}. \coqdoctac{replace} ([\coqdocvar{x} \~{}> \coqdocvar{u}]\coqdocvar{pterm\_bvar} \coqdocvar{n}) \coqdockw{with} (\coqdocvar{pterm\_bvar} \coqdocvar{n}).\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{unfolds} \coqdocvar{bswap\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{n'} === \coqdocvar{n}). \coqdoctac{intros}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{S} \coqdocvar{n'} === \coqdocvar{n}); \coqdoctac{intros}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n'}. \coqdoctac{simpl}. \coqdoctac{case} (\coqdocvar{v} == \coqdocvar{x}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{bswap\_lc\_at}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}. \coqdoctac{simpl}. \coqdoctac{rewrite} (\coqdocvar{IHt1} \coqdocvar{n} \coqdocvar{H}). \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n} \coqdocvar{H}). \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}. \coqdoctac{simpl}. \coqdoctac{rewrite} (\coqdocvar{IHt} (\coqdocvar{S} \coqdocvar{n})). \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{lc\_at\_weaken\_ind} \coqdockw{with} (\coqdocvar{k1} := \coqdocvar{n}); \coqdoctac{trivial}; \coqdoctac{try} \coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}. \coqdoctac{simpl}. \coqdoctac{rewrite} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n})). \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{lc\_at\_weaken\_ind} \coqdockw{with} (\coqdocvar{k1} := \coqdocvar{n}); \coqdoctac{trivial}; \coqdoctac{try} \coqdoctac{omega}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}. \coqdoctac{simpl}. \coqdoctac{rewrite} (\coqdocvar{IHt1} (\coqdocvar{S} \coqdocvar{n})). \coqdoctac{rewrite} (\coqdocvar{IHt2} \coqdocvar{n}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{lc\_at\_weaken\_ind} \coqdockw{with} (\coqdocvar{k1} := \coqdocvar{n}); \coqdoctac{trivial}; \coqdoctac{try} \coqdoctac{omega}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{open\_lc\_at} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u}, \coqdocvar{lc\_at} \coqdocvar{n} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{open\_rec} \coqdocvar{n} \coqdocvar{u} \coqdocvar{t} = \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u}. \coqdoctac{generalize} \coqdocvar{n}; \coqdoctac{clear} \coqdocvar{n}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{induction} \coqdocvar{t}. \coqdoctac{intro} \coqdocvar{n'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intro} \coqdocvar{H}. \coqdoctac{case} (\coqdocvar{n'} === \coqdocvar{n}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H1}. \coqdoctac{rewrite} \coqdocvar{H1} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{assert} (\~{} \coqdocvar{n} < \coqdocvar{n}). \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H1}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{n}. \coqdoctac{simpl}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{try} \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{try} \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt}; \coqdoctac{try} \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{try} \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{try} \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{bswap\_open\_rec} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{k} \coqdocvar{t} \coqdocvar{u}, \coqdocvar{k} > \coqdocvar{S} \coqdocvar{n} \ensuremath{\rightarrow} \coqdocvar{lc\_at} \coqdocvar{n} \coqdocvar{u} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{bswap\_rec} \coqdocvar{n} (\coqdocvar{open\_rec} \coqdocvar{k} \coqdocvar{u} \coqdocvar{t}) = \coqdocvar{open\_rec} \coqdocvar{k} \coqdocvar{u} (\coqdocvar{bswap\_rec} \coqdocvar{n} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{k} \coqdocvar{t} \coqdocvar{u}. \coqdoctac{generalize} \coqdocvar{n} \coqdocvar{k}; \coqdoctac{clear} \coqdocvar{n} \coqdocvar{k}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{induction} \coqdocvar{t}. \coqdoctac{intros} \coqdocvar{n'} \coqdocvar{k} \coqdocvar{H} \coqdocvar{H'}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{unfolds} \coqdocvar{open\_rec}. \coqdoctac{case} (\coqdocvar{k} === \coqdocvar{n}). \coqdoctac{fold} \coqdocvar{open\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H0}. \coqdoctac{unfold} \coqdocvar{bswap}. \coqdocvar{unfolds} \coqdocvar{bswap\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{n'} === \coqdocvar{n}). \coqdoctac{fold} \coqdocvar{bswap\_rec}. \coqdoctac{intro} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{H1} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\~{} \coqdocvar{n} > \coqdocvar{S} \coqdocvar{n}). \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{fold} \coqdocvar{bswap\_rec}. \coqdoctac{case} (\coqdocvar{S} \coqdocvar{n'} === \coqdocvar{n}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2}. \coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{H1} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\~{} \coqdocvar{n} < \coqdocvar{n}). \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{H0}. \coqdoctac{simpl}. \coqdoctac{case} (\coqdocvar{n} === \coqdocvar{n}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H3}. \coqdoctac{apply} \coqdocvar{bswap\_lc\_at}; \coqdoctac{trivial}. \coqdoctac{intro} \coqdocvar{H3}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{n} = \coqdocvar{n}). \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{contradiction}. \coqdoctac{intro} \coqdocvar{H0}. \coqdoctac{fold} \coqdocvar{open\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{unfold} \coqdocvar{bswap}. \coqdocvar{unfolds} \coqdocvar{bswap\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{n'} === \coqdocvar{n}). \coqdoctac{fold} \coqdocvar{bswap\_rec}. \coqdoctac{intro} \coqdocvar{H1}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{unfolds} \coqdocvar{open\_rec}. \coqdoctac{case} (\coqdocvar{k} === \coqdocvar{S} \coqdocvar{n'}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H2}. \coqdoctac{rewrite} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{H1} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\~{} \coqdocvar{S} \coqdocvar{n} > \coqdocvar{S} \coqdocvar{n}). \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H2}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{fold} \coqdocvar{bswap\_rec}. \coqdoctac{case} (\coqdocvar{n'} === \coqdocvar{n}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2}. \coqdoctac{case} (\coqdocvar{S} \coqdocvar{n'}=== \coqdocvar{n}). \coqdoctac{intro} \coqdocvar{H3}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{contradiction}. \coqdocvar{unfolds} \coqdocvar{open\_rec}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} (\coqdocvar{k} === \coqdocvar{n}). \coqdoctac{intros} \coqdocvar{H3} \coqdocvar{H4}; \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{reflexivity}. \coqdoctac{case} (\coqdocvar{S} \coqdocvar{n'} === \coqdocvar{n}). \coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2} \coqdocvar{H3}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{unfolds} \coqdocvar{open\_rec}. \coqdoctac{case} (\coqdocvar{k} === \coqdocvar{n'}). \coqdoctac{intro} \coqdocvar{H4}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{H4} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{assert} (\~{} \coqdocvar{n'} > \coqdocvar{S} \coqdocvar{n'}). \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{reflexivity}. \coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2} \coqdocvar{H3}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{unfolds} \coqdocvar{open\_rec}. \coqdoctac{case} (\coqdocvar{k} === \coqdocvar{n}). \coqdoctac{intro} \coqdocvar{H4}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{contradiction}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}; \coqdocvar{unfolds}; \coqdoctac{simpl}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{unfold} \coqdocvar{bswap} \coqdoctac{in} *|-*. \coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{k} \coqdocvar{H} \coqdocvar{H'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{unfold} \coqdocvar{bswap} \coqdoctac{in} *|-*. \coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{k} \coqdocvar{H} \coqdocvar{H'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt}; \coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{lc\_at\_weaken\_ind} \coqdockw{with} (\coqdocvar{k1} := \coqdocvar{n}); \coqdoceol
\coqdocindent{0.50em}
\coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{unfold} \coqdocvar{bswap} \coqdoctac{in} *|-*. \coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{k} \coqdocvar{H} \coqdocvar{H'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{lc\_at\_weaken\_ind} \coqdockw{with} (\coqdocvar{k1} := \coqdocvar{n}); \coqdoceol
\coqdocindent{0.50em}
\coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{n} \coqdocvar{k} \coqdocvar{H} \coqdocvar{H'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt1}; \coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{IHt2}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{lc\_at\_weaken\_ind} \coqdockw{with} (\coqdocvar{k1} := \coqdocvar{n}); \coqdoceol
\coqdocindent{0.50em}
\coqdoctac{try} \coqdoctac{omega}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{lc\_at\_open\_rec\_rename}: \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{x} \coqdocvar{y} \coqdocvar{m} \coqdocvar{n}, \coqdocvar{lc\_at} \coqdocvar{m} (\coqdocvar{open\_rec} \coqdocvar{n} (\coqdocvar{pterm\_fvar} \coqdocvar{x}) \coqdocvar{t}) \ensuremath{\rightarrow} \coqdocvar{lc\_at} \coqdocvar{m} (\coqdocvar{open\_rec} \coqdocvar{n} (\coqdocvar{pterm\_fvar} \coqdocvar{y}) \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{t}. \coqdoctac{simpl}. \coqdocvar{introv} \coqdocvar{H}. \coqdocvar{case\_nat}. \coqdoctac{constructor}. \coqdoctac{assumption}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{intros}; \coqdoctac{trivial}. \coqdoctac{simpl}. \coqdocvar{introv} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{IHt1} \coqdocvar{x} \coqdocvar{y}) \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} (\coqdocvar{IHt2} \coqdocvar{x} \coqdocvar{y}) \coqdoctac{in} \coqdocvar{H0}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}; \coqdoctac{assumption}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{introv} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{IHt} \coqdockw{with} \coqdocvar{x}. \coqdoctac{assumption}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{introv} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{split}. \coqdoctac{apply} \coqdocvar{IHt1} \coqdockw{with} \coqdocvar{x}; \coqdoctac{assumption}. \coqdoctac{apply} \coqdocvar{IHt2} \coqdockw{with} \coqdocvar{x}; \coqdoctac{assumption}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Corollary} \coqdocvar{term\_open\_rename}: \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{x} \coqdocvar{y}, \coqdocvar{term} (\coqdocvar{t}\^{}\coqdocvar{x}) \ensuremath{\rightarrow} \coqdocvar{term} (\coqdocvar{t}\^{}\coqdocvar{y}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{introv} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{term\_eq\_term'} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{term\_eq\_term'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{lc\_at\_open\_rec\_rename} \coqdockw{with} \coqdocvar{x}. \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{body\_to\_term}: \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{x}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{body} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{term} (\coqdocvar{t}\^{}\coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{inversion}\ensuremath{\times} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_to\_body}: \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{x}, \coqdocvar{x} \symbol{92}\coqdocvar{notin} \coqdocvar{fv} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{term} (\coqdocvar{t}\^{}\coqdocvar{x}) \ensuremath{\rightarrow} \coqdocvar{body} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{introv} \coqdocvar{H} \coqdocvar{H'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{body}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{fv} \coqdocvar{t}). \coqdocvar{introv} \coqdocvar{H'{}'}. \coqdoctac{apply} \coqdocvar{term\_open\_rename} \coqdockw{with} \coqdocvar{x}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Properties of reduction \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{red\_regular} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{R} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} \coqdocvar{term} \coqdocvar{t} \ensuremath{\land} \coqdocvar{term} \coqdocvar{t'}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{red\_regular'} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{R} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} (\coqdocvar{term} \coqdocvar{t} \ensuremath{\leftrightarrow} \coqdocvar{term} \coqdocvar{t'}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{red\_refl} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{R} \coqdocvar{t} \coqdocvar{t}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{red\_in} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{x} \coqdocvar{u} \coqdocvar{u'}, \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{R} \coqdocvar{u} \coqdocvar{u'} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{R} ([\coqdocvar{x} \~{}> \coqdocvar{u}]\coqdocvar{t}) ([\coqdocvar{x} \~{}> \coqdocvar{u'}]\coqdocvar{t}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{red\_all} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{R} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{u} \coqdocvar{u'}, \coqdocvar{R} \coqdocvar{u} \coqdocvar{u'} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
\coqdocvar{R} ([\coqdocvar{x}\~{}>\coqdocvar{u}]\coqdocvar{t}) ([\coqdocvar{x}\~{}>\coqdocvar{u'}]\coqdocvar{t'}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{red\_out} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{u} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{term} \coqdocvar{u} \ensuremath{\rightarrow} \coqdocvar{R} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
\coqdocvar{R} ([\coqdocvar{x}\~{}>\coqdocvar{u}]\coqdocvar{t}) ([\coqdocvar{x}\~{}>\coqdocvar{u}]\coqdocvar{t'}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{red\_out'} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{R} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
\coqdocvar{R} ([\coqdocvar{x}\~{}>\coqdocvar{pterm\_fvar} \coqdocvar{y}]\coqdocvar{t}) ([\coqdocvar{x}\~{}>\coqdocvar{pterm\_fvar} \coqdocvar{y}]\coqdocvar{t'}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{red\_rename} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{y},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t}) \ensuremath{\rightarrow} \coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t'}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{R} (\coqdocvar{t} \^{} \coqdocvar{x}) (\coqdocvar{t'} \^{} \coqdocvar{x}) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
\coqdocvar{R} (\coqdocvar{t} \^{} \coqdocvar{y}) (\coqdocvar{t'} \^{} \coqdocvar{y}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{red\_rename'} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{y},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t}) \ensuremath{\rightarrow} \coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t'}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{y} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t}) \ensuremath{\rightarrow} \coqdocvar{y} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t'}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{R} (\coqdocvar{t} \^{} \coqdocvar{x}) (\coqdocvar{t'} \^{} \coqdocvar{x}) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
\coqdocvar{R} (\coqdocvar{t} \^{} \coqdocvar{y}) (\coqdocvar{t'} \^{} \coqdocvar{y}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{red\_swap} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{y},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{R} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{R} ([(\coqdocvar{x},\coqdocvar{y})]\coqdocvar{t}) ([(\coqdocvar{x},\coqdocvar{y})]\coqdocvar{t'}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{red\_through} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{u1} \coqdocvar{u2}, \coqdoceol
\coqdocindent{1.00em}
\coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t1}) \ensuremath{\rightarrow} \coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{u1}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{R} (\coqdocvar{t1} \^{} \coqdocvar{x}) (\coqdocvar{u1} \^{} \coqdocvar{x}) \ensuremath{\rightarrow} \coqdocvar{R} \coqdocvar{t2} \coqdocvar{u2} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{R} (\coqdocvar{t1} \^{}\^{} \coqdocvar{t2}) (\coqdocvar{u1} \^{}\^{} \coqdocvar{u2}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{red\_not\_fv} (\coqdocvar{R}: \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{R} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t}) \ensuremath{\rightarrow} \coqdocvar{x} \symbol{92}\coqdocvar{notin} (\coqdocvar{fv} \coqdocvar{t'}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{red\_fv} (\coqdocvar{R}: \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{R} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{x} \symbol{92}\coqdoctac{in} (\coqdocvar{fv} \coqdocvar{t'}) \ensuremath{\rightarrow} \coqdocvar{x} \symbol{92}\coqdoctac{in} (\coqdocvar{fv} \coqdocvar{t}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{red\_regular\_ctx}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}),\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{red\_regular} \coqdocvar{R} \ensuremath{\rightarrow} \coqdocvar{red\_regular} (\coqdocvar{ES\_contextual\_closure} \coqdocvar{R}).\coqdoceol
\coqdocindent{0.50em}
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{intros\_all}. \coqdoctac{induction} \coqdocvar{H0}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{IHES\_contextual\_closure}; \coqdoctac{clear} \coqdocvar{IHES\_contextual\_closure}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H2} \coqdocvar{H3}. \coqdoctac{split}; \coqdoctac{apply} \coqdocvar{term\_distribute\_over\_application}; \coqdoctac{split} ; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{IHES\_contextual\_closure}; \coqdoctac{clear} \coqdocvar{IHES\_contextual\_closure}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H2} \coqdocvar{H3}. \coqdoctac{split}; \coqdoctac{apply} \coqdocvar{term\_distribute\_over\_application}; \coqdoctac{split} ; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{body\_to\_term\_abs}; \coqdoctac{unfold} \coqdocvar{body}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{L};\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{H1}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{body\_to\_subs}; \coqdoctac{trivial}; \coqdoctac{unfold} \coqdocvar{body}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{L}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{H1}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{body\_to\_subs}; \coqdoctac{apply} \coqdocvar{term\_is\_a\_body} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assumption}. \coqdoctac{apply} \coqdocvar{IHES\_contextual\_closure}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assumption}. \coqdoctac{apply} \coqdocvar{IHES\_contextual\_closure}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{red\_regular\_trans}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}),\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{red\_regular} \coqdocvar{R} \ensuremath{\rightarrow} \coqdocvar{red\_regular} (\coqdocvar{trans\_closure} \coqdocvar{R}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{intros\_all}. \coqdoctac{induction} \coqdocvar{H0}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{assumption}. \coqdoctac{split}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{IHtrans\_closure1}. \coqdoctac{apply} \coqdocvar{IHtrans\_closure2}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
flavio 2016/02/19
Lemma SN\_app : forall n R t u, red\_regular R ->  
               SN\_ind n (ES\_contextual\_closure R) (pterm\_app t u) ->
               SN\_ind n (ES\_contextual\_closure R) t /\symbol{92} SN\_ind n (ES\_contextual\_closure R) u.
Proof.
 intros n R t u Reg. 
 generalize dependent u.
 generalize dependent t.
 induction n.  intros t u H. split; rewrite <- NF\_eq\_SN0 in *; unfold NF in *. 
 intros t' H'. apply (H (pterm\_app t' u)).
 apply ES\_app\_left. assumption.
 false\_goal.
 assert (ES\_contextual\_closure R (pterm\_app t u) (pterm\_app t' u)).
 apply ES\_app\_left; trivial. 
 intros u' H'. apply (H (pterm\_app t u')). apply ES\_app\_right; trivial.
 intros t u H. destruct H. split. 
 apply SN\_intro. intros t' H'. exists n. split; try omega. 
 apply IHn with (t := t') (u := u); trivial. apply red\_regular\_ctx in Reg.
 apply Reg in H'. apply H'. case (H (pterm\_app t' u)). apply app\_left; trivial. 
 intros k H''. apply WSN with (k := k). omega. apply H''.
 apply SN\_intro. intros u' H'. exists n. split; try omega. 
 apply IHn with (t := t) (u := u'); trivial. apply red\_regular\_ctx in Reg.
 apply Reg in H'. apply H'. case (H (pterm\_app t u')). apply app\_right; trivial. 
 intros k H''. apply WSN with (k := k). omega. apply H''.
Qed. 


Lemma SN\_abs : forall x n R t, red\_regular R -> red\_out R -> 
               SN\_ind n (contextual\_closure R) (pterm\_abs t) ->
               x \symbol{92}notin (fv t) -> SN\_ind n (contextual\_closure R) (t \^{} x).
Proof.
 intros x n R t Reg Out.
 generalize t; clear t.
 apply red\_regular\_ctx in Reg. gg
 apply red\_out\_ctx in Out. 
 apply red\_out\_to\_rename in Out.
 induction n. intros. 
 apply SN0\_to\_NF in H. 
 apply NF\_to\_SN0; unfold NF in *|-*.
 intros t' H'. gen\_eq t0 : (close t' x). intro H1.
 replace t' with (t0 \^{} x) in H'.
 assert (Q: contextual\_closure R (pterm\_abs t) (pterm\_abs t0)).
    apply abs\_in with (L := \footnote{\url{x}}). intros z H2. 
    apply notin\_singleton in H2. apply Out with (x := x); trivial.
    rewrite H1. apply fv\_close'.
 assert (Q': \~{} contextual\_closure R (pterm\_abs t) (pterm\_abs t0)).
    apply H.
 contradiction. rewrite H1. rewrite open\_close\_var with (x := x).
 reflexivity. apply Reg in H'. apply H'.
 intros. destruct H. apply SN\_intro.
 intros. exists n. split; try omega.
 gen\_eq t0 : (close t' x). intro H2.
 replace t' with (t0 \^{} x). replace t' with (t0 \^{} x) in H1.
 apply IHn; trivial. case (H (pterm\_abs t0)); trivial.
 apply abs\_in with (L := \footnote{\url{x}}).
 intros z H3. apply notin\_singleton in H3. 
 apply Out with (x := x); trivial.
 rewrite H2. apply fv\_close'.
 intros k H3. apply WSN with (k := k); try omega.
 apply H3. rewrite H2. apply fv\_close'.
 rewrite H2. rewrite open\_close\_var with (x := x).
 reflexivity. apply Reg in H1. apply H1.
 rewrite H2. rewrite open\_close\_var with (x := x).
 reflexivity. apply Reg in H1. apply H1. 
Qed.


Lemma SN\_sub : forall x n R t u, red\_regular R -> red\_out R -> 
               body t -> term u -> x \symbol{92}notin (fv t) -> 
               SN\_ind n (contextual\_closure R) (t\coqdocvar{u}) ->
               SN\_ind n (contextual\_closure R) (t \^{} x) /\symbol{92}
               SN\_ind n (contextual\_closure R) u.
Proof.
 intros x n R t u Reg Out.
 generalize t u; clear t u.
 apply red\_regular\_ctx in Reg. 
 apply red\_out\_ctx in Out. 
 apply red\_out\_to\_rename in Out.
 induction n. intros. 
 apply SN0\_to\_NF in H2. split; intros;
 apply NF\_to\_SN0; unfold NF in *|-*.
 intros t' H'. gen\_eq t0 : (close t' x). intro H3.
 replace t' with (t0 \^{} x) in H'.
 assert (Q: contextual\_closure R (t\coqdocvar{u})(t0\coqdocvar{u})).
    apply subst\_left with (L := \footnote{\url{x}}); trivial. intros z H4. 
    apply notin\_singleton in H4. apply Out with (x := x); trivial.
    rewrite H3. apply fv\_close'.
 assert (Q': \~{} contextual\_closure R (t\coqdocvar{u}) (t0\coqdocvar{u})).
    apply H2.
 contradiction. rewrite H3. rewrite open\_close\_var with (x := x).
 reflexivity. apply Reg in H'. apply H'.
 intros t' H'.
 assert (Q: contextual\_closure R (t\coqdocvar{u})(t\coqdocvar{t'})).
   apply subst\_right; trivial. 
 assert (Q': \~{} contextual\_closure R (t\coqdocvar{u})(t\coqdocvar{t'})).
   apply H2.
 contradiction.
 intros. destruct H2. split. intros. apply SN\_intro.
 intros. exists n. split; try omega.
 gen\_eq t0 : (close t' x). intro H4.
 replace t' with (t0 \^{} x). replace t' with (t0 \^{} x) in H3.
 assert (Q : x \symbol{92}notin fv t0). rewrite H4. apply fv\_close'.
 apply (IHn t0 u); trivial. apply Reg in H3.
 apply body'\_to\_body. case H3; clear H3. intros H3 H5.
 apply term\_to\_term' in H5. unfold body'. unfold term' in H5.
 unfold open in H5. apply lc\_at\_open in H5; trivial.
 case (H2 (t0\coqdocvar{u})); trivial.
 apply subst\_left with (L := \footnote{\url{x}}); trivial.
 intros z H5. apply notin\_singleton in H5. 
 apply Out with (x := x); trivial.
 intros k H5. apply WSN with (k := k); try omega. apply H5.
 rewrite H4. rewrite open\_close\_var with (x := x).
 reflexivity. apply Reg in H3. apply H3.
 rewrite H4. rewrite open\_close\_var with (x := x).
 reflexivity. apply Reg in H3. apply H3.
 apply SN\_intro.
 intros t' H'. exists n.
 split; try omega. 
 apply IHn with (t := t) (u := t'); trivial.
 apply Reg in H'. apply H'.
 case (H2 (t\coqdocvar{t'})).
 apply subst\_right; trivial. 
 intros k H''. apply WSN with (k := k).
 omega. apply H''.
Qed.


Lemma SN\_mult\_app : forall n R t l, red\_regular R ->  term t -> term \% l -> 
               SN\_ind n (contextual\_closure R) (t // l) ->
               SN\_ind n (contextual\_closure R) t /\symbol{92} SN\_ind n (contextual\_closure R) \% l.
Proof.
 intros n R t l Reg. generalize n t; clear n t.
 induction l; simpl. intros n t T H0 H. split; trivial.
 intros n t T H0 H. destruct H0. apply SN\_app in H; trivial. destruct H.
 assert (Q : SN\_ind n (contextual\_closure R) t /\symbol{92} SN\_ind n (contextual\_closure R) \% l). 
  apply IHl; trivial.
 clear IHl. destruct Q. split; trivial. split; trivial.
 rewrite term\_mult\_app. split; trivial. 
Qed. 


 Reduction on lists \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{R\_list} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) (\coqdocvar{l} : \coqdocvar{list} \coqdocvar{pterm}) (\coqdocvar{l'} : \coqdocvar{list} \coqdocvar{pterm}) := \coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{t}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{t'}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{l0}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1}, \coqdocvar{l} = (\coqdocvar{l0} ++ \coqdocvar{t} :: \coqdocvar{l1}) \ensuremath{\land} \coqdocvar{l'} = (\coqdocvar{l0} ++ \coqdocvar{t'} :: \coqdocvar{l1}) \ensuremath{\land} \coqdocvar{R} \coqdocvar{t} \coqdocvar{t'}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{R\_list\_h}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) \coqdocvar{a} \coqdocvar{b} \coqdocvar{lt}, \coqdoceol
\coqdocindent{8.00em}
\coqdocvar{R} \coqdocvar{a} \coqdocvar{b} \ensuremath{\rightarrow} \coqdocvar{R\_list} \coqdocvar{R} (\coqdocvar{a} :: \coqdocvar{lt}) (\coqdocvar{b} :: \coqdocvar{lt}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros}. \coqdoctac{unfold} \coqdocvar{R\_list}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{a}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{b}. \coqdoctac{\ensuremath{\exists}} (\coqdocvar{nil} (\coqdocvar{A} := \coqdocvar{pterm})). \coqdoctac{\ensuremath{\exists}} \coqdocvar{lt}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl}. \coqdoctac{split}; \coqdoctac{trivial}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{R\_list\_t}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}) \coqdocvar{a} \coqdocvar{lt} \coqdocvar{lt'}, \coqdoceol
\coqdocindent{8.00em}
(\coqdocvar{R\_list} \coqdocvar{R} \coqdocvar{lt} \coqdocvar{lt'}) \ensuremath{\rightarrow} \coqdocvar{R\_list} \coqdocvar{R} (\coqdocvar{a} :: \coqdocvar{lt}) (\coqdocvar{a} :: \coqdocvar{lt'}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{unfold} \coqdocvar{R\_list}. \coqdoctac{intros}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}. \coqdoctac{intros} \coqdocvar{b} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}. \coqdoctac{intros} \coqdocvar{b'} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}. \coqdoctac{intros} \coqdocvar{l} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}. \coqdoctac{intros} \coqdocvar{l'} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{b}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{b'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{a} :: \coqdocvar{l}). \coqdoctac{\ensuremath{\exists}} \coqdocvar{l'}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}; \coqdoctac{trivial}. \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_mult\_app} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{lu}, \coqdocvar{term} (\coqdocvar{t} // \coqdocvar{lu}) \ensuremath{\leftrightarrow} \coqdocvar{term} \coqdocvar{t} \ensuremath{\land} (\coqdocvar{term} \%\% \coqdocvar{lu}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{lu}. \coqdoctac{induction} \coqdocvar{lu}; \coqdoctac{simpl}; \coqdoctac{split}; \coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intro} \coqdocvar{H};  \coqdoctac{try} \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{try} \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{term\_distribute\_over\_application} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHlu}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{term\_distribute\_over\_application} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}. \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{IHlu}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{term\_distribute\_over\_application}. \coqdoctac{split}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHlu}. \coqdoctac{split}; \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{ctx\_red\_t\_mult\_app} : \coqdockw{\ensuremath{\forall}} \coqdocvar{R} \coqdocvar{t} \coqdocvar{lu} \coqdocvar{lu'}, \coqdocvar{term} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{term} \%\% \coqdocvar{lu} \ensuremath{\rightarrow} \coqdocvar{R\_list} (\coqdocvar{ES\_contextual\_closure} \coqdocvar{R}) \coqdocvar{lu} \coqdocvar{lu'} \ensuremath{\rightarrow} (\coqdocvar{ES\_contextual\_closure} \coqdocvar{R}) (\coqdocvar{t} // \coqdocvar{lu}) (\coqdocvar{t} // \coqdocvar{lu'}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{R} \coqdocvar{t} \coqdocvar{lu} \coqdocvar{lu'} \coqdocvar{Tt} \coqdocvar{Tlu} \coqdocvar{H}. \coqdoctac{unfold} \coqdocvar{R\_list} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intros} \coqdocvar{t0} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intros} \coqdocvar{t1} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intros} \coqdocvar{l0} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intros} \coqdocvar{l1} \coqdocvar{H}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{H0}. \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{Tlu}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{clear} \coqdocvar{H} \coqdocvar{H0}. \coqdoctac{induction} \coqdocvar{l0}; \coqdoctac{simpl}. \coqdoctac{destruct} \coqdocvar{l1}; \coqdoctac{simpl}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{ES\_app\_right}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{ES\_app\_right}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{Tlu}. \coqdoctac{rewrite} \coqdocvar{term\_distribute\_over\_application}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{rewrite} \coqdocvar{term\_mult\_app}. \coqdoctac{destruct} \coqdocvar{Tlu}. \coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{split}; \coqdoctac{trivial}. \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{Tlu}. \coqdoctac{destruct} \coqdocvar{Tlu}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{ES\_app\_left}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHl0}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{contextual\_R1\_R2}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{R1} \coqdocvar{R2}: \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}), \coqdoceol
\coqdocindent{13.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{R1} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} \coqdocvar{R2} \coqdocvar{t} \coqdocvar{t'}) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{13.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{ES\_contextual\_closure} \coqdocvar{R1} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} \coqdocvar{ES\_contextual\_closure} \coqdocvar{R2} \coqdocvar{t} \coqdocvar{t'}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{R1} \coqdocvar{R2} \coqdocvar{H} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{H'}. \coqdoctac{induction} \coqdocvar{H'}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{ES\_redex}. \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{ES\_app\_left}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{ES\_app\_right}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{ES\_abs\_in} \coqdockw{with} (\coqdocvar{L} := \coqdocvar{L}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{ES\_subst\_left} \coqdockw{with} (\coqdocvar{L} := \coqdocvar{L}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{ES\_subst\_right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{ctx\_red\_h\_mult\_app} : \coqdockw{\ensuremath{\forall}} \coqdocvar{R} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{lu}, \coqdocvar{term} \%\% \coqdocvar{lu} \ensuremath{\rightarrow} (\coqdocvar{ES\_contextual\_closure} \coqdocvar{R}) \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} (\coqdocvar{ES\_contextual\_closure} \coqdocvar{R}) (\coqdocvar{t} // \coqdocvar{lu}) (\coqdocvar{t'} // \coqdocvar{lu}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{R} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{lu} \coqdocvar{Tlu} \coqdocvar{H}. \coqdoctac{induction} \coqdocvar{lu}; \coqdoctac{simpl} \coqdoctac{in} *|-*; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{destruct} \coqdocvar{Tlu}. \coqdoctac{apply} \coqdocvar{ES\_app\_left}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{IHlu}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Some relations between the properties of relations \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{red\_all\_to\_out} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}), \coqdoceol
\coqdocindent{1.00em}
\coqdocvar{red\_all} \coqdocvar{R} \ensuremath{\rightarrow} \coqdocvar{red\_refl} \coqdocvar{R} \ensuremath{\rightarrow} \coqdocvar{red\_out} \coqdocvar{R}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{intros\_all}. \coqdoctac{auto}\ensuremath{\times}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{red\_out\_to\_out'} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}),\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{red\_out} \coqdocvar{R} \ensuremath{\rightarrow} \coqdocvar{red\_out'} \coqdocvar{R}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{intros\_all}. \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{red\_out'\_to\_rename} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}),\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{red\_out'} \coqdocvar{R} \ensuremath{\rightarrow} \coqdocvar{red\_rename} \coqdocvar{R}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{intros\_all}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite}\ensuremath{\times} (@\coqdocvar{subst\_intro} \coqdocvar{x} \coqdocvar{t}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite}\ensuremath{\times} (@\coqdocvar{subst\_intro} \coqdocvar{x} \coqdocvar{t'}).\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{red\_out\_to\_rename} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}),\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{red\_out} \coqdocvar{R} \ensuremath{\rightarrow} \coqdocvar{red\_rename} \coqdocvar{R}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{apply} \coqdocvar{red\_out'\_to\_rename}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{red\_out\_to\_out'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{red\_all\_to\_through} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}),\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{red\_regular} \coqdocvar{R} \ensuremath{\rightarrow} \coqdocvar{red\_all} \coqdocvar{R} \ensuremath{\rightarrow} \coqdocvar{red\_through} \coqdocvar{R}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{intros\_all}. \coqdocvar{lets}: (\coqdocvar{H} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{H4}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite}\ensuremath{\times} (@\coqdocvar{subst\_intro} \coqdocvar{x} \coqdocvar{t1}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite}\ensuremath{\times} (@\coqdocvar{subst\_intro} \coqdocvar{x} \coqdocvar{u1}).\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{red\_out\_to\_swap} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}),\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{red\_out} \coqdocvar{R} \ensuremath{\rightarrow} \coqdocvar{red\_swap} \coqdocvar{R}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{intros\_all}. \coqdocvar{pick\_fresh} \coqdocvar{z}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{Fr}; \coqdoctac{destruct} \coqdocvar{Fr}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H1}; \coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H1}; \coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H4}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{repeat} \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{swap\_eq\_m\_sb} \coqdockw{with} (\coqdocvar{z} := \coqdocvar{z}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{repeat} \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{red\_rename\_to\_rename'} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}),\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{red\_rename} \coqdocvar{R} \ensuremath{\rightarrow} \coqdocvar{red\_rename'} \coqdocvar{R}. \coqdockw{Print} \coqdocvar{red\_rename'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{intros\_all}. \coqdoctac{apply} \coqdocvar{H} \coqdockw{with} (\coqdocvar{x} := \coqdocvar{x}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{red\_swap\_to\_rename'} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}),\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{red\_swap} \coqdocvar{R} \ensuremath{\rightarrow} \coqdocvar{red\_rename'} \coqdocvar{R}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{intros\_all}. \coqdoctac{unfold} \coqdocvar{red\_swap} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} (\coqdocvar{x} == \coqdocvar{y}); \coqdoctac{intro} \coqdocvar{H'}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{H} \coqdocvar{x} (\coqdocvar{t} \^{} \coqdocvar{x}) (\coqdocvar{t'} \^{} \coqdocvar{x}) \coqdocvar{y}) \coqdoctac{in} \coqdocvar{H4}. \coqdoctac{unfold} \coqdocvar{open} \coqdoctac{in} *|-*.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{open\_swap\_comm} \coqdoctac{in} \coqdocvar{H4}. \coqdoctac{rewrite} \coqdocvar{open\_swap\_comm} \coqdoctac{in} \coqdocvar{H4}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H4}. \coqdoctac{case} (\coqdocvar{x} == \coqdocvar{y}); \coqdoctac{case} (\coqdocvar{x} == \coqdocvar{x}) \coqdoctac{in} \coqdocvar{H4}; \coqdoctac{intros}; \coqdoctac{try} \coqdocvar{contradiction}. \coqdoctac{clear} \coqdocvar{e} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{swap\_fresh} \coqdoctac{in} \coqdocvar{H4}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{swap\_fresh} \coqdoctac{in} \coqdocvar{H4}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{False\_ind}. \coqdoctac{apply} \coqdocvar{n}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{red\_out'\_to\_swap} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{R} : \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdocvar{pterm} \ensuremath{\rightarrow} \coqdockw{Prop}),\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{red\_out'} \coqdocvar{R} \ensuremath{\rightarrow} \coqdocvar{red\_swap} \coqdocvar{R}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{intros\_all}. \coqdocvar{pick\_fresh} \coqdocvar{z}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{Fr}; \coqdoctac{destruct} \coqdocvar{Fr}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H1}; \coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_union} \coqdoctac{in} \coqdocvar{H1}; \coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{notin\_singleton} \coqdoctac{in} \coqdocvar{H4}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{repeat} \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{swap\_eq\_m\_sb} \coqdockw{with} (\coqdocvar{z} := \coqdocvar{z}); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{repeat} \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
flavio 2016/02/19
 Lemma red\_regular'\_pctx : forall (R : pterm -> pterm -> Prop),
  red\_regular' R -> red\_regular' (p\_contextual\_closure R).
Proof.
  intros\_all. induction H0.
  apply H; trivial. 
  split. intro H1.
  apply term\_distribute\_over\_application.
  apply term\_distribute\_over\_application in H1. 
  destruct H1. split.
  apply IHp\_contextual\_closure1; trivial. 
  apply IHp\_contextual\_closure2; trivial. 
  intro H1.
  apply term\_distribute\_over\_application.
  apply term\_distribute\_over\_application in H1. 
  destruct H1. split.
  apply IHp\_contextual\_closure1; trivial. 
  apply IHp\_contextual\_closure2; trivial. 
  split. intro H2. 
  apply body\_to\_term\_abs. apply term\_abs\_to\_body in H2.
  unfold body. exists (L \symbol{92}u (fv t)). intros x Fr.
  apply notin\_union in Fr. destruct Fr. apply (H1 x); trivial.
  apply body\_to\_term; trivial.
  intro H2. 
  apply body\_to\_term\_abs. apply term\_abs\_to\_body in H2.
  unfold body. exists (L \symbol{92}u (fv t')). intros x Fr.
  apply notin\_union in Fr. destruct Fr. apply (H1 x); trivial.
  apply body\_to\_term; trivial.
  split. intro H3. apply subs\_to\_body in H3. destruct H3.
  apply body\_to\_subs. unfold body. exists (L \symbol{92}u (fv t)). intros x Fr.
  apply notin\_union in Fr. destruct Fr. apply (H1 x); trivial.
  apply body\_to\_term; trivial. apply IHp\_contextual\_closure; trivial.
  intro H3. apply subs\_to\_body in H3. destruct H3.
  apply body\_to\_subs. unfold body. exists (L \symbol{92}u (fv t')). intros x Fr.
  apply notin\_union in Fr. destruct Fr. apply (H1 x); trivial.
  apply body\_to\_term; trivial. apply IHp\_contextual\_closure; trivial.
Qed.


Lemma red\_regular\_trs : forall (R : pterm -> pterm -> Prop),
  red\_regular R -> red\_regular (trans\_closure R).
Proof.
 intros\_all. induction H0.
 apply H; trivial. 
 apply H in H0. split; 
 \coqdoctac{apply} \coqdocvar{H0} \ensuremath{|} \coqdoctac{apply} \coqdocvar{IHtrans\_closure}.
Qed. 


Lemma red\_regular'\_trs : forall (R : pterm -> pterm -> Prop),
  red\_regular' R -> red\_regular' (trans\_closure R).
Proof.
 intros\_all. induction H0.
 apply H; trivial. 
 apply H in H0. split.
 intro. apply IHtrans\_closure. apply H0. trivial.
 intro. apply H0. apply IHtrans\_closure. trivial.
Qed. 


Lemma red\_out\_ctx : forall (R : pterm -> pterm -> Prop),
  red\_out R -> red\_out (contextual\_closure R).
Proof.
 intros\_all. induction H1.
 apply redex. apply H; trivial.
 simpl. apply app\_left; trivial.
 apply term'\_to\_term.
 unfold term'. apply lc\_at\_subst;
 apply term\_to\_term'; trivial.
 simpl. apply app\_right; trivial.
 apply term'\_to\_term.
 unfold term'. apply lc\_at\_subst;
 apply term\_to\_term'; trivial.
 simpl. apply abs\_in with (L := L \symbol{92}u \footnote{\url{x}}). 
 intros x0 Fr. apply notin\_union in Fr. case Fr. 
 clear Fr. intros H3 H4.
 apply notin\_singleton in H4.
 rewrite subst\_open\_var; trivial.
 rewrite subst\_open\_var; trivial.
 apply H2; trivial.
 simpl. apply subst\_left with (L := L \symbol{92}u \footnote{\url{x}}). 
 apply term'\_to\_term.
 unfold term'. apply lc\_at\_subst;
 apply term\_to\_term'; trivial.
 intros x0 Fr. apply notin\_union in Fr. case Fr. 
 clear Fr. intros H4 H5.
 apply notin\_singleton in H5.
 rewrite subst\_open\_var; trivial.
 rewrite subst\_open\_var; trivial.
 apply H3; trivial.
 simpl. apply subst\_right; trivial.
 apply body'\_to\_body.
 unfold body'. apply lc\_at\_subst.
 apply body\_to\_body'; trivial.
 apply term\_to\_term' in H0. unfold term' in H0.
 apply lc\_at\_weaken\_ind with (k1 := 0); trivial; omega.
Qed.


Lemma red\_out\_pctx : forall (R : pterm -> pterm -> Prop),
  red\_out R -> red\_out (p\_contextual\_closure R).
Proof.
 intros\_all. induction H1; simpl.
 apply p\_redex. apply H; trivial.
 apply p\_app; trivial.
 apply p\_abs\_in with (L := L \symbol{92}u \footnote{\url{x}}). 
 intros x0 Fr. apply notin\_union in Fr. destruct Fr. 
 apply notin\_singleton in H4.
 rewrite subst\_open\_var; trivial.
 rewrite subst\_open\_var; trivial.
 apply H2; trivial.
 apply p\_subst with (L := L \symbol{92}u \footnote{\url{x}}); trivial.
 intros x0 Fr. apply notin\_union in Fr. destruct Fr. 
 apply notin\_singleton in H5.
 rewrite subst\_open\_var; trivial.
 rewrite subst\_open\_var; trivial.
 apply H2; trivial.
Qed.


Lemma red\_out\_trs : forall (R : pterm -> pterm -> Prop),
  red\_out R -> red\_out (trans\_closure R).
Proof.
 intros\_all. induction H1.
 apply one\_step\_reduction. apply H; trivial.
 apply transitive\_reduction with (u := \coqdocvar{x} \~{}> \coqdocvar{u}u0); trivial.
 apply H; trivial.
Qed.


Lemma red\_not\_fv\_ctx : forall (R : pterm -> pterm -> Prop),
  red\_not\_fv R -> red\_not\_fv (contextual\_closure R).
Proof.
 intros R H. unfold red\_not\_fv in *|-*.
 intros x t t' H'. induction H'.
 apply H; trivial. 
 simpl. intro H1.
 apply notin\_union. apply notin\_union in H1.
 split. apply IHH'. apply H1. apply H1.
 simpl. intro H1.
 apply notin\_union. apply notin\_union in H1.
 split. apply H1. apply IHH'. apply H1.
 simpl. intro H2. case var\_fresh with (L := \footnote{\url{x}} \symbol{92}u L).
 intros z Fr. apply notin\_union in Fr. case Fr; clear Fr.
 intros H3 H4. apply notin\_singleton in H3.
 apply fv\_notin\_open with (z := z); auto. apply H1; trivial.
 apply fv\_notin\_open; auto.
 simpl. intro H3.
 apply notin\_union. apply notin\_union in H3.
 split. case var\_fresh with (L := \footnote{\url{x}} \symbol{92}u L).
 intros z Fr. apply notin\_union in Fr. case Fr; clear Fr.
 intros H4 H5. apply notin\_singleton in H4.
 apply fv\_notin\_open with (z := z); auto. apply H2; trivial.
 apply fv\_notin\_open; auto. apply H3. apply H3.
 simpl. intro H1.
 apply notin\_union. apply notin\_union in H1.
 split. apply H1. apply IHH'. apply H1.
Qed.


Lemma red\_fv\_ctx : forall (R : pterm -> pterm -> Prop),
  red\_fv R -> red\_fv (contextual\_closure R).
Proof.
 intros R H. unfold red\_not\_fv in *|-*.
 intros x t t' H'. induction H'; simpl.
 apply H; trivial. intro H1.
 apply in\_union. apply in\_union in H1.
 case H1; clear H1; intro H1. 
 left. apply IHH'; trivial. right; trivial. intro H1.
 apply in\_union. apply in\_union in H1.
 case H1; clear H1; intro H1.
 left; trivial. right; apply IHH'; trivial. intro H2.
 case var\_fresh with (L := \footnote{\url{x}} \symbol{92}u L). intros z Fr.
 apply notin\_union in Fr. case Fr; clear Fr; intros H3 H4.
 apply notin\_singleton in H3. apply fv\_open\_in\_neq with (y := z); auto.
 apply H1; trivial. apply fv\_open\_in\_neq with (y := z); auto.
 intro H3. apply in\_union. apply in\_union in H3.
 case H3; clear H3; intro H3. left.
 case var\_fresh with (L := \footnote{\url{x}} \symbol{92}u L). intros z Fr.
 apply notin\_union in Fr. case Fr; clear Fr; intros H4 H5.
 apply notin\_singleton in H4. apply fv\_open\_in\_neq with (y := z); auto.
 apply H2; trivial. apply fv\_open\_in\_neq with (y := z); auto. right; trivial.
 intro H1. apply in\_union. apply in\_union in H1.
 case H1; clear H1; intro H1. left; trivial. right; apply IHH'; trivial.  
Qed.


Lemma red\_swap\_ctx: forall (R : pterm -> pterm -> Prop),
  red\_swap R -> red\_swap (contextual\_closure R).
Proof.
 intros R H. unfold red\_swap in *|-*.
 intros x t t' y H'. induction H'; simpl.
 apply redex. apply H; trivial.
 apply app\_left; trivial. apply swap\_term; trivial.
 apply app\_right; trivial. apply swap\_term; trivial.
 apply abs\_in with (L := L \symbol{92}u \footnote{\url{x}} \symbol{92}u \footnote{\url{y}}). intros z Hz.
 apply notin\_union in Hz; destruct Hz.
 apply notin\_union in H2; destruct H2.
 apply notin\_singleton in H3. apply notin\_singleton in H4.
 rewrite open\_swap; trivial. rewrite open\_swap; trivial.
 apply H1; trivial.
 apply subst\_left with (L := L \symbol{92}u \footnote{\url{x}} \symbol{92}u \footnote{\url{y}}). apply swap\_term; trivial.
 intros z Hz.
 apply notin\_union in Hz; destruct Hz.
 apply notin\_union in H3; destruct H3.
 apply notin\_singleton in H4. apply notin\_singleton in H5.
 rewrite open\_swap; trivial. rewrite open\_swap; trivial.
 apply H2; trivial.
 apply subst\_right; trivial. 
 inversion H0. clear H0. exists (x0 \symbol{92}u \footnote{\url{x}} \symbol{92}u \footnote{\url{y}}). intros z Hz.
 apply notin\_union in Hz; destruct Hz.
 apply notin\_union in H0; destruct H0.
 apply notin\_singleton in H2. apply notin\_singleton in H3.
 rewrite open\_swap; trivial. apply swap\_term. apply H1; trivial.
Qed.


Lemma red\_swap\_trs: forall (R : pterm -> pterm -> Prop),
  red\_swap R -> red\_swap (trans\_closure R).
Proof.
 intros R H. unfold red\_swap in *|-*. intros x t t' y H'.
 induction H'. apply one\_step\_reduction. apply H; trivial.
 apply transitive\_reduction with (u := ((\coqdocvar{x},\coqdocvar{y})u)); trivial.
 apply H; trivial.
Qed.


Lemma ctx\_abs\_in\_close : forall x R L t t', red\_regular R -> red\_out R ->
                        contextual\_closure R t t' -> x \symbol{92}notin L ->
                        contextual\_closure R (pterm\_abs (close t x)) (pterm\_abs (close t' x)).
Proof.
 intros x R L t t' H0 H1 H2 Fr.
 apply abs\_in with (L := L). intros z Fr'. 
 apply red\_out\_ctx in H1. apply red\_out\_to\_rename in H1.
 apply H1 with (x := x). apply fv\_close'. apply fv\_close'.
 replace (close t x \^{} x) with t. replace (close t' x \^{} x) with t'; trivial.
 apply open\_close\_var. apply red\_regular\_ctx in H0. apply H0 in H2. apply H2.
 apply open\_close\_var. apply red\_regular\_ctx in H0. apply H0 in H2. apply H2.
Qed.


Lemma pctx\_abs\_in\_close : forall x R L t t', red\_regular' R -> red\_out R -> term t ->
                         p\_contextual\_closure R t t' -> x \symbol{92}notin L ->
                         p\_contextual\_closure R (pterm\_abs (close t x)) (pterm\_abs (close t' x)).
Proof.
 intros x R L t t' H0 H1 T H2 Fr.
 apply p\_abs\_in with (L := L). intros z Fr'. 
 apply red\_out\_pctx in H1. apply red\_out\_to\_rename in H1.
 apply H1 with (x := x). apply fv\_close'. apply fv\_close'.
 replace (close t x \^{} x) with t. replace (close t' x \^{} x) with t'; trivial.
 apply open\_close\_var. apply red\_regular'\_pctx in H0. apply H0 in H2. apply H2; trivial.
 apply open\_close\_var; trivial. 
Qed.


Lemma trs\_pctx\_abs\_in\_close : forall x R L t t', red\_regular' R -> red\_out R -> term t ->
                         trans\_closure (p\_contextual\_closure R) t t' -> x \symbol{92}notin L ->
                         trans\_closure (p\_contextual\_closure R) (pterm\_abs (close t x)) (pterm\_abs (close t' x)).
Proof.
 intros x R L t t' H0 H1 T H Fr. induction H.
 apply one\_step\_reduction. apply pctx\_abs\_in\_close with (L := L); trivial.  
  apply transitive\_reduction with (u := pterm\_abs (close u x)).
 apply pctx\_abs\_in\_close with (L := L); trivial.
 apply IHtrans\_closure. apply red\_regular'\_pctx in H0. 
 apply H0 in H. apply H; trivial.
Qed.


Lemma trs\_pctx\_abs\_in : forall R L t t', red\_regular' R -> red\_out R -> body t ->
                       (forall x, x \symbol{92}notin L ->  trans\_closure (p\_contextual\_closure R) (t \^{} x) (t' \^{} x)) ->
                       trans\_closure (p\_contextual\_closure R) (pterm\_abs t) (pterm\_abs t').
Proof.
 intros R L t t' H0 H1 B H2.  case var\_fresh with (L := L \symbol{92}u (fv t) \symbol{92}u (fv t')). intros x Fr.
 apply notin\_union in Fr. destruct Fr. apply notin\_union in H. destruct H.
 assert (Q: trans\_closure (p\_contextual\_closure R) (t \^{} x) (t' \^{} x)). apply H2; trivial. clear H2.
 gen\_eq t0 : (t \^{} x). gen\_eq t1 : (t' \^{} x). intros Ht1 Ht0.
 replace t with (close t0 x). replace t' with (close t1 x).
 assert (T : term t0). rewrite Ht0. apply body\_to\_term; trivial.
 clear Ht0 Ht1. induction Q.
 apply one\_step\_reduction. apply pctx\_abs\_in\_close with (L := L); trivial.
 apply transitive\_reduction with (u := pterm\_abs (close u x)); trivial.
 apply pctx\_abs\_in\_close with (L := L); trivial. apply IHQ.
 apply red\_regular'\_pctx in H0. apply H0 in H2. apply H2; trivial.
 rewrite Ht1. rewrite <- close\_open\_term; trivial. 
 rewrite Ht0. rewrite <- close\_open\_term; trivial.
Qed.


Lemma str\_pctx\_abs\_in : forall R L t t', red\_regular' R -> red\_out R -> body t ->
                       (forall x, x \symbol{92}notin L ->  star\_closure (p\_contextual\_closure R) (t \^{} x) (t' \^{} x)) ->
                       star\_closure (p\_contextual\_closure R) (pterm\_abs t) (pterm\_abs t').
Proof.
 intros R L t t' H0 H1 B H2.  case var\_fresh with (L := L \symbol{92}u (fv t) \symbol{92}u (fv t')). intros x Fr.
 apply notin\_union in Fr. destruct Fr. apply notin\_union in H. destruct H.
 assert (Q: star\_closure (p\_contextual\_closure R) (t \^{} x) (t' \^{} x)). apply H2; trivial. clear H2.
 gen\_eq t0 : (t \^{} x). gen\_eq t1 : (t' \^{} x). intros Ht1 Ht0.
 replace t with (close t0 x). replace t' with (close t1 x).
 assert (T : term t0). rewrite Ht0. apply body\_to\_term; trivial.
 clear Ht0 Ht1. induction Q.
 apply reflexive\_reduction. apply star\_trans\_reduction. induction H2.
 apply one\_step\_reduction. apply pctx\_abs\_in\_close with (L := L); trivial.
 apply transitive\_reduction with (u := pterm\_abs (close u x)); trivial.
 apply pctx\_abs\_in\_close with (L := L); trivial.
 apply IHtrans\_closure.
 apply red\_regular'\_pctx in H0. apply H0 in H2. apply H2; trivial.
 rewrite Ht1. rewrite <- close\_open\_term; trivial. 
 rewrite Ht0. rewrite <- close\_open\_term; trivial.
Qed.


Lemma ctx\_subst\_left\_close : forall x R L t t' u, red\_regular R -> red\_out R -> term u ->
                         contextual\_closure R t t' -> x \symbol{92}notin L ->
                         contextual\_closure R ((close t x)\coqdocvar{u}) ((close t' x)\coqdocvar{u}).
Proof.
 intros x R L t t' u H0 H1 T H2 Fr.
 apply subst\_left with (L := L); trivial. intros z Fr'. 
 apply red\_out\_ctx in H1. apply red\_out\_to\_rename in H1.
 apply H1 with (x := x). apply fv\_close'. apply fv\_close'.
 replace (close t x \^{} x) with t. replace (close t' x \^{} x) with t'; trivial.
 apply open\_close\_var. apply red\_regular\_ctx in H0. apply H0 in H2. apply H2.
 apply open\_close\_var. apply red\_regular\_ctx in H0. apply H0 in H2. apply H2.
Qed.


Lemma trs\_ctx\_subst\_left : forall R L t t' u, red\_regular R -> red\_out R -> term u ->
                       (forall x, x \symbol{92}notin L ->  trans\_closure (contextual\_closure R) (t \^{} x) (t' \^{} x)) ->
                       trans\_closure (contextual\_closure R) (t\coqdocvar{u}) (t'\coqdocvar{u}).
Proof.
 intros R L t t' u H0 H1 T H2.  case var\_fresh with (L := L \symbol{92}u (fv t) \symbol{92}u (fv t')). intros x Fr.
 apply notin\_union in Fr. destruct Fr. apply notin\_union in H. destruct H.
 assert (Q: trans\_closure (contextual\_closure R) (t \^{} x) (t' \^{} x)). apply H2; trivial. clear H2.
 gen\_eq t0 : (t \^{} x). gen\_eq t1 : (t' \^{} x). intros Ht0 Ht1.
 replace t with (close t0 x). replace t' with (close t1 x). clear Ht0 Ht1. induction Q.
 apply one\_step\_reduction. apply ctx\_subst\_left\_close with (L := L); trivial.
 apply transitive\_reduction with (u := (close u0 x)\coqdocvar{u}); trivial.
 apply ctx\_subst\_left\_close with (L := L); trivial.
 rewrite Ht0. rewrite <- close\_open\_term; trivial. 
 rewrite Ht1. rewrite <- close\_open\_term; trivial.
Qed.


Lemma str\_ctx\_subst\_left : forall R L t t' u, red\_regular R -> red\_out R -> term u ->
                       (forall x, x \symbol{92}notin L ->  star\_closure (contextual\_closure R) (t \^{} x) (t' \^{} x)) ->
                       star\_closure (contextual\_closure R) (t\coqdocvar{u}) (t'\coqdocvar{u}).
Proof.
 intros R L t t' u H0 H1 T H2.  case var\_fresh with (L := L \symbol{92}u (fv t) \symbol{92}u (fv t')). intros x Fr.
 apply notin\_union in Fr. destruct Fr. apply notin\_union in H. destruct H.
 assert (Q: star\_closure (contextual\_closure R) (t \^{} x) (t' \^{} x)). apply H2; trivial. clear H2.
 gen\_eq t0 : (t \^{} x). gen\_eq t1 : (t' \^{} x). intros Ht1 Ht0.
 replace t with (close t0 x). replace t' with (close t1 x). clear Ht0 Ht1. destruct Q.
 apply reflexive\_reduction. apply star\_trans\_reduction. induction H2.
 apply one\_step\_reduction. apply ctx\_subst\_left\_close with (L := L); trivial.
 apply transitive\_reduction with (u := (close u0 x)\coqdocvar{u}); trivial.
 apply ctx\_subst\_left\_close with (L := L); trivial.
 rewrite Ht1. rewrite <- close\_open\_term; trivial. 
 rewrite Ht0. rewrite <- close\_open\_term; trivial.
Qed.


Lemma pctx\_subst\_close : forall x R L t t' u u', red\_regular' R -> red\_out R -> term t -> term u ->
                         p\_contextual\_closure R u u' ->
                         p\_contextual\_closure R t t' -> x \symbol{92}notin L ->
                         p\_contextual\_closure R ((close t x)\coqdocvar{u}) ((close t' x)\coqdocvar{u'}).
Proof.
 intros x R L t t' u u' H0 H1 Tt Tu H2 H3 Fr.
 apply p\_subst with (L := L); trivial. intros z Fr'. 
 apply red\_out\_pctx in H1. apply red\_out\_to\_rename in H1.
 apply H1 with (x := x). apply fv\_close'. apply fv\_close'.
 replace (close t x \^{} x) with t. replace (close t' x \^{} x) with t'; trivial.
 apply open\_close\_var. apply red\_regular'\_pctx in H0. apply H0 in H3. apply H3; trivial.
 apply open\_close\_var; trivial. 
Qed.


Lemma trs\_pctx\_subst\_close : forall x R L t t' u u', 
                         red\_regular' R -> red\_out R -> (forall t0, R t0 t0) ->
                         term t -> term u ->
                         trans\_closure (p\_contextual\_closure R) t t' -> 
                         trans\_closure (p\_contextual\_closure R) u u' -> x \symbol{92}notin L ->
                         trans\_closure (p\_contextual\_closure R) ((close t x)\coqdocvar{u}) ((close t' x)\coqdocvar{u'}).
Proof.
 intros x R L t t' u u' H0 H1 H2 Tt Tu H3 H4 Fr. induction H3. induction H4.
 apply one\_step\_reduction. apply pctx\_subst\_close with (L := L); trivial.  
  apply transitive\_reduction with (u := (close t x)\coqdocvar{u}).
 apply pctx\_subst\_close with (L := L); trivial. apply p\_redex. apply H2. 
 apply IHtrans\_closure. apply red\_regular'\_pctx in H0. 
 apply H0 in H3. apply H3; trivial.
 apply transitive\_reduction with (u := (close u0 x)\coqdocvar{u}).
 apply pctx\_subst\_close with (L := L); trivial. apply p\_redex. apply H2.
 apply IHtrans\_closure. apply red\_regular'\_pctx in H0. 
 apply H0 in H. apply H; trivial.
Qed.


Lemma trs\_pctx\_subst : forall R L t t' u u', red\_regular' R -> red\_out R -> (forall t0, R t0 t0) -> 
                        body t -> term u ->
                       (forall x, x \symbol{92}notin L ->  trans\_closure (p\_contextual\_closure R) (t \^{} x) (t' \^{} x)) -> 
                       trans\_closure (p\_contextual\_closure R) u u' ->
                       trans\_closure (p\_contextual\_closure R) (t\coqdocvar{u}) (t'\coqdocvar{u'}).
Proof.
 intros R L t t' u u' H0 H1 H2 B Tu H3 H4.  case var\_fresh with (L := L \symbol{92}u (fv t) \symbol{92}u (fv t')). intros x Fr.
 apply notin\_union in Fr. destruct Fr. apply notin\_union in H. destruct H.
 assert (Q: trans\_closure (p\_contextual\_closure R) (t \^{} x) (t' \^{} x)). apply H3; trivial. clear H3.
 gen\_eq t0 : (t \^{} x). gen\_eq t1 : (t' \^{} x). intros Ht1 Ht0.
 replace t with (close t0 x). replace t' with (close t1 x).
 assert (T : term t0). rewrite Ht0. apply body\_to\_term; trivial.
 clear Ht0 Ht1. induction Q. induction H4.
 apply one\_step\_reduction. apply pctx\_subst\_close with (L := L); trivial.
 apply transitive\_reduction with (u := (close t0 x)\coqdocvar{u}); trivial.
 apply pctx\_subst\_close with (L := L); trivial. apply p\_redex. apply H2. 
 apply IHtrans\_closure. apply red\_regular'\_pctx in H0. apply H0 in H4. apply H4; trivial.
 apply transitive\_reduction with (u := (close u0 x)\coqdocvar{u}); trivial.
 apply pctx\_subst\_close with (L := L); trivial. apply p\_redex. apply H2. 
 apply IHQ. apply red\_regular'\_pctx in H0. apply H0 in H3. apply H3; trivial.
 rewrite Ht1. rewrite <- close\_open\_term; trivial. 
 rewrite Ht0. rewrite <- close\_open\_term; trivial.
Qed.


Lemma str\_pctx\_subst : forall R L t t' u u', red\_regular' R -> red\_out R -> (forall t0, R t0 t0) -> 
                        body t -> term u ->
                       (forall x, x \symbol{92}notin L ->  star\_closure (p\_contextual\_closure R) (t \^{} x) (t' \^{} x)) -> 
                       star\_closure (p\_contextual\_closure R) u u' ->
                       star\_closure (p\_contextual\_closure R) (t\coqdocvar{u}) (t'\coqdocvar{u'}).
Proof.
 intros R L t t' u u' H0 H1 H2 B Tu H3 H4.  case var\_fresh with (L := L \symbol{92}u (fv t) \symbol{92}u (fv t')). intros x Fr.
 apply notin\_union in Fr. destruct Fr. apply notin\_union in H. destruct H.
 assert (Q: star\_closure (p\_contextual\_closure R) (t \^{} x) (t' \^{} x)). apply H3; trivial. clear H3.
 gen\_eq t0 : (t \^{} x). gen\_eq t1 : (t' \^{} x). intros Ht1 Ht0.
 replace t with (close t0 x). replace t' with (close t1 x).
 assert (T : term t0). rewrite Ht0. apply body\_to\_term; trivial.
 clear Ht0 Ht1. destruct H4. destruct Q. apply reflexive\_reduction.
 apply star\_trans\_reduction. induction H3.
 apply one\_step\_reduction. apply pctx\_subst\_close with (L := L); trivial. apply p\_redex. apply H2.
 apply transitive\_reduction with (u := (close u x)\coqdocvar{t2}); trivial.
 apply pctx\_subst\_close with (L := L); trivial. apply p\_redex. apply H2. 
 apply IHtrans\_closure. apply red\_regular'\_pctx in H0. apply H0 in H3. apply H3; trivial.
 destruct Q. apply star\_trans\_reduction. induction H3. apply one\_step\_reduction.
 apply pctx\_subst\_close with (L := L); trivial. apply p\_redex. apply H2.
 apply transitive\_reduction with (u := (close t0 x)\coqdocvar{u}); trivial.
 apply pctx\_subst\_close with (L := L); trivial. apply p\_redex. apply H2. 
 apply IHtrans\_closure. apply red\_regular'\_pctx in H0. apply H0 in H3. apply H3; trivial.
 apply star\_trans\_reduction. induction H3. induction H4.
 apply one\_step\_reduction. apply pctx\_subst\_close with (L := L); trivial.
 apply transitive\_reduction with (u := (close u0 x)\coqdocvar{t1}); trivial.
 apply pctx\_subst\_close with (L := L); trivial. apply p\_redex. apply H2. 
 apply IHtrans\_closure. apply red\_regular'\_pctx in H0. apply H0 in H4. apply H4; trivial.
 apply transitive\_reduction with (u := (close t0 x)\coqdocvar{u}); trivial.
 apply pctx\_subst\_close with (L := L); trivial. apply p\_redex. apply H2. 
 apply IHtrans\_closure. apply red\_regular'\_pctx in H0. apply H0 in H3. apply H3; trivial.
 rewrite Ht1. rewrite <- close\_open\_term; trivial. 
 rewrite Ht0. rewrite <- close\_open\_term; trivial.
Qed.
\begin{coqdoccode}
\end{coqdoccode}
\end{document}
